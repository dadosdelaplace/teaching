<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>T√âCNICAS DE AN√ÅLISIS MULTIVARIANTE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Profesor: Javier √Ålvarez Li√©bana" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Click para copiar c√≥digo","success":"C√≥digo copiado","error":"Ctrl+C para copiar"})</script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link href="libs/animate.css-xaringan/animate.fade.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# T√âCNICAS DE AN√ÅLISIS MULTIVARIANTE
## M√°ster propio (NTIC)
### Profesor: Javier √Ålvarez Li√©bana
### Facultad de Estudios Estad√≠sticos (UCM)

---





class: inverse center middle

# ATAJOS DE LAS DIAPOSITIVAS



`$$\\[2.7in]$$`

.left[Pulsa &lt;kbd-black&gt;O&lt;/kbd-black&gt; para ver el panel de diapositivas]
.left[Pulsa &lt;kbd-black&gt;H&lt;/kbd-black&gt; para ver otros atajos]
.left[Pulsa &lt;kbd-black&gt;Ctrl+F&lt;/kbd-black&gt; tras &lt;kbd-black&gt;O&lt;/kbd-black&gt; para buscar en las diapositivas]

---


# Material de las clases


.pull-left[

- **Diapositivas** del curso:
&lt;https://dadosdelaplace.github.io/teaching/pca-clustering&gt;

- **Scripts** del curso:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/scripts&gt;

- **Evaluaciones**:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/eval&gt;

- **Bibliograf√≠a**: &lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/biblio&gt;

- **Manual** de R: &lt;https://dadosdelaplace.github.io/courses-intro-R/&gt;

- **Curso de dataviz** en R: &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;


]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="83%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Material de las clases


* Tutorial sobre **covarianzas/correlaciones**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/cor_cov.Rmd&gt;

* Tutorial sobre **PCA con R**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/pca_con_R.Rmd&gt;


* Tutorial introductorio sobre **tidyverse**:
&lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/scripts/intro_tidyverse.Rmd&gt;

* Curso m√°s **avanzado de tidyverse** (est√° para bioestad√≠stica pero sirve) con ejercicios &lt;https://github.com/dadosdelaplace/teaching/tree/main/bioestad&gt;

* Curso m√°s **avanzado de miner√≠a de datos en R**  con ejercicios &lt;https://github.com/dadosdelaplace/teaching/tree/main/data_mining&gt;


---

# Me presento: la turra

.pull-left[

&lt;img src="./img/me.jpeg" width="80%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.pull-right[

* **Javier √Ålvarez Li√©bana**, nacido en 1989 en Carabanchel Bajo (Madrid)

* Licenciado (UCM) en **Matem√°ticas** (Erasmus en Bologna mediante). **M√°ster (UCM) en Ingenier√≠a Matem√°tica** (2013-2014)

&amp;nbsp;

* **Doctorado en estad√≠stica** por la Universidad de Granada


* Encargado de la **visualizaci√≥n y an√°lisis de datos covid** de la Consejer√≠a de Salud del **Principado de Asturias**

]

&amp;nbsp;

Intentando la **divulgaci√≥n** por `Twitter (@dadosdelaplace)` e `Instagram (@javieralvarezliebana)`. Mail: &lt;javalv09@ucm.es&gt;

---

# Objetivos


.pull-left[

El prop√≥sito de estas clases ser√° el tratamiento de **datos multidimensionales**, con tres objetivos principales:

- **Reducci√≥n de la dimensi√≥n**: ¬øtodas las variables aportan informaci√≥n? ¬øTodas son necesarias? ¬øPodemos transformar las variables para mantener la informaci√≥n de los datos pero reducir la dimensionalidad de los mismos?

- **Visualizaci√≥n**: ¬øcu√°ntas dimensiones podemos incluir en un gr√°fico 2D? ¬øC√≥mo visualizar datos multidimensionales?

- **Encontrar patrones**: ¬øc√≥mo agrupar (clusterizar) los elementos en funci√≥n de sus diferencias y similitudes?

]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="120%" style="display: block; margin: auto auto auto 0;" /&gt;

]

&amp;nbsp;

üìö Estas **diapositivas** han sido elaboradas con el propio `R` haciendo uso del paquete `{xaringan}`
y `{xaringanExtra}`.


---


# Requisitos

Para el presente curso los √∫nicos **requisitos** ser√°n:

1. **Conexi√≥n a internet** (para la descarga de algunos datos y paquetes).

2. **Instalar R**: ser√° nuestro **lenguaje**, nuestro **castellano** para poder ¬´comunicarnos con el ordenador. La descarga la haremos (gratuitamente) desde &lt;https://cran.r-project.org/&gt;

3. **Instalar R Studio**. De la misma manera que podemos escribir castellano en un ordenador, en un Word, en un papel o en un tuit, podemos usar distintos IDE (entornos de desarrollo integrados, nuestro Office), para que el trabajo sea m√°s c√≥modo. Nuestro **Word** para nosotros ser√° **RStudio**.

.left[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/cran-R.jpg" alt = "cran-R" align = "left" width = "500" style = "margin-top: 5vh"&gt;
]

.right[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/R-studio.jpg" alt = "RStudio" align = "right" width = "500" style = "margin-top: 5vh;"&gt;
]


---

class: inverse center middle

# BLOQUE I. Selecci√≥n de variables: PCA

&amp;nbsp;


### [¬øPor qu√© es un paso importante en el an√°lisis de datos multidimensional?](#intro-PCA)

### [Teor√≠a: an√°lisis de componentes principales](#teoria-PCA)

### [Pr√°ctica: PCA en R (y visualizaci√≥n)](#practica-PCA)

---

name: intro-PCA
class: center, middle

# ¬øPor qu√© es un paso importante en el an√°lisis de datos multidimensional?

### **¬øQu√© es el an√°lisis multivariante?**

---

# ¬øQu√© es el an√°lisis multidimensional?

Hasta la d√©cada de los 60, la mayor√≠a de la estad√≠stica que se realizaba era

* **estad√≠stica unidimensional**: extraer informaci√≥n de una sola variable (rentas, impuestos, exportaciones, etc).

* **estad√≠stica bidimensional**: desde que Galton acu√±√≥ la regresi√≥n, los grandes estad√≠sticos de principios de siglo se centraron en el **an√°lisis bidimensional**, analizando la dependencia entre una variable `\(X\)` y otra variable `\(Y\)`, con herramientas como los **coeficientes de correlaci√≥n** de Pearson, Spearman o Kendall&lt;sup&gt;1&lt;/sup&gt;


[1] [üìö Kendall, M. (1938). ¬´A New Measure of Rank Correlation¬ª. Biometrika 30 (1‚Äì2): 81-89. doi:10.1093/biomet/30.1-2.81](https://doi.org/10.1093/biomet/30.1-2.81)

--

&amp;nbsp;

## Wishart, contigo empez√≥ todo

En 1928, Wishart public√≥ su famoso art√≠culo &lt;sup&gt;2&lt;/sup&gt; en el que, se demostraba y desarrollaba expl√≠citamente la funci√≥n de distribuci√≥n de una 
**distribuci√≥n normal multivariante**, trabajo m√°s tarde extendido y formalizado por Fisher.

[2] [üìö Wishart, J. (1928). ¬´The generalised product moment distribution in samples from a normal multivariate population¬ª. Biometrika. 20A (1‚Äì2): 32‚Äì52. doi:10.1093/biomet/20A.1-2.32](https://doi.org/10.1093/biomet/20A.1-2.32)


---
 
# ¬øQu√© es el an√°lisis multidimensional?
 
Aunque el verdadero boom no lleg√≥ hasta la **d√©cada de los 60**, con la publicaci√≥n del libro ¬´An Introduction to Multivariate Statistical Analysis¬ª&lt;sup&gt;1&lt;/sup&gt; de Anderson (1958), proporcionando todo un marco te√≥rico con el que poder trabajar.

[1] [üìö Anderson, T.W. (1958). ¬´An Introduction to Multivariate Analysis¬ª. New York: Wiley ISBN 0471026409](http://www.ru.ac.bd/stat/wp-content/uploads/sites/25/2019/03/301_03_Anderson_An-Introduction-to-Multivariate-Statistical-Analysis-2003.pdf)

--

&amp;nbsp;

## **Definici√≥n**

&gt; El An√°lisis Multivariante es la rama de la estad√≠stica que estudia las relaciones (CONJUNTAMENTE) entre conjuntos de variables dependientes y los individuos para los cuales se han medido dichas variables (Kendall)


## **Notaci√≥n**

* `\(n\)` tama√±o muestral (n√∫mero de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estar√°n en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)

---

# Ejemplo de distribuci√≥n bidimensional: normal bivariante

.pull-left[ 

Veamos un ejemplo sencillo con algo que seguramente nos sea familiar: la **distribuci√≥n Normal o campana de Gauss** `\(X \sim \mathcal{N}\left(\mu, \sigma \right)\)`, cuya funci√≥n de densidad es

`$$f(x) = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}}, \quad \mu \in\mathbb{R},~\sigma &gt;0$$`

&amp;nbsp;

La normal univariante depende de **dos par√°metros**:

* **esperanza o media** `\(\mu = {\rm E} [X]\)` 
* **varianza** (unidimensional) `\(\sigma^2 := {\rm Var} [X] = {\rm E} [\left(X - \mu \right)^2] = {\rm E} [X^2] - \mu^2\)`


]


.pull-right[


```r
# Generamos muestra normal
rnorm(n = 10000, mean = 0, sd = 1)
```



&lt;img src="index_files/figure-html/unnamed-chunk-4-1.png" width="80%" /&gt;
  

]

---

# Normal bivariante

### **¬øY si medimos para cada individuo DOS variables?**

Si tenemos `\(\boldsymbol{X} = \left(X_1, X_2 \right)\)`, ¬øqu√© estad√≠sticos tenemos ahora a nuestra disposici√≥n?

* **Medidas marginales** (cada variable por separado):
  - medias `\(\mu_1:= {\rm E} [X_1]\)` y `\(\mu_2:= {\rm E} [X_2]\)`
  - varianzas `\(\sigma_{1}^{2}:=\sigma_{1, 1}^{2} = \sigma_{X_1, X_1}^2\)` y `\(\sigma_{2}^{2}:=\sigma_{2, 2}^{2} = \sigma_{X_2, X_2}^2\)`.

--

&amp;nbsp;

### **Covarianza**

La varianza `\({\rm Var} [X] := \sigma_{X}^2 = {\rm E} [ \left( X - \mu \right)^2 ]\)` es una medida de dispersi√≥n que nos **cuantifica** la relaci√≥n de una variable consigo misma. ¬øY si en lugar de medir `\(X_1\)` vs `\(X_1\)` medimos `\(X_1\)` vs `\(X_2\)`?

Definiremos la **covarianza** como una especie de varianza en la que cambiamos una de las `\(X\)` por otra variable

`$$Cov (X_1, X_2) := \sigma_{1,2} =  {\rm E} [ \left( X_1 - \mu_1 \right) \left( X_2 - \mu_2 \right) ] = {\rm E}[X_1 * X_2] - \mu_1 * \mu_2 = \sigma_{2,1}$$`

---

# Normal bivariante

### **Matriz de covarianzas**

Desde un punto de vista te√≥rico, dada una variable aleatoria bidimensional `\(\boldsymbol{X} = \left(X_1, X_2 \right)^{T}\)`, con vector de medias `\(\boldsymbol{\mu} = \left(\mu_1, \mu_2 \right)^{T}\)` definiremos la **matriz de varianzas y covarianzas** `\(\Sigma\)` de la siguiente manera:

`$$\boldsymbol{\Sigma} := \begin{pmatrix} \sigma_{1,1}^2 &amp; \sigma_{1,2} \\ \sigma_{2,1} &amp; \sigma_{2,2}^2 \end{pmatrix} = \begin{pmatrix} \sigma_{1}^2 &amp; \sigma_{1,2} \\ \sigma_{1,2} &amp; \sigma_{2}^2 \end{pmatrix}, \quad \left| \boldsymbol{\Sigma} \right| = \sigma_{1}^{2}  \sigma_{2}^{2} - \sigma_{1,2}^{2} &gt; 0$$`

--

Se puede expresar **matricialmente** como

`\(\begin{eqnarray}\boldsymbol{\Sigma} = {\rm E} \left[\left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T}\left(\boldsymbol{X} - \boldsymbol{\mu} \right) \right] &amp;=&amp; {\rm E} \left[\left( X_1  - \mu_1, X_2 - \mu_2 \right)^{T} \begin{pmatrix} X_1  - \mu_1 \\ X_2 - \mu_2 \end{pmatrix} \right] \\ &amp;=&amp; \begin{pmatrix} {\rm E} \left[ \left(X_1  - \mu_1 \right)^2 \right] &amp; {\rm E} \left[\left(X_1  - \mu_1 \right)\left(X_2  - \mu_2 \right) \right] \\ {\rm E} \left[\left(X_2  - \mu_2 \right)\left(X_1  - \mu_1 \right) \right] &amp; {\rm E} \left[\left(X_2  - \mu_2 \right)^2\right] \end{pmatrix} \end{eqnarray}\)`

**IMPORTANTE**: es una **matriz sim√©trica** (nos da igual medir `\(X\)` vs `\(Y\)`, que `\(Y\)` vs `\(X\)`).

---

# Normal multivariante

### **Normal univariante**

`$$X \sim \mathcal{N} \left(\mu, \sigma^2 \right), \quad \boldsymbol{\Sigma} = \sigma^2, \quad f(x) =  \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}} = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-\frac{1}{2} (x-\mu ) \boldsymbol{\Sigma}^{-1} (x-\mu )}$$`


### **Normal bivariante**

`$$\boldsymbol{X} = \left(X_1, X_2 \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, x_2) = \frac{1}{2\pi \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

--

### **Normal multivariante (caso general)** 

Multivariante de `\(p \ll n\)` variables

`$$\boldsymbol{X} = \left(X_1, \ldots, X_p \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, \ldots, x_p) = \frac{1}{\left(2\pi \right)^{p/2} \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

`$$\boldsymbol{\Sigma} = \left(\Sigma_{i,j} \right)_{i,j=1,\ldots,p}, \quad \Sigma_{i,j}:= Cov (X_i, X_j ) = {\rm E}[(X_i-\mu_i) (X_j - \mu_j)]$$`

---

# Versi√≥n muestral

Lo anterior nos permite conocer la **formulaci√≥n te√≥rica (poblacional)**: ¬øc√≥mo calculamos la varianza y covarianza cuando tenemos una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` observaciones medidas?


`$$\boldsymbol{X} = \begin{pmatrix} x_{1, 1} &amp; \ldots &amp; x_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ x_{n, 1} &amp; \ldots &amp; x_{n, p} \end{pmatrix} \quad \text{muestra}$$`

#### **p = 2**

* **Varianzas muestrales**: `\(s_{x_1}^{2} := s_{1}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 1} - \overline{x}_1 \right)^2\)` y `\(s_{x_2}^{2} := s_{2}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 2} - \overline{x}_2 \right)^2\)`, donde `\(\overline{x}_1\)` y `\(\overline{x}_2\)` son sus medias muestrales.

* **Covarianza muestral**: `\(s_{x_1, x_2}^{2} := s_{1, 2} = s_{2, 1}^2 = \frac{1}{n} \sum_{i=1}^n \sum_{j=1}^n \left(x_{i, 1} - \overline{x}_1 \right)\left(x_{j, 2} - \overline{x}_2 \right)\)`

--

#### **Estimadores insesgados**

Seguramente dichos valores los hallas visto divididos por `\(n-1\)` en lugar de `\(n\)`: los valores muestrales son estimadores de los valores poblacionales, y de aqu√≠ en adelante usaremos **estimadores insesgados**, estimadores `\(T\)` del valor poblaci√≥n `\(U\)` tal que `\({\rm E}[T] = U\)`

* Estimador insesgado de `\(\mu_{x}\)`: `\(\overline{x}\)` tal que `\({\rm E}[\overline{x}] = \mu\)`

* Estimador insesgado de `\(\sigma_{x}^2\)`: la **cuasivarianza** `\(S_{x}^2 = \frac{n}{n-1} s_{x}^{2}\)` tal que `\({\rm E}[\sigma_{x}^2] = S_{x}^2\)`

* Estimador insesgado de `\(\sigma_{x, y}\)`: la **cuasicovarianza** `\(S_{x, y} = \frac{n}{n-1} s_{x, y}\)` tal que `\({\rm E}[\sigma_{x, y}] = S_{x, y}\)`

---

# Matriz de covarianzas (versi√≥n muestral)


En un **caso general**, dada una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables

`$$S_{x_{k}}^2 := S_{k}^2 = \frac{1}{n-1} \sum_{i=1}^{n} \left(x_{i, k} - \overline{x}_k \right)^2 \quad \text{(cuasi) var. muestrales (marginales)}$$`


`$$S_{x_{k}, x_{l}} := S_{k, l} = \frac{1}{n-1} \sum_{i=1}^{n} \sum_{j=1}^{n} \left(x_{i, k} - \overline{x}_k \right)\left(x_{j, l} - \overline{x}_l \right) \quad \text{(cuasi) covarianzas}$$`

As√≠, la **matriz de (cuasi) covarianzas emp√≠ricas** quedar√° como

`$$S := \frac{1}{n-1} \left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T} \left(\boldsymbol{X} - \boldsymbol{\mu} \right) =_{\boldsymbol{\mu} = 0} \frac{1}{n-1} \boldsymbol{X}^{T} \boldsymbol{X} = \begin{pmatrix} S_{1,1} &amp;  \ldots &amp; S_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ S_{p,1} &amp; \ldots &amp; S_{p, p} \end{pmatrix}$$`

&amp;nbsp;

--

Las **covarianzas (y varianzas)** tienen un **¬´problema¬ª**: **dependen de la magnitud** de los datos, proporcionando una medida que solo nos sirve para ser comparada con otra covariana, pero que **no nos proporciona una escala absoluta** para poder cuantificar.

---

# Matriz de correlaciones (versi√≥n muestral)


Para resolverlo, tenemos la **correlaci√≥n (de Pearson)** 

`$$\rho_{k, l} := r_{k, l} = \frac{s_{k, l}}{\sqrt{s_{k}^2} \sqrt{s_{l}^2}} = \frac{S_{k, l}}{\sqrt{S_{k}^2} \sqrt{S_{l}^2}}$$`

tal que siempre `\(-1 \leq r_{k, l} \leq 1\)`.

&amp;nbsp;

--

De esta forma la **matriz de correlaciones** se puede expresar como

`$$R := \left(r_{k, l} \right)_{k,l=1,\ldots,p} = D^{-1/2} S D^{-1/2}, \quad D = diag(S) = \begin{pmatrix} S_{1,1}^2 &amp; \ldots &amp; 0 \\ \vdots  &amp; \ddots &amp; \vdots \\  0 &amp; \ldots &amp; S_{p, p}^2 \end{pmatrix}$$`


---


name: teoria-PCA
class: center, middle

# Teor√≠a: an√°lisis de componentes principales

---

# Objetivo: ¬øreducir dimensi√≥n?

.pull-left[

El **objetivo ¬´mainstream¬ª** del **an√°lisis de componentes principales** (PCA en ingl√©s) suele ser el de **reducir la dimensi√≥n** de nuestros datos: pasar de un conjunto de `\(n\)` individuos y `\(p\)` variables a otro de `\(k &lt; p\)` variables (para los mismos `\(n\)` individuos).

&amp;nbsp;

Esta reducci√≥n de la dimensi√≥n se suele hacer con **3 objetivos** principalmente:

* **Mejora computacional** de los algoritmos al tener un dataset m√°s reducido.

* **Permitir la visualizaci√≥n** en 2 o 3 dimensiones de conjuntos `\(n\)`-dimensionales.

* **¬´Reflotar¬ª patrones** subyacentes en los datos.

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/959/1*kK4aMPHQ89ssFEus6RT4Yw.jpeg" alt="Extra√≠da de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa" width="100%" /&gt;
&lt;p class="caption"&gt;Extra√≠da de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa&lt;/p&gt;
&lt;/div&gt;

]

---


# Objetivo: ¬øreducir dimensi√≥n?

.pull-left[

¬øEntonces? ¬øNo tiene sentido aplicar componentes principales o t√©cnicas de reducci√≥n de la dimensi√≥n en **datos bidimensionales**?

&amp;nbsp;

Empecemos por un sencillo ejemplo, visualizando la **longitud y anchura de p√©talo** del famoso conjunto de datos `iris`

&amp;nbsp;

**¬øCu√°les podr√≠an ser los objetivos?** ¬øTiene sentido en este ejemplo aplicar **t√©cnicas de reducci√≥n de la dimensi√≥n** como las componentes principales?

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-6-1.png" width="100%" /&gt;

]

---

# Objetivo: maximizar la informaci√≥n


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" alt="Gr√°fica extra√≠da de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c" width="80%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&lt;/p&gt;
&lt;/div&gt;

Como veremos, el **objetivo real** ser√° **maximizar la informaci√≥n obtenido al menor coste posible**, y eso hace que siga siendo √∫til, aunque no reduzcamos dimensiones, hacerlo en el caso bidimensional: una **clave** de las componentes principales es que las **componentes resultantes** ser√°n **ortogonales** (perpendiculares), es decir, **linealmente independientes**.

&amp;nbsp;

Las **componentes principales** pueden ser una herramienta muy √∫til para atajar problemas de **colinealidad** (variables altamente correladas entre s√≠, interfiriendo entre ellas)


---


# Idea principal

La **idea subyacente** tras el c√°lculo de las componentes principales se puede resumir de forma **geom√©trica**: para un conjunto de puntos `\(p\)`-dimensionales, encontrar un **nuevo sistema de coordenadas** de dimensi√≥n `\(k \leq p\)` en el que expresar los datos, de forma que las **nuevas variables sean linealmente independientes**.

En el **caso bidimensional**, el resultado de aplicar componentes principales ser√° una especie de ¬´rotaci√≥n¬ª de los datos


&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" width="75%" style="display: block; margin: auto;" /&gt;

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;


---

# Idea principal: caso bidimensional


En el **caso bidimensional**, la idea ser√° buscar esa **elipse** en torno a la cual tenemos los datos, de forma que la direcci√≥n que marca el **eje mayor** ser√° la **primera componente** (la que tiene mayor rango --&gt; mayor varianza) y la direcci√≥n que marca el **eje menor** ser√° la **segunda componente**.


.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_1.jpg" alt="Gr√°fica extra√≠da de Herv√© and Lynne (2010)" width="77%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de Herv√© and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]


.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_23.jpg" alt="Gr√°fica extra√≠da de Herv√© and Lynne (2010)" width="58%" /&gt;
&lt;p class="caption"&gt;Gr√°fica extra√≠da de Herv√© and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

---

# Caso inicial bidimensional


.pull-left[

Vamos a empezar por un **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del p√©talo (y la specie)


```r
library(tidyverse)
iris_tb &lt;- as_tibble(iris)
iris_bi &lt;- iris_tb[, 3:5]
```


]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-12-1.png" width="100%" /&gt;

]

---

# Caso bidimensional

.pull-left[

1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.

`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`


]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_1.jpg" alt="Direcciones de m√°xima varianza" width="85%" /&gt;
&lt;p class="caption"&gt;Direcciones de m√°xima varianza&lt;/p&gt;
&lt;/div&gt;

]

---

# Caso bidimensional

.pull-left[


1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos ser√° obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyecci√≥n ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyecci√≥n ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---


# Caso bidimensional

.pull-left[


1. Encontrar las **direcci√≥nes de m√°xima varianza**. Dichas direcciones vendr√°n determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre s√≠ y que ser√°n **combinaci√≥n lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos ser√° obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

3. Las **nuevas direcciones** las seleccionaremos  **ortonormales** (m√≥dulo unitario):
`$$x_{i, 1}'  =  \langle \boldsymbol{x}_i, \Phi_1 \rangle =  \left(x_{i, 1}, x_{i, 2} \right) \left(z_{1, 1}, z_{2, 1} \right)^{T} = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{1}^{T}, \quad x_{i, 2}' = \langle \boldsymbol{x}_i, \Phi_2 \rangle = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{2}^{T}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyecci√≥n ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyecci√≥n ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---

# Idea general


Nuestros datos originales `\(\boldsymbol{X}\)`  (dimensiones `\(n \times p\)`) ser√°n reconvertidos en un conjunto `\(\boldsymbol{X}'\)` de dimensiones `\(n \times k\)`, con `\(k \leq p\)`, tal que 

`$$\boldsymbol{X}' = \boldsymbol{X} \boldsymbol{\Phi}^{T}$$`

--

tal que `\(\boldsymbol{\Phi}^{T}\)` es una matriz `\(p \times k\)` que contiene por columnas las `\(k\)` **direcciones principales**

`$$\boldsymbol{\Phi}^{T} = \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix}$$`

--

bajo la condici√≥n de que sean **direcciones ortonormales**

`$$\Phi \Phi^{T} = \begin{pmatrix} 1 &amp; \ldots &amp; 0 \\  \vdots &amp;  \ddots &amp; \vdots \\ 0  &amp; \ldots &amp; 1 \end{pmatrix}$$`

tal que dichas direcciones **maximicen la varianza**.

---

# Primera componente

Por ejemplo, para la **primera componente** el objetivo es encontrar, de entre todas las direcciones  `\(\boldsymbol{u}_1\)` posibles, la direcci√≥n `\(\boldsymbol{\Phi}_1\)` que **maximice la varianza de nuestros datos cuando los proyectamos sobre dicha direcci√≥n**

`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ z_{1,2} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ x_{2,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`


--

&amp;nbsp;

Dicha direcci√≥n por tanto saldr√° de un proceso de **optimizaci√≥n**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

---

# Primera componente

Dicha direcci√≥n por tanto saldr√° de un proceso de **optimizaci√≥n**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

--

Si **centramos los datos** (restamos su media para tener media nula)


`$$\begin{eqnarray}\boldsymbol{\Phi}_1 &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} {\rm Var} \left( \boldsymbol{X}\boldsymbol{u}_{1}^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left({\rm E} \left[\left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right)^{T}\left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)\right] \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} \left({\rm E} \left[ \boldsymbol{u}_{1} \boldsymbol{X}^{T} \boldsymbol{X} \boldsymbol{u}_1^{T} \right] \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 {\rm E} \left[\boldsymbol{X}^{T} \boldsymbol{X} \right] \boldsymbol{u}_{1}^{T}  \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_{1}^{T}  \right)\end{eqnarray}$$`

--

Si **estandarizamos los datos** (restamos su media y dividimos entre su desviaci√≥n t√≠pica, teniendo **datos con media cero y varianza unitaria** para que todos los datos ponderen por igual)

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right)$$`

---

# Primera componente

Para **encontrar esa direcci√≥n `\(\boldsymbol{u}_1\)`** que nos maximiza la varianza de los proyectados en ella, sujeto a la restrcci√≥n de que `\(\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1\)`, se puede usar la t√©cnica de los **multiplicadores de Lagrange** que nos dice que

`$$\boldsymbol{\Phi}_1 =  \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right), \quad \lambda \in \mathbb{R}$$`

--

Eso es equivalente a encontrar el valor que nos **iguale la derivada a cero**

`$$\frac{\partial}{\partial \boldsymbol{u}_1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right) =   R \boldsymbol{u}_1  - \lambda \boldsymbol{u}_1^{T} = \left(R - \lambda \boldsymbol{Id}_{p} \right) \boldsymbol{u}_1^{T}  =  0$$`
--

Esto es lo mismo que decir que `\(R \boldsymbol{u}_1^{T}  = \lambda \boldsymbol{u}_1^{T}\)`, es decir, la direcci√≥n que buscamos `\(\boldsymbol{u}_{1}^{T}\)` es un **autovector de la matriz de covarianzas** (tras **estandarizar** los datos).

---

# Par√©ntesis: autovectores y autovalores

En √°lgebra matricial, dada una matriz `\(\boldsymbol{A}\)` cuadrada de tama√±o `\(p \times p\)`, decimos que `\(v\)` es su **autovector** y `\(\lambda\)` su **autovalor asociado** si y solo s√≠

`$$A v= \lambda v, \quad v = \left(v_1, \ldots, v_p \right) \neq 0$$`

Esto es equivalente a decir que 

`$$A v - \lambda v = 0 \rightarrow (A - \lambda I_{p}) v = 0$$`

donde `\(I_p\)` es la matriz identidad de tama√±o `\(p \times p\)`. Dicha ecuaci√≥n tiene soluci√≥n si y solo s√≠

`$$\left| A - \lambda I_{p} \right| = 0$$`

Adem√°s, por el **Teorema Fundamental del Algebra** sabemos que dicho determinante puede expresarse como un polinomio de grado `\(p\)` (conocido como **polinomio caracter√≠stico**)

`$$\left| A - \lambda I_{p} \right| = \left(\lambda_1 - \lambda \right)\left(\lambda_2 - \lambda \right) \ldots \left(\lambda_p - \lambda \right) = p (\lambda)$$`

Adem√°s el determinante `\(\left| A \right|\)` ser√° el producto de todos sus autovalores.

---

# Primera componente

Recapitulando, para obtener la **primera componente** `\(\boldsymbol{\Phi}_1\)`, debemos de 

* **Estandarizar** nuestros datos
* Calcular la **matriz de (cuasi)covarianzas** `\(\boldsymbol{S}\)`
* Calcula sus **autovectores** tal que `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)` (normalizados a m√≥dulo 1).

--

Adem√°s si es un autovector de la matriz de covarianzas tenemos entonces que la **varianza maximizada**, la **proporci√≥n de informaci√≥n** que **explica dicha componente**, ser√°

`$$\boldsymbol{\Phi}_{1} \left(  S \boldsymbol{\Phi}_{1}^{T} \right) = \boldsymbol{\Phi}_{1} \left( R \boldsymbol{\Phi}_{1}^{T} \right) =\boldsymbol{\Phi}_{1}\left(  \lambda_1 \boldsymbol{\Phi}_{1}^{T} \right) =  \lambda_1 \boldsymbol{\Phi}_{1} \boldsymbol{\Phi}_{1}^{T} =_{\text{ortonormales}} \lambda_1$$` 

--

As√≠ que obtener la direcci√≥n (de todos los autovalores) que mayor informaci√≥n captura nos fijaremos en aquella que tenga **asociada el autovalor m√°s grande**.


`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; \ldots &amp; x_{1, p}  \\ \vdots  &amp; \ddots &amp; \vdots
\\ x_{n,1}  &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`

donde `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)`, siendo `\(\lambda_1\)` el mayor de los autovalores de la matriz de (cuasi)covarianzas `\(S\)`, y `\(\boldsymbol{\Phi}_{1}^{T}\)` su autovector asociado. El **resto de las componentes** se obtendr√°n de forma similar, siendo ortogonales a cada una de las direcciones obtenidas.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Dados unos datos `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables, el objetivo es encontrar nuevas **direcciones ortonormales** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)`, con `\(1 \leq k \leq p\)`, como combinaci√≥n lineal de las variables originales.

* Los **datos son estandarizados**  tal que

`$$\begin{pmatrix} \frac{x_{1,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{1,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{1,p} - \overline{x}_p}{S_{p}} \\  \frac{x_{2,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{2,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{2,p} - \overline{x}_p}{S_{p}} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \frac{x_{n,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{n,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{n,p} - \overline{x}_p}{S_{p}} \end{pmatrix}$$`

* Calcular la **matriz `\(S\)` de (cuasi)covarianzas** de dichos datos estandarizados.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Calculamos los `\(p\)` **autovectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_p \right\rbrace\)`, y sus **autovalores asociados** `\(\left\lbrace \lambda_1, \ldots, \lambda_p \right\rbrace\)`, de la matriz `\(S\)`, tal que `\(S  \boldsymbol{\Phi}_k = \lambda_k  \boldsymbol{\Phi}_k\)`.

* Seleccionamos las primeras `\(k \leq p\)` componentes `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)` asociadas a los primeros `\(\left\lbrace \lambda_1, \ldots, \lambda_k \right\rbrace\)` autovalores.

* La **varianza (informaci√≥n) capturada** por la direcci√≥n `\(k\)`-√©sima ser√° igual a `\(\lambda_k\)`.

* Las nuevas coordenadas ser√°n

`$$\boldsymbol{X}^{'} = \boldsymbol{X} \boldsymbol{\Phi}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2}  \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix} = \begin{pmatrix} \boldsymbol{x}_1 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_k^{T} \\ \boldsymbol{x}_2 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_k^{T} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \boldsymbol{x}_n \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_k^{T}\end{pmatrix}$$`

---

# Glosario 

* **Autovectores**: nos indican la **direcci√≥n de la componente**

* **Loadings**: ser√°n los **coeficientes** de dichos autovectores (los que generan la combinaci√≥n lineal de las variables originales) nos indican el **peso que tiene cada variable original en dicha componente**. Si por ejemplo `\(\boldsymbol{\Phi}_1 = \left(0.95, 0.15, 0.273 \right)\)`, significa que la primera componente (la que m√°s varianza captura) ser√° `\(0.95* \boldsymbol{X}_1 + 0.15 * \boldsymbol{X}_2 + 0.273 * \boldsymbol{X}_3\)`, estando dominada por la variable original `\(\boldsymbol{X}_1\)` (un peso de 0.95).


* **Signo de los loadings**: nos indica el **sentido de la relaci√≥n entre la componente y la variable original** (correlaci√≥n positiva/negativa). Si alguno de ellos fuese 0 significar√≠a que la nueva componente est√° incorrelada respecto a dicha variable original.


* **Scores**: para cada observaci√≥n `\(i\)`, las nuevas coordenadas `\(\left(x_{i, 1}^{'}, \ldots, x_{i, k}^{'} \right)\)`, calculadas tras **proyectar la observaci√≥n original en las direcciones principales** `\(\boldsymbol{x}_{i} \boldsymbol{\Phi}^{T}\)`.


* **Truncamiento o n√∫mero de componentes**: para seleccionar el n√∫mero `\(k\)` de componentes a seleccionar el m√©todo m√°s sencillo es **fijar de antemano** un **umbral varianza explicada** que queremos conservar (por ejemplo, `\(95%\)`), de forma que nos quedemos con el primer n√∫mero `\(k\)` tal que `\(\sum_{j=1}^{k} \lambda_k &gt; 0.95\)` (**varianza explicada acumulada**, teniendo los autovalores ordenados de mayor a menor).


---


name: practica-PCA
class: center, middle

# Pr√°ctica: PCA en R

---

# PCA en R: caso ¬´manual¬ª


Volvemos a nuestro **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del p√©talo.


```r
library(tidyverse)
iris_tb &lt;- as_tibble(iris)
iris_bi &lt;- iris_tb[, 3:5]
iris_bi
```

```
&gt; # A tibble: 150 √ó 3
&gt;    Petal.Length Petal.Width Species
&gt;           &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
&gt;  1          1.4         0.2 setosa 
&gt;  2          1.4         0.2 setosa 
&gt;  3          1.3         0.2 setosa 
&gt;  4          1.5         0.2 setosa 
&gt;  5          1.4         0.2 setosa 
&gt;  6          1.7         0.4 setosa 
&gt;  7          1.4         0.3 setosa 
&gt;  8          1.5         0.2 setosa 
&gt;  9          1.4         0.2 setosa 
&gt; 10          1.5         0.1 setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: caso ¬´manual¬ª


**Primer paso**: **estandarizar** los datos


```r
iris_bi_std &lt;- tibble(as_tibble(scale(iris_bi[, 1:2])),
                      "Species" = iris_bi$Species)
names(iris_bi_std) &lt;- names(iris_bi)
iris_bi_std
```

```
&gt; # A tibble: 150 √ó 3
&gt;    Petal.Length Petal.Width Species
&gt;           &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
&gt;  1        -1.34       -1.31 setosa 
&gt;  2        -1.34       -1.31 setosa 
&gt;  3        -1.39       -1.31 setosa 
&gt;  4        -1.28       -1.31 setosa 
&gt;  5        -1.34       -1.31 setosa 
&gt;  6        -1.17       -1.05 setosa 
&gt;  7        -1.34       -1.18 setosa 
&gt;  8        -1.28       -1.31 setosa 
&gt;  9        -1.34       -1.31 setosa 
&gt; 10        -1.28       -1.44 setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: caso ¬´manual¬ª

.pull-left[
&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-19-1.png" width="100%" /&gt;

]

---


# PCA en R: caso ¬´manual¬ª

**Segundo paso**: calcular la **matriz de covarianzas** (solo con las num√©ricas)


```r
cov_mat &lt;- cov(iris_bi_std[, 1:2])
cov_mat
```

```
&gt;              Petal.Length Petal.Width
&gt; Petal.Length    1.0000000   0.9628654
&gt; Petal.Width     0.9628654   1.0000000
```

Al estar estandarizados los datos, es equivalente a calcular la **matriz de correlaciones**


```r
cor_mat &lt;- cor(iris_bi_std[, 1:2])
cor_mat
```

```
&gt;              Petal.Length Petal.Width
&gt; Petal.Length    1.0000000   0.9628654
&gt; Petal.Width     0.9628654   1.0000000
```

---

# PCA en R: caso ¬´manual¬ª

**Tercer paso**: calcular los **autovalores y autovectores** de la matriz de covarianzas


```r
autocosas &lt;- eigen(cor_mat)
autocosas
```

```
&gt; eigen() decomposition
&gt; $values
&gt; [1] 1.96286543 0.03713457
&gt; 
&gt; $vectors
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

**IMPORTANTE** al tener las **variables estandarizadas**, la **suma de los autovalores** es `\(p\)` (ya que ser√° la suma de las varianzas de las variables que tenemos).

---

# PCA en R: caso ¬´manual¬ª

**Cuarto paso**: comprobar que est√°n **ordenados** los autovectores segun autovalores (de mayor a menor).


```r
lambda &lt;- autocosas$values
lambda
```

```
&gt; [1] 1.96286543 0.03713457
```

La **varianza capturada** por `\(\boldsymbol{\Phi}_1\)` es `\(1.963\)` y `\(0.037\)` para la segunda componente `\(\boldsymbol{\Phi}_2\)`.


```r
# los llamados loadings
autocosas$vectors 
```

```
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

---

# PCA en R: caso ¬´manual¬ª


**Quinto paso**: calcular la **varianza explicada acumulada** por cada componente (una vez ordenadas)


```r
cumsum_var &lt;- cumsum(lambda) / sum(lambda)
cumsum_var
```

```
&gt; [1] 0.9814327 1.0000000
```

La **primera componente captura el 98.14% de la informaci√≥n (de la varianza)** y la segunda el 1.86% restante.

---

# PCA en R: caso ¬´manual¬ª

* **Sexto paso**: proyectar en las nuevas componentes para obtener las **nuevas coordenadas** (¬°respecto a la nueva base!), los llamados **scores**
 


```r
scores &lt;- tibble(as_tibble(as.matrix(iris_bi_std[, -3]) %*% autocosas$vectors),
                 "Species" = iris_bi_std$Species)
names(scores) &lt;- c("PC1", "PC2", "Species")
scores
```

```
&gt; # A tibble: 150 √ó 3
&gt;      PC1     PC2 Species
&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  
&gt;  1 -1.87  0.0175 setosa 
&gt;  2 -1.87  0.0175 setosa 
&gt;  3 -1.91  0.0575 setosa 
&gt;  4 -1.83 -0.0226 setosa 
&gt;  5 -1.87  0.0175 setosa 
&gt;  6 -1.57  0.0828 setosa 
&gt;  7 -1.78  0.110  setosa 
&gt;  8 -1.83 -0.0226 setosa 
&gt;  9 -1.87  0.0175 setosa 
&gt; 10 -1.92 -0.115  setosa 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA en R: con prcomp

Dentro de los paquete b√°sicos cargados por `R` tenemos `prcomp` que nos permite realizar los c√°lculos anteriores de manera autom√°tica (`scale. = TRUE` y `center = TRUE` debe ser indicado si los han datos no entran estandarizados previamente).


```r
pca &lt;- prcomp(iris_bi[, -3], scale. = TRUE, center = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

* **Rotation**: la matriz cuyas columnas son las componentes principales `\(\boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2\)` (recuerda que dijimos que est√°bamos ¬´rotando¬ª los datos).

* **Standard deviations**: dado que cada `\(\lambda_j = {\rm Var} \left(\boldsymbol{\Phi}_j \right)\)` representa la varianza de las componentes principales, lo que nos proporciona la salida es `\(\sqrt{\lambda_j}\)`, para cada `\(j=1,\ldots,p\)`


```r
pca$sdev^2 # autovalores
```

```
&gt; [1] 1.96286543 0.03713457
```

---

# PCA en R: con prcomp


```r
pca &lt;- prcomp(iris_bi[, -3], scale. = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

La **primera componente** viene definida como

`$$\boldsymbol{\Phi}_1 = 0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$` 

La **segunda componente** viene definida como 

`$$\boldsymbol{\Phi}_2 = -0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$`


---

# PCA en R: con prcomp

.pull-left[

En `pca$x` quedan guardados los **scores** o nuevas coordenadas de nuestros datos


```r
as_tibble(pca$x)
```

```
&gt; # A tibble: 150 √ó 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

]

.pull-right[

Tambi√©n podemos calcularlas nosotros mismos **proyectando los datos en las nuevas componentes**


```r
as_tibble(as.matrix(iris_bi_std[, -3]) %*% pca$rotation)
```

```
&gt; # A tibble: 150 √ó 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

]

---

# Visualizando la transformaci√≥n

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-32-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-33-1.png" width="100%" /&gt;

]

---

# Visualizando la transformaci√≥n


Si ahora pintamos los datos **codificando el color en funci√≥n de la especie** podemos darnos cuenta de por qu√© la primera componente es la que captura pr√°cticamente toda la informaci√≥n.

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-34-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-35-1.png" width="100%" /&gt;

]


---

# PCA en R: con factominer y factoextra

Ahora que controlamos un poco c√≥mo se calculan y qu√© significan, vamos a ampliar al dataset entero de iris `{iris}` con sus **4 variables num√©ricas**


```r
# Covarianza y correlaci√≥n sin estandarizar antes (solo num√©ricas)
cov(iris_tb[, -5])
```

```
&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; Sepal.Length    0.6856935  -0.0424340    1.2743154   0.5162707
&gt; Sepal.Width    -0.0424340   0.1899794   -0.3296564  -0.1216394
&gt; Petal.Length    1.2743154  -0.3296564    3.1162779   1.2956094
&gt; Petal.Width     0.5162707  -0.1216394    1.2956094   0.5810063
```

```r
cor(iris_tb[, -5])
```

```
&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; Sepal.Length    1.0000000  -0.1175698    0.8717538   0.8179411
&gt; Sepal.Width    -0.1175698   1.0000000   -0.4284401  -0.3661259
&gt; Petal.Length    0.8717538  -0.4284401    1.0000000   0.9628654
&gt; Petal.Width     0.8179411  -0.3661259    0.9628654   1.0000000
```

---

# PCA en R: con factominer y factoextra

.pull-left[

Las correlaciones tambi√©n podemos **visualizarlas** con el paquete `{corrplot}`

Las variables con mayor correlaci√≥n (positiva adem√°s) es entre la longitud y la anchura del p√©talo.


```r
library(corrplot)
corrplot(cor(iris_tb[, -5]),
         type = "upper",
         tl.col = "black")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-38-1.png" width="100%" /&gt;
]

---


# PCA en R: con factominer y factoextra

Con `{FactoMineR}` podemos calcular con `PCA()` de forma muy sencilla, indic√°ndole que de momento no queremos gr√°ficos, que queremos tantas componentes como variables (luego ya decidiremos con cual nos quedamos) y que estandarice los datos (`scale.unit = TRUE`).


```r
library(FactoMineR)
library(factoextra)
pca_fit &lt;-
  PCA(iris_tb[, -5], scale.unit = TRUE, ncp = 4, graph = FALSE)
```

En `ncp = ...` le indicamos las componentes que queremos que calcule

---

# PCA en R: con factominer y factoextra

* **Autovalores**: para mostrar los autovalores (**varianza explicada** por cada componente) basta con llamar `pca_fit$eig` (ya nos los da ordenados y con la varianza acumulada). 


```r
pca_fit$eig 
```

```
&gt;        eigenvalue percentage of variance cumulative percentage of variance
&gt; comp 1 2.91849782             72.9624454                          72.96245
&gt; comp 2 0.91403047             22.8507618                          95.81321
&gt; comp 3 0.14675688              3.6689219                          99.48213
&gt; comp 4 0.02071484              0.5178709                         100.00000
```

--

Tambi√©n se obtienen con `get_eig(pca_fit)`


```r
get_eig(pca_fit)
```

```
&gt;       eigenvalue variance.percent cumulative.variance.percent
&gt; Dim.1 2.91849782       72.9624454                    72.96245
&gt; Dim.2 0.91403047       22.8507618                    95.81321
&gt; Dim.3 0.14675688        3.6689219                    99.48213
&gt; Dim.4 0.02071484        0.5178709                   100.00000
```

---

# PCA en R: con factominer y factoextra

* **Autovalores**:  el % de varianza explicada por cada componente (es decir, los autovalores) podemos visualizarlos con `fviz_eig`:

.pull-left[

* `addlabels = TRUE` -&gt; para a√±adir el % de varianza explicada
* `barfill = ...`, `barcolor = ...` -&gt; color de relleno y de contorno (puedes usar cualquier c√≥digo hexadecimal busc√°ndolo en &lt;https://htmlcolorcodes.com/&gt;)
* `xlab = ...`, `ylab = ...`: t√≠tulos de ejes X e Y.
* `main = ...`: t√≠tulo de la gr√°fica


```r
# Varianza explicada (autovalores)
fviz_eig(pca_fit, addlabels = TRUE, barfill = "#5190CE", 
         barcolor = "#E35E51", xlab = "Componentes",
         ylab = "% de varianza explicada",
         main = "Varianza explicada por componentes")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-43-1.png" width="100%" /&gt;
]

---

# PCA en R: con factominer y factoextra


* **Autovectores (componentes principales)**: sus coordenadas respecto a las variables originales (**loadings**) podemos cargarlos de `pca_fit$svd$V` (guardados por columnas).


```r
# autovectores (loadings)
pca_fit$svd$V 
```

```
&gt;            [,1]       [,2]       [,3]       [,4]
&gt; [1,]  0.5210659 0.37741762 -0.7195664 -0.2612863
&gt; [2,] -0.2693474 0.92329566  0.2443818  0.1235096
&gt; [3,]  0.5804131 0.02449161  0.1421264  0.8014492
&gt; [4,]  0.5648565 0.06694199  0.6342727 -0.5235971
```

Dichos vectores ser√°n ortonormales (la suma por columnas de sus valores al cuadrado ser√°n 1)


```r
apply(pca_fit$svd$V^2, MARGIN = 2, sum)
```

```
&gt; [1] 1 1 1 1
```

---

# PCA en R: con factominer y factoextra

As√≠ que dar√≠an expresadas los **loadings de las nuevas componentes principales** en funci√≥n de las variables originales (estandarizadas `\(^*\)`)


|  Phi_1| Phi_2|  Phi_3|  Phi_4|
|------:|-----:|------:|------:|
|  0.521| 0.377| -0.720| -0.261|
| -0.269| 0.923|  0.244|  0.124|
|  0.580| 0.024|  0.142|  0.801|
|  0.565| 0.067|  0.634| -0.524|


`$$\boldsymbol{\Phi}_1 = 0.521 * Sepal.Length^* - 0.269 * Sepal.Width^* + 0.580 * Petal.Length^*  + 0.565 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_2 = 0.377 * Sepal.Length^*  + 0.923 * Sepal.Width^*  + 0.024 * Petal.Length^*  + 0.067 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_3 = -0.719 * Sepal.Length^*  + 0.244 * Sepal.Width^*  + 0.142 * Petal.Length^*  + 0.634 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_4 = -0.261 * Sepal.Length^*  + 0.124 * Sepal.Width^*  + 0.801 * Petal.Length^*  - 0.524 * Petal.Width^*$$`


---

# PCA en R: con factominer y factoextra

* **Scores**: las coordenadas en la nueva base de componentes principales de los individuos (ligeramente diferentes a los obtenidos por `prcomp()` por el m√©todo usado para la descomposici√≥n en autovectores y autovalores). Ser√°n los **datos proyectados** en las nuevas direcciones.


```r
pca_fit$ind$coord
```

```
&gt;           Dim.1        Dim.2        Dim.3        Dim.4
&gt; 1   -2.26470281  0.480026597 -0.127706022 -0.024168204
&gt; 2   -2.08096115 -0.674133557 -0.234608854 -0.103006775
&gt; 3   -2.36422905 -0.341908024  0.044201485 -0.028377053
&gt; 4   -2.29938422 -0.597394508  0.091290106  0.065955560
&gt; 5   -2.38984217  0.646835383  0.015738196  0.035922813
&gt; 6   -2.07563095  1.489177523  0.026968294 -0.006608180
&gt; 7   -2.44402884  0.047644198  0.335470401  0.036775557
&gt; 8   -2.23284716  0.223148073 -0.088695498  0.024612096
&gt; 9   -2.33464048 -1.115327675  0.145076864  0.026859221
&gt; 10  -2.18432817 -0.469013561 -0.253765567  0.039899288
&gt; 11  -2.16631010  1.043690653 -0.268681102 -0.016731367
&gt; 12  -2.32613087  0.133078335  0.093759244  0.133483413
&gt; 13  -2.21845090 -0.728676165 -0.230911237 -0.002425038
&gt; 14  -2.63310070 -0.961506729  0.180796084  0.019215534
&gt; 15  -2.19874060  1.860057113 -0.472900998 -0.194731769
&gt; 16  -2.26221453  2.686284485  0.030526609 -0.050533737
&gt; 17  -2.20758770  1.483609363 -0.005344094 -0.188817432
&gt; 18  -2.19034951  0.488838316 -0.044215316 -0.093090438
&gt; 19  -1.89857200  1.405018794 -0.374343275 -0.061095967
&gt; 20  -2.34336905  1.127849382  0.132630467  0.037756420
&gt; 21  -1.91432300  0.408855708 -0.421292594 -0.010921286
&gt; 22  -2.20701284  0.924121427  0.159865277 -0.059597330
&gt; 23  -2.77434470  0.458343668  0.332179098 -0.019648430
&gt; 24  -1.81866953  0.085558526  0.034488596 -0.151140999
&gt; 25  -2.22716331  0.137254455  0.117993536  0.270140352
&gt; 26  -1.95184633 -0.625618588 -0.305640982 -0.043561651
&gt; 27  -2.05115137  0.242163553  0.086364011 -0.067680060
&gt; 28  -2.16857717  0.527149525 -0.206816248 -0.010275393
&gt; 29  -2.13956345  0.313217810 -0.271150240 -0.084259221
&gt; 30  -2.26526149 -0.337731904  0.068435776  0.108279885
&gt; 31  -2.14012214 -0.504540690 -0.075008442  0.048188868
&gt; 32  -1.83159477  0.423695068 -0.270467377 -0.239870381
&gt; 33  -2.61494794  1.793575856  0.047228419  0.229235932
&gt; 34  -2.44617739  2.150727877 -0.082668045  0.048214393
&gt; 35  -2.10997488 -0.460201841 -0.170274861 -0.029022947
&gt; 36  -2.20780890 -0.206107398 -0.225441580 -0.168907873
&gt; 37  -2.04514621  0.661558111 -0.484537410 -0.196358525
&gt; 38  -2.52733191  0.592292774  0.019435812  0.136504550
&gt; 39  -2.42963258 -0.904180040  0.193254662  0.009738423
&gt; 40  -2.16971071  0.268878961 -0.175883821 -0.007047406
&gt; 41  -2.28647514  0.441715388  0.034894909 -0.106983249
&gt; 42  -1.85812246 -2.337415158 -0.204234223 -0.289863919
&gt; 43  -2.55363840 -0.479100690  0.305766453  0.066601453
&gt; 44  -1.96444768  0.472326668  0.309601318 -0.177093014
&gt; 45  -2.13705901  1.142229262  0.248433561  0.151043437
&gt; 46  -2.06974430 -0.711052725 -0.063929826 -0.140269507
&gt; 47  -2.38473317  1.120429702  0.057217858  0.152230967
&gt; 48  -2.39437631 -0.386246873  0.139467905  0.048834762
&gt; 49  -2.22944655  0.997959764 -0.181492780  0.014928135
&gt; 50  -2.20383344  0.009216358 -0.153029490 -0.049371732
&gt; 51   1.10178118  0.862972418 -0.684586163 -0.034833776
&gt; 52   0.73133743  0.594614726 -0.094121716 -0.004903623
&gt; 53   1.24097932  0.616297654 -0.554006835 -0.009423397
&gt; 54   0.40748306 -1.754403989 -0.023101768 -0.065768835
&gt; 55   1.07547470 -0.208421046 -0.398255523 -0.104736873
&gt; 56   0.38868734 -0.593283636  0.124191550  0.240831300
&gt; 57   0.74652974  0.773019312  0.148969403  0.077369785
&gt; 58  -0.48732274 -1.852429087  0.249265266  0.040520205
&gt; 59   0.92790164  0.032226078 -0.596169361  0.029879609
&gt; 60   0.01142619 -1.034018275  0.538899390  0.028461184
&gt; 61  -0.11019628 -2.654072819 -0.046790444 -0.013760731
&gt; 62   0.44069345 -0.063295188  0.205073815 -0.040126082
&gt; 63   0.56210831 -1.764724381 -0.765771394 -0.045731157
&gt; 64   0.71956189 -0.186224606 -0.068658945  0.164807198
&gt; 65  -0.03335470 -0.439003210  0.194932893 -0.109048499
&gt; 66   0.87540719  0.509063957 -0.503511382 -0.104943723
&gt; 67   0.35025167 -0.196311735  0.490873075  0.191509364
&gt; 68   0.15881005 -0.792095742 -0.302037174  0.205297735
&gt; 69   1.22509363 -1.622243803 -0.482304024 -0.225899769
&gt; 70   0.16491790 -1.302609230 -0.172837808  0.051726849
&gt; 71   0.73768265  0.396571562  0.616526306  0.083284123
&gt; 72   0.47628719 -0.417320281 -0.264952227 -0.113568273
&gt; 73   1.23417810 -0.933325729 -0.368412272  0.009944526
&gt; 74   0.63285820 -0.416387721 -0.291896252  0.274220152
&gt; 75   0.70266118 -0.063411820 -0.446027008 -0.043458325
&gt; 76   0.87427365  0.250793393 -0.472578954 -0.101715736
&gt; 77   1.25650912 -0.077256020 -0.727155002 -0.039688518
&gt; 78   1.35840512  0.331311682 -0.260826577 -0.066828064
&gt; 79   0.66480037 -0.225927855  0.085863889  0.036439840
&gt; 80  -0.04025861 -1.058718547 -0.319573330 -0.064788156
&gt; 81   0.13079518 -1.562271834 -0.149983478  0.009402523
&gt; 82   0.02345269 -1.572475594 -0.241552281  0.032772444
&gt; 83   0.24153827 -0.777256383 -0.151211957 -0.023651360
&gt; 84   1.06109461 -0.633843245  0.105311387  0.183968453
&gt; 85   0.22397877 -0.287773512  0.665249720  0.254828368
&gt; 86   0.42913912  0.845582241  0.450634071  0.109675181
&gt; 87   1.04872805  0.522051797 -0.395786384 -0.037209019
&gt; 88   1.04453138 -1.382988719 -0.688295960 -0.136835600
&gt; 89   0.06958832 -0.219503335  0.291579274  0.147144581
&gt; 90   0.28347724 -1.329324639  0.089410023 -0.008905805
&gt; 91   0.27907778 -1.120028524  0.094487601  0.270657196
&gt; 92   0.62456979  0.024923029 -0.020481147  0.147686401
&gt; 93   0.33653037 -0.988404018 -0.199389755 -0.006530562
&gt; 94  -0.36218338 -2.019237873  0.105821048 -0.019570812
&gt; 95   0.28858624 -0.855730320  0.130889685  0.107402349
&gt; 96   0.09136066 -0.181192126  0.128978343  0.229959626
&gt; 97   0.22771687 -0.384920081  0.156213154  0.132605877
&gt; 98   0.57638829 -0.154873597 -0.271650362  0.019860679
&gt; 99  -0.44766702 -1.543792034  0.190400930 -0.199946457
&gt; 100  0.25673059 -0.598851796  0.091879161  0.058622049
&gt; 101  1.84456887  0.870421312  1.005401018  0.049249743
&gt; 102  1.15788161 -0.698869862  0.530160149  0.040520754
&gt; 103  2.20526679  0.562010477 -0.202914170 -0.059184194
&gt; 104  1.44015066 -0.046987588  0.163630107  0.235770073
&gt; 105  1.86781222  0.295044824  0.395628375  0.016298272
&gt; 106  2.75187334  0.800409201 -0.582309103  0.101384486
&gt; 107  0.36701769 -1.561502891  0.986893267  0.133123834
&gt; 108  2.30243944  0.420065580 -0.651706439  0.238041242
&gt; 109  2.00668647 -0.711438654 -0.393990571  0.086510630
&gt; 110  2.25977735  1.921010376  0.397551897 -0.104838918
&gt; 111  1.36417549  0.692756454  0.284612074 -0.107860420
&gt; 112  1.60267867 -0.421700450  0.023186408 -0.058331633
&gt; 113  1.88390070  0.419249651  0.026338410 -0.146414939
&gt; 114  1.26011510 -1.162260421  0.580249290 -0.099157321
&gt; 115  1.46764520 -0.442271587  1.003869574 -0.275658903
&gt; 116  1.59007732  0.676244806  0.638428708 -0.191862996
&gt; 117  1.47143146  0.255621824  0.037431260  0.155330271
&gt; 118  2.42632899  2.556661251 -0.127881459  0.273807183
&gt; 119  3.31069558  0.017780949 -0.703305304 -0.045188606
&gt; 120  1.26376667 -1.706745380 -0.267536893  0.065180800
&gt; 121  2.03771630  0.910467410  0.234799484 -0.167951254
&gt; 122  0.97798073 -0.571764325  0.828127201 -0.027755587
&gt; 123  2.89765149  0.413641060 -0.857421825  0.127336502
&gt; 124  1.33323218 -0.481811219 -0.005428364 -0.139959148
&gt; 125  1.70073390  1.013921867  0.298450613  0.061643734
&gt; 126  1.95432671  1.007777596 -0.419984722  0.218338351
&gt; 127  1.17510363 -0.316394472  0.129937757 -0.125420444
&gt; 128  1.02095055  0.064346029  0.337715967  0.008654401
&gt; 129  1.78834992 -0.187361215  0.270658006 -0.031087648
&gt; 130  1.86364755  0.562290726 -0.715634119  0.208215164
&gt; 131  2.43595373  0.259284433 -0.727816146  0.017923365
&gt; 132  2.30492772  2.626323468 -0.493473808  0.211675709
&gt; 133  1.86270322 -0.178549495  0.354148712 -0.100009882
&gt; 134  1.11414774 -0.292922623 -0.183488392  0.186343697
&gt; 135  1.20247330 -0.811315271 -0.164723757  0.489483470
&gt; 136  2.79877045  0.856803329 -0.542906499 -0.295881050
&gt; 137  1.57625591  1.068581107  0.945853819 -0.035605759
&gt; 138  1.34629210  0.422430611  0.180875478  0.215421288
&gt; 139  0.92482492  0.017223100  0.416826193 -0.005238409
&gt; 140  1.85204505  0.676128174 -0.012672115 -0.195195239
&gt; 141  2.01481043  0.613885637  0.428332842 -0.247538313
&gt; 142  1.90178409  0.689575494  0.130075005 -0.469696647
&gt; 143  1.15788161 -0.698869862  0.530160149  0.040520754
&gt; 144  2.04055823  0.867520601  0.338144000 -0.045187126
&gt; 145  1.99814710  1.049168747  0.632413436 -0.214045204
&gt; 146  1.87050329  0.386966082  0.256273852 -0.389256845
&gt; 147  1.56458048 -0.896686809 -0.026371352 -0.220192100
&gt; 148  1.52117050  0.269069144  0.180178380 -0.119171137
&gt; 149  1.37278779  1.011254419  0.933395241 -0.026128648
&gt; 150  0.96065603 -0.024331668  0.528248807  0.163078032
```

---

# PCA en R: con factominer y factoextra

F√≠jate que todo lo que haga referencia a individuos est√° en `$ind` y a variables en `$var`

Adem√°s las nuevas variables o componentes tienen **media cero y varianza** igual a los autovalores


```r
apply(pca_fit$ind$coord, MARGIN = 2, mean)
```

```
&gt;         Dim.1         Dim.2         Dim.3         Dim.4 
&gt;  3.637307e-16 -5.678763e-16 -1.304469e-15  9.482777e-16
```

```r
apply(pca_fit$ind$coord, MARGIN = 2, function(x) { mean(x^2) - mean(x)^2}) 
```

```
&gt;      Dim.1      Dim.2      Dim.3      Dim.4 
&gt; 2.91849782 0.91403047 0.14675688 0.02071484
```

```r
pca_fit$eig[, 1]
```

```
&gt;     comp 1     comp 2     comp 3     comp 4 
&gt; 2.91849782 0.91403047 0.14675688 0.02071484
```


---

# PCA en R: con factominer y factoextra

* **Contribuci√≥n de individuos**: guardado en `pca_fit$ind$contrib`, cada columna suma el 100%, de forma que nos indica lo que contribuye (en %) cada individuo/registro a cada componente. As√≠, **individuos/registros con contribuciones similares** ser√°n observaciones con caracter√≠sticas parecidas.


```r
apply(pca_fit$ind$contrib, MARGIN = 2, sum)
```

```
&gt; Dim.1 Dim.2 Dim.3 Dim.4 
&gt;   100   100   100   100
```

---

# PCA en R: con factominer y factoextra

* **Correlaciones**: la idea ser√° interpretar las componentes principales analizanod la **correlaci√≥n de cada variable con ellas**, es decir, `\(cor(\Phi_i, X_j)\)`, guardado en `pca_fit$var$cor`. Para cada componente buscaremos **variables muy correlacionadas** con ellas, de forma que variables fuertemente correladas positivamente estar√°n agrupadas en las mismas componente (y viceversa en negativo).


```r
pca_fit$var$cor
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```

Es lo mismo que tenemos guardado en `pca_fit$var$coord` ya que es lo que vamos llamar **coordenadas de una variable en una componente**:


```r
pca_fit$var$coord
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```

---

# PCA en R: con factominer y factoextra

* **Correlaciones**: f√≠jate que dichas correlaciones se define como
`\(cor(\boldsymbol{\Phi}_i, \boldsymbol{X}_j) = \sqrt{\lambda_i} z_{i,j}\)` con `\(z_{j, i}\)` siendo el loading j-√©simo para la componente i, es decir,  el peso de la variable `\(\boldsymbol{X}_j\)` en la componente `\(\boldsymbol{\Phi}_i\)`


```r
pca_fit$var$cor
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```


```r
sqrt(pca_fit$eig[, 1]) * pca_fit$svd$V[, 1]
```

```
&gt;      comp 1      comp 2      comp 3      comp 4 
&gt;  0.89016876 -0.25750946  0.22234964  0.08129782
```

---

# PCA en R: con factominer y factoextra

.pull-left[

* **Correlaciones al cuadrado**: si la correlaci√≥n es la coordenada de cada variable respecto a cada componente, su **cuadrado** representar√° su peso (en magnitud), que tenemos en `pca_fit$var$coord^2` o directamente en `pca_fit$var$cos2` (la suma de cada fila es 100%)


```r
pca_fit$var$coord^2
```

```
&gt;                  Dim.1       Dim.2       Dim.3        Dim.4
&gt; Sepal.Length 0.7924004 0.130198208 0.075987149 0.0014142127
&gt; Sepal.Width  0.2117313 0.779188012 0.008764681 0.0003159971
&gt; Petal.Length 0.9831817 0.000548271 0.002964475 0.0133055723
&gt; Petal.Width  0.9311844 0.004095980 0.059040571 0.0056790544
```


```r
pca_fit$var$cos2
```

```
&gt;                  Dim.1       Dim.2       Dim.3        Dim.4
&gt; Sepal.Length 0.7924004 0.130198208 0.075987149 0.0014142127
&gt; Sepal.Width  0.2117313 0.779188012 0.008764681 0.0003159971
&gt; Petal.Length 0.9831817 0.000548271 0.002964475 0.0133055723
&gt; Petal.Width  0.9311844 0.004095980 0.059040571 0.0056790544
```

Con `fviz_cos2()` podemos visualizar dichos pesos (con `axes = ...` le decimos que queremos hacer la suma de los pesos de las n primeras componentes)


```r
fviz_cos2(pca_fit, choice = "var", axes = 1:2)
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-57-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra

Con `fviz_pca_var()` podemos **visualizar de forma bidimensional** como se relacionan las variables originales con las dos componentes que mayor cantidad de varianza capturan.

.pull-left[

* La **posici√≥n** de la flecha representa `pca_fit$var$cor` (coordendas de cada variable en las componentes)

* La **magnitud de la flecha (y color)** representa la suma `pca_fit$var$cos2` de las dos primeras componentes (su peso total en esas componentes)

La **magnitud** nos mide la **calidad de las variables** en nuestras componentes (un valor alto indica que la info de dicha variable est√° bien capturada en dichas componentes)


```r
fviz_pca_var(pca_fit, col.var = "cos2",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"), 
             repel = TRUE) +
  theme_minimal() + 
  labs(title = "Coordenadas de las variables",
       color = "Peso")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-59-1.png" width="100%" /&gt;
]

---


# PCA en R: con factominer y factoextra

.pull-left[


* **Contribuciones**: por √∫ltimo en `pca_fit$var$contrib` tenemos la **contribuci√≥n (en %) de cada variable** en cada componente en relativo, calculada como el peso de cada una entre la suma de pesos totales


```r
pca_fit$var$contrib
```

```
&gt;                  Dim.1       Dim.2     Dim.3     Dim.4
&gt; Sepal.Length 27.150969 14.24440565 51.777574  6.827052
&gt; Sepal.Width   7.254804 85.24748749  5.972245  1.525463
&gt; Petal.Length 33.687936  0.05998389  2.019990 64.232089
&gt; Petal.Width  31.906291  0.44812296 40.230191 27.415396
```

```r
pca_fit$var$cos2[, 1] / sum(pca_fit$var$cos2[, 1])
```

```
&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
&gt;   0.27150969   0.07254804   0.33687936   0.31906291
```

Con `fviz_contrib()` medimos la contribuci√≥n de variables (`choice = "var"`) o individuos (`choice = "ind"`), con `top = ...` le digo cuantas quiero calcular, y con `axes = ...` el n√∫mero de componentes a sumar.


```r
fviz_contrib(pca_fit, choice = "var", axes = 1:2, top = 4)
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-62-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra

.pull-left[

Con `fviz_pca_biplot()` podemos visualizar en las dos dimensiones que m√°s varianza capturan, e incluso nos permite **visualizar cl√∫sters** de observaciones con las elipses definidas por las matrices de covarianza de cada uno de los grupos.


```r
fviz_pca_biplot(pca_fit,
                col.ind = iris$Species,
                palette = "jco",
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                legend.title = "Especies")
```

Importante: las coordenadas de los individuos y las de las variables no est√°n definidas en el mismo espacio, as√≠ que de las segunda podremos usar la direcci√≥n (para ver variables con caracter√≠sticas similares).

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-64-1.png" width="100%" /&gt;

]

---

# PCA con tidymodels

Por √∫ltimo, ahora que entendemos las componentes principales vamos a calcularlas haciendo uso de `{tidymodels}`, un conjunto de paquetes y herramientas para obtener un **√∫nico flujo de trabajo en el preprocesamiento, modelizaci√≥n y evaluaci√≥n** de modelos.



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://www.tmwr.org/premade/data-science-model.svg" alt="Infograf√≠a extra√≠da de https://www.tmwr.org/dimensionality.html" width="75%" /&gt;
&lt;p class="caption"&gt;Infograf√≠a extra√≠da de https://www.tmwr.org/dimensionality.html&lt;/p&gt;
&lt;/div&gt;


```r
library(tidymodels)
```

---


# Filosof√≠a tidymodels

La idea detr√°s de `{tidymodels}` es **tratar por separado** la depuraci√≥n y preparaci√≥n de los datos, el modelo o paradigma de aprendizaje que se quiere aplicar, la optimizaci√≥n de los par√°metros de dicho modelo, el ajuste, la evaluaci√≥n y la predicci√≥n correspondiente, **creando un flujo de trabajo muy flexible**. La **filosof√≠a es la misma que hay detr√°s de cocinar un plato**:

1. Primero **escribimos la RECETA**, una lista de pasos e instrucciones.
2. Despu√©s **preparamos HERRAMIENTAS y utensilios para cocinar** (nuestro modelo).
3. Con la **RECETA + HERRAMIENTAS** podemos cocinar el plato muchas veces, con **distintos lotes de ingredientes (datos)**.

&amp;nbsp;

&lt;img src="https://www.tmwr.org/premade/recipes-process.svg" width="85%" style="display: block; margin: auto;" /&gt;


---

# PCA con tidymodels

Ahora que hemos visto por encima la idea de `{tidymodels}` vamos a calcular las componentes principales del conjunto `iris` con dicha idea.



```r
iris_full &lt;- iris %&gt;% select(-Species)
library(corrplot)
iris_full %&gt;% cor() %&gt;% 
  corrplot(tl.col = "black", method = "ellipse")
```

&lt;img src="index_files/figure-html/iris-cor-1.png" width="30%" /&gt;

---

# PCA con tidymodels

La receta tendr√° los siguientes pasos:

* Indicar la **variable objetivo** (`Species`)
* Imputamos **datos ausentes**
* **Estandarizar** los datos num√©ricos


```r
receta &lt;- 
  recipe(Species ~ ., data = iris) %&gt;%
  # Imputamos por la media las num√©ricas, por la moda las cuali
  step_impute_mean(all_numeric_predictors()) %&gt;%
  step_impute_mode(all_nominal_predictors()) %&gt;%
  # Estandarizamos
  step_normalize(all_numeric_predictors())
receta
```

```
&gt; Recipe
&gt; 
&gt; Inputs:
&gt; 
&gt;       role #variables
&gt;    outcome          1
&gt;  predictor          4
&gt; 
&gt; Operations:
&gt; 
&gt; Mean imputation for all_numeric_predictors()
&gt; Mode imputation for all_nominal_predictors()
&gt; Centering and scaling for all_numeric_predictors()
```

---

# PCA con tidymodels

Para a√±adir el **an√°lisis de componentes principales** basta con a√±adir `step_pca()` aplicado a todas las num√©ricas


```r
receta &lt;-
  receta %&gt;%
  step_pca(all_numeric_predictors(), num_comp = 4,
           prefix = "PC") 
```
 
Con el argumento `num_comp = 4` ind√≠camos el n√∫mero de componentes y con `prefix` el prefijo con el que llamaremos a las nuevas variables

---

# PCA con tidymodels


```r
data_pc &lt;- bake(receta %&gt;% prep(), new_data = NULL)
data_pc
```

```
&gt; # A tibble: 150 √ó 5
&gt;    Species   PC1     PC2     PC3      PC4
&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
&gt;  1 setosa  -2.26 -0.478   0.127   0.0241 
&gt;  2 setosa  -2.07  0.672   0.234   0.103  
&gt;  3 setosa  -2.36  0.341  -0.0441  0.0283 
&gt;  4 setosa  -2.29  0.595  -0.0910 -0.0657 
&gt;  5 setosa  -2.38 -0.645  -0.0157 -0.0358 
&gt;  6 setosa  -2.07 -1.48   -0.0269  0.00659
&gt;  7 setosa  -2.44 -0.0475 -0.334  -0.0367 
&gt;  8 setosa  -2.23 -0.222   0.0884 -0.0245 
&gt;  9 setosa  -2.33  1.11   -0.145  -0.0268 
&gt; 10 setosa  -2.18  0.467   0.253  -0.0398 
&gt; # ‚Ä¶ with 140 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# PCA con tidymodels

.pull-left[


```r
ggplot(data_pc,
       aes(x = .panel_x, y = .panel_y,
           color = Species, fill = Species)) +
    geom_point(alpha = 0.4, size = 0.7) +
    ggforce::geom_autodensity(alpha = 0.3) +
    ggforce::facet_matrix(layer.diag = 2) + 
    scale_color_brewer(palette = "Dark2") + 
    scale_fill_brewer(palette = "Dark2")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-70-1.png" width="100%" /&gt;

]


---
 
# PCA con tidymodels

.pull-left[


```r
library(learntidymodels)
receta %&gt;% prep() %&gt;% 
  plot_top_loadings(component_number &lt;= 4, n = 4) + 
  scale_fill_brewer(palette = "Paired")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-72-1.png" width="100%" /&gt;

]

---

class: inverse center middle

# BLOQUE II. An√°lisis cl√∫ster

&amp;nbsp;


### [¬øQu√© es el an√°lisis cl√∫ster?](#intro-cluster)

### [M√©tricas](#metricas)

### [Algoritmos jer√°rquicos](#jerarquicos)

### [Algoritmos no jer√°rquicos](#no-jerarquicos)

### [Determinaci√≥n del n√∫mero de grupos](#n-grupos)


---

name: intro-cluster
class: center, middle

# ¬øQu√© es el an√°lisis cl√∫ster?

---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

El **an√°lisis cl√∫ster** forma parte de los **algoritmos de agrupaci√≥n o clasificaci√≥n** con **aprendizaje no supervisado**:

* **Clasificaci√≥n supervisada**: los individuos se clasifican en un grupo a partir de la
informaci√≥n de un conjunto de variables observadas de unos inviduos **cuyo grupo conocemos**, los **datos est√°n etiquetados** (sabemos que es acierto y error). Es el caso por ejemplo del **an√°lisis discriminante**.


&lt;img src="./img/supervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;


---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

El **an√°lisis cl√∫ster** forma parte de los **algoritmos de agrupaci√≥n o clasificaci√≥n** con **aprendizaje no supervisado**:


* **Clasificaci√≥n/agrupaci√≥n no supervisada**: los individuos tambi√©n se clasifican en un grupo a partir de la informaci√≥n de un conjunto de variables observadas PERO en esta ocasi√≥n **no sabemos a qu√© grupo pertenece cada individuo a priori**, no tenemos conocimiento de qu√© es acierto y qu√© es error. Es este el caso del **an√°lisis cl√∫ster**.


&lt;img src="./img/unsupervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;

---

# Introducci√≥n: ¬øan√°lisis cl√∫ster?

### **Objetivo**

El an√°lisis cl√∫ster tiene como principal objetivo **encontrar grupos** dentro de los individuos, de forma que los individuos de cada grupo sean **lo m√°s parecidos entre s√≠** (homogeneidad interna) y **lo m√°s diferentes a los individuos de otros grupos** (heterogeneidad entre grupos)


&amp;nbsp;

### **Notaci√≥n**

* `\(n\)` tama√±o muestral (n√∫mero de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estar√°n en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)
 
---
 
# Introducci√≥n: ¬øan√°lisis cl√∫ster?
 
Los algoritmos los dividiremos en dos grandes grupos:


* **Algoritmos jer√°rquicos**: algoritmos que tienen como objetivo construir una jerarqu√≠a de grupos. Existen principalmente dos estrategias:
  - **Aglomerativa**: cada individuo empieza siendo su propio grupo, mientras se van uniendo de forma secuencial ascendiendo en la jerarqu√≠a, hasta acabar con un solo grupo que incluya todas las observaciones.
  - **Divisiva**: se construye una jerarqu√≠a descendiente, empezando con un √∫nico grupo hasta acabar con un grupo por individuo

Los m√©todos jer√°rquicos suelen ser muy **explicativos** y f√°ciles de visualizar (por ejemplo, con un **dendograma**) pero **muy costoso computacionalmente** (ya que siempre se construye la jerarqu√≠a entera, para decidir luego d√≥nde cortar)

&amp;nbsp;

* **Algoritmos no jer√°rquicos**: dado un n√∫mero `\(K\)` de grupos fijado a priori, se pretenden agrupar los datos de forma que obtengamos finalmente `\(K\)` agrupaciones de los mismos.

---

name: metricas
class: center, middle

# M√©tricas


---

# M√©tricas

En los algoritmos usados ser√° clave el concepto de **m√©trica**. Los datos ser√°n agrupados en base a los conceptos de ¬´lejos¬ª y ¬´cerca¬ª, o mejor dicho, en base a ¬´parecido¬ª y ¬´diferente¬ª

**¬øQu√© es ser parecido? ¬øY diferente?**

&amp;nbsp;

### **M√©trica entre observaciones**

Para medir distancias entre los individuos tenemos principalmente dos alternativas:

* **Distancias geom√©tricas**: distancias que miden la distancia entre dos individuos como si fuesen dos puntos en un espacio geom√©trico. Son distancias determin√≠sticas.

* **Distancias probabil√≠sticas**: distancias que miden la distancia entre individuos teniendo en cuenta la distribuci√≥n de las variables y su dependencia.

---

# M√©tricas determin√≠sticas


* **Distancia eucl√≠dea bidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{(x_{i, 1} - x_{j,1})^2 + (x_{i, 2} - x_{j, 2})^2}\)`
   

* **Distancia eucl√≠dea multidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} (x_{i,k} - x_{j,k})^2}\)`

* **Distancia Manhattan**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|\)`

* **Distancia de Minkowski**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \left(\displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|^l\right)^{1/l}\)` (si `\(l=1\)` es Manhattan, si `\(l=2\)` es Eucl√≠dea)
   
Cuando usemos este tipo m√©tricas es **muy importante** **reescalar por rango**: transformamos para crear nuevas observaciones `\(\widetilde{x}_{i, k} = \frac{x_{i, k} - min(\boldsymbol{x}_i)}{max(\boldsymbol{x}_i) - min(\boldsymbol{x}_i)}\)` de forma que todas las variables est√©n entre 0 y 1 (y as√≠ todas tengan el mismo peso dentro de las m√©tricas).

---

# M√©tricas determin√≠sticas

&lt;img src="./img/minkowski.png" width="65%" style="display: block; margin: auto;" /&gt;

&lt;img src="./img/minkowski_1.png" width="65%" style="display: block; margin: auto;" /&gt;


---

# M√©tricas probabil√≠sticas

* **Distancia de Mahalanobis** multidimensional **(variables independientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{\sigma_i} \right)^2}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{S_i} \right)^2}\)`

* **Distancia de Mahalanobis** multidimensional **(variables dependientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} \Sigma^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} S^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)`, donde `\(\Sigma\)` es la matriz de covarianzas, con `\(S\)` matriz de (cuasi)covarianzas.
  
Cuando usemos este tipo m√©tricas es **muy importante** **estandarizar** para tener variables de media `\(0\)` y varianza `\(1\)`.

---

# M√©tricas

### **M√©trica entre variables**

Adem√°s de medir la distancia entre individuos podemos plantearnos medir la **distancia entre las propias variables**, normalmente basadas en la correlaci√≥n de Pearson o sus derivados.

* **Correlaci√≥n de Pearson**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| r_{1,2} \right|\)` donde `\(r_{1,2}\)` se define como la correlci√≥n entre las variables `\(\boldsymbol{X}_1\)` y `\(\boldsymbol{X}_2\)`

* **Correlaci√≥n de Spearman**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \rho_{1,2} \right| = 1 - \left| \frac{6 \sum D^{2}}{n (n^{2}-1)} \right|\)`, donde `\(D\)` es la diferencia entre los correspondientes estad√≠sticos de orden.


* **Correlaci√≥n de Kendall**: definida como  `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \tau_{1,2} \right| =  1- \left| \frac{n_c - n_d}{\frac{1}{2} n (n-1)} \right|\)` donde `\(n_c\)` es el n√∫mero de pares concordantes (si el orden de clasificaci√≥n de `\((x_{i},x_{j})\)` y `\((y_{i},y_{j})\)` coinciden, tal que `\(x_{i}&gt;x_{j}\)` y `\(y_{i}&gt;y_{j}\)`, donde `\(i&lt;j\)`) y `\(n_d\)` es el n√∫mero de pares discordantes

---

name: jerarquicos
class: center, middle

# Visualizaci√≥n previa

---

# Visualizaci√≥n previa

Vamos a empezar a trabajar con un conjunto familiar, el conjunto de `iris` que ya conocemos haciendo una selecci√≥n previa de 35 observaciones


```r
iris_sample &lt;- iris %&gt;% slice_sample(n = 35)
iris_sample 
```

```
&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
&gt; 1           7.1         3.0          5.9         2.1  virginica
&gt; 2           6.5         3.0          5.5         1.8  virginica
&gt; 3           6.6         3.0          4.4         1.4 versicolor
&gt; 4           5.8         2.7          5.1         1.9  virginica
&gt; 5           5.4         3.4          1.5         0.4     setosa
&gt; 6           6.7         2.5          5.8         1.8  virginica
&gt; 7           4.6         3.4          1.4         0.3     setosa
&gt; 8           6.3         3.4          5.6         2.4  virginica
&gt; 9           6.1         2.8          4.7         1.2 versicolor
&gt; 10          4.6         3.6          1.0         0.2     setosa
&gt; 11          6.9         3.1          4.9         1.5 versicolor
&gt; 12          6.1         2.6          5.6         1.4  virginica
&gt; 13          6.9         3.1          5.4         2.1  virginica
&gt; 14          5.5         4.2          1.4         0.2     setosa
&gt; 15          6.2         2.2          4.5         1.5 versicolor
&gt; 16          6.1         2.8          4.0         1.3 versicolor
&gt; 17          6.5         3.0          5.2         2.0  virginica
&gt; 18          6.0         2.2          4.0         1.0 versicolor
&gt; 19          5.7         2.9          4.2         1.3 versicolor
&gt; 20          5.5         2.6          4.4         1.2 versicolor
&gt; 21          4.9         3.6          1.4         0.1     setosa
&gt; 22          5.4         3.4          1.7         0.2     setosa
&gt; 23          6.0         2.9          4.5         1.5 versicolor
&gt; 24          5.0         3.5          1.3         0.3     setosa
&gt; 25          5.1         3.8          1.6         0.2     setosa
&gt; 26          5.5         2.5          4.0         1.3 versicolor
&gt; 27          5.2         2.7          3.9         1.4 versicolor
&gt; 28          5.6         2.7          4.2         1.3 versicolor
&gt; 29          5.7         4.4          1.5         0.4     setosa
&gt; 30          6.4         3.2          5.3         2.3  virginica
&gt; 31          5.0         2.3          3.3         1.0 versicolor
&gt; 32          5.4         3.9          1.7         0.4     setosa
&gt; 33          4.9         2.5          4.5         1.7  virginica
&gt; 34          6.0         3.0          4.8         1.8  virginica
&gt; 35          6.0         3.4          4.5         1.6 versicolor
```

---

# Visualizaci√≥n previa


Una primera visualizaci√≥n la podemos realizar con `heatmaply()` del paquete hom√≥nimo que nos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
library(heatmaply)
heatmaply(iris_sample,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

Es importante recordar que el **clustering** es un m√©todo de **clasificaci√≥n NO SUPERVISADA**: no sabemos a priori el grupo correcto de cada individuo.

---

# Visualizaci√≥n previa

<div id="htmlwidget-55269eefd07531f02103" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-55269eefd07531f02103">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[3.125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,3.125,4,null,4,4],"y":[27.3161124613295,27.3161124613295,null,27.3161124613295,16.2763632301568,null,16.2763632301568,16.2763632301568,null,16.2763632301568,12.4185345351213,null,12.4185345351213,12.4185345351213,null,12.4185345351213,0,null,12.4185345351213,12.4185345351213,null,12.4185345351213,0,null,16.2763632301568,16.2763632301568,null,16.2763632301568,0,null,27.3161124613295,27.3161124613295,null,27.3161124613295,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[5.85064099052403,5.85064099052403,null,5.85064099052403,1.49331845230681,null,1.49331845230681,1.49331845230681,null,1.49331845230681,0.519615242270664,null,0.519615242270664,0.519615242270664,null,0.519615242270664,0,null,0.519615242270664,0.519615242270664,null,0.519615242270664,0.424264068711929,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0.264575131106459,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,1.49331845230681,1.49331845230681,null,1.49331845230681,1.0816653826392,null,1.0816653826392,1.0816653826392,null,1.0816653826392,0.360555127546399,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,1.0816653826392,1.0816653826392,null,1.0816653826392,0.547722557505166,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.282842712474619,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,5.85064099052403,5.85064099052403,null,5.85064099052403,3.58747822293042,null,3.58747822293042,3.58747822293042,null,3.58747822293042,1.42828568570857,null,1.42828568570857,1.42828568570857,null,1.42828568570857,0.678232998312526,null,0.678232998312526,0.678232998312526,null,0.678232998312526,0,null,0.678232998312526,0.678232998312526,null,0.678232998312526,0,null,1.42828568570857,1.42828568570857,null,1.42828568570857,1.40712472794703,null,1.40712472794703,1.40712472794703,null,1.40712472794703,0,null,1.40712472794703,1.40712472794703,null,1.40712472794703,1.02469507659596,null,1.02469507659596,1.02469507659596,null,1.02469507659596,0,null,1.02469507659596,1.02469507659596,null,1.02469507659596,0.62449979983984,null,0.62449979983984,0.62449979983984,null,0.62449979983984,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.62449979983984,0.62449979983984,null,0.62449979983984,0.424264068711929,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0,null,0.424264068711929,0.424264068711929,null,0.424264068711929,0.223606797749979,null,0.223606797749979,0.223606797749979,null,0.223606797749979,0,null,0.223606797749979,0.223606797749979,null,0.223606797749979,0,null,3.58747822293042,3.58747822293042,null,3.58747822293042,1.94164878389476,null,1.94164878389476,1.94164878389476,null,1.94164878389476,1.17046999107196,null,1.17046999107196,1.17046999107196,null,1.17046999107196,0.714142842854285,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0,null,1.17046999107196,1.17046999107196,null,1.17046999107196,0.761577310586391,null,0.761577310586391,0.761577310586391,null,0.761577310586391,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.761577310586391,0.761577310586391,null,0.761577310586391,0.519615242270663,null,0.519615242270663,0.519615242270663,null,0.519615242270663,0,null,0.519615242270663,0.519615242270663,null,0.519615242270663,0.360555127546399,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,0.360555127546399,0.360555127546399,null,0.360555127546399,0,null,1.94164878389476,1.94164878389476,null,1.94164878389476,1.37840487520902,null,1.37840487520902,1.37840487520902,null,1.37840487520902,1.03440804327886,null,1.03440804327886,1.03440804327886,null,1.03440804327886,0,null,1.03440804327886,1.03440804327886,null,1.03440804327886,0.6,null,0.6,0.6,null,0.6,0,null,0.6,0.6,null,0.6,0,null,1.37840487520902,1.37840487520902,null,1.37840487520902,1.17898261225516,null,1.17898261225516,1.17898261225516,null,1.17898261225516,0,null,1.17898261225516,1.17898261225516,null,1.17898261225516,0.964365076099295,null,0.964365076099295,0.964365076099295,null,0.964365076099295,0.479583152331272,null,0.479583152331272,0.479583152331272,null,0.479583152331272,0,null,0.479583152331272,0.479583152331272,null,0.479583152331272,0,null,0.964365076099295,0.964365076099295,null,0.964365076099295,0.728010988928052,null,0.728010988928052,0.728010988928052,null,0.728010988928052,0,null,0.728010988928052,0.728010988928052,null,0.728010988928052,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0],"y":[11.875,4.4375,null,4.4375,4.4375,null,4.4375,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.4375,7,null,7,7,null,7,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,7,8.5,null,8.5,8.5,null,8.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.5,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,11.875,19.3125,null,19.3125,19.3125,null,19.3125,12.828125,null,12.828125,12.828125,null,12.828125,11.5,null,11.5,11.5,null,11.5,11,null,11,11,null,11.5,12,null,12,12,null,12.828125,14.15625,null,14.15625,14.15625,null,14.15625,13,null,13,13,null,14.15625,15.3125,null,15.3125,15.3125,null,15.3125,14,null,14,14,null,15.3125,16.625,null,16.625,16.625,null,16.625,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,16.625,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.3125,25.796875,null,25.796875,25.796875,null,25.796875,22.0625,null,22.0625,22.0625,null,22.0625,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,22.0625,23.625,null,23.625,23.625,null,23.625,22.5,null,22.5,22.5,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,23.625,24.75,null,24.75,24.75,null,24.75,24,null,24,24,null,24.75,25.5,null,25.5,25.5,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,25.796875,29.53125,null,29.53125,29.53125,null,29.53125,27.75,null,27.75,27.75,null,27.75,27,null,27,27,null,27.75,28.5,null,28.5,28.5,null,28.5,28,null,28,28,null,28.5,29,null,29,29,null,29.53125,31.3125,null,31.3125,31.3125,null,31.3125,30,null,30,30,null,31.3125,32.625,null,32.625,32.625,null,32.625,31.5,null,31.5,31.5,null,31.5,31,null,31,31,null,31.5,32,null,32,32,null,32.625,33.75,null,33.75,33.75,null,33.75,33,null,33,33,null,33.75,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[3],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[2],[2],[2],[3],[3],[3],[2],[2],[2]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 2"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[3.6,1,0.2,4.6],[3.4,1.4,0.3,4.6],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[4.2,1.4,0.2,5.5],[4.4,1.5,0.4,5.7],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.8,1.6,0.2,5.1],[3.9,1.7,0.4,5.4],[2.2,4,1,6],[2.8,4,1.3,6.1],[2.3,3.3,1,5],[2.5,4.5,1.7,4.9],[2.7,3.9,1.4,5.2],[2.5,4,1.3,5.5],[2.6,4.4,1.2,5.5],[2.7,4.2,1.3,5.6],[2.9,4.2,1.3,5.7],[2.5,5.8,1.8,6.7],[3,5.9,2.1,7.1],[3.2,5.3,2.3,6.4],[3.4,5.6,2.4,6.3],[3.1,5.4,2.1,6.9],[3,5.2,2,6.5],[3,5.5,1.8,6.5],[3.4,4.5,1.6,6],[3,4.4,1.4,6.6],[3.1,4.9,1.5,6.9],[2.6,5.6,1.4,6.1],[2.7,5.1,1.9,5.8],[3,4.8,1.8,6],[2.2,4.5,1.5,6.2],[2.8,4.7,1.2,6.1],[2.9,4.5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 3.6","row: 10<br>column: Petal.Length<br>value: 1","row: 10<br>column: Petal.Width<br>value: 0.2","row: 10<br>column: Sepal.Length<br>value: 4.6"],["row: 7<br>column: Sepal.Width<br>value: 3.4","row: 7<br>column: Petal.Length<br>value: 1.4","row: 7<br>column: Petal.Width<br>value: 0.3","row: 7<br>column: Sepal.Length<br>value: 4.6"],["row: 21<br>column: Sepal.Width<br>value: 3.6","row: 21<br>column: Petal.Length<br>value: 1.4","row: 21<br>column: Petal.Width<br>value: 0.1","row: 21<br>column: Sepal.Length<br>value: 4.9"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.3","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5"],["row: 14<br>column: Sepal.Width<br>value: 4.2","row: 14<br>column: Petal.Length<br>value: 1.4","row: 14<br>column: Petal.Width<br>value: 0.2","row: 14<br>column: Sepal.Length<br>value: 5.5"],["row: 29<br>column: Sepal.Width<br>value: 4.4","row: 29<br>column: Petal.Length<br>value: 1.5","row: 29<br>column: Petal.Width<br>value: 0.4","row: 29<br>column: Sepal.Length<br>value: 5.7"],["row: 5<br>column: Sepal.Width<br>value: 3.4","row: 5<br>column: Petal.Length<br>value: 1.5","row: 5<br>column: Petal.Width<br>value: 0.4","row: 5<br>column: Sepal.Length<br>value: 5.4"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 1.7","row: 22<br>column: Petal.Width<br>value: 0.2","row: 22<br>column: Sepal.Length<br>value: 5.4"],["row: 25<br>column: Sepal.Width<br>value: 3.8","row: 25<br>column: Petal.Length<br>value: 1.6","row: 25<br>column: Petal.Width<br>value: 0.2","row: 25<br>column: Sepal.Length<br>value: 5.1"],["row: 32<br>column: Sepal.Width<br>value: 3.9","row: 32<br>column: Petal.Length<br>value: 1.7","row: 32<br>column: Petal.Width<br>value: 0.4","row: 32<br>column: Sepal.Length<br>value: 5.4"],["row: 18<br>column: Sepal.Width<br>value: 2.2","row: 18<br>column: Petal.Length<br>value: 4","row: 18<br>column: Petal.Width<br>value: 1","row: 18<br>column: Sepal.Length<br>value: 6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4","row: 16<br>column: Petal.Width<br>value: 1.3","row: 16<br>column: Sepal.Length<br>value: 6.1"],["row: 31<br>column: Sepal.Width<br>value: 2.3","row: 31<br>column: Petal.Length<br>value: 3.3","row: 31<br>column: Petal.Width<br>value: 1","row: 31<br>column: Sepal.Length<br>value: 5"],["row: 33<br>column: Sepal.Width<br>value: 2.5","row: 33<br>column: Petal.Length<br>value: 4.5","row: 33<br>column: Petal.Width<br>value: 1.7","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 27<br>column: Sepal.Width<br>value: 2.7","row: 27<br>column: Petal.Length<br>value: 3.9","row: 27<br>column: Petal.Width<br>value: 1.4","row: 27<br>column: Sepal.Length<br>value: 5.2"],["row: 26<br>column: Sepal.Width<br>value: 2.5","row: 26<br>column: Petal.Length<br>value: 4","row: 26<br>column: Petal.Width<br>value: 1.3","row: 26<br>column: Sepal.Length<br>value: 5.5"],["row: 20<br>column: Sepal.Width<br>value: 2.6","row: 20<br>column: Petal.Length<br>value: 4.4","row: 20<br>column: Petal.Width<br>value: 1.2","row: 20<br>column: Sepal.Length<br>value: 5.5"],["row: 28<br>column: Sepal.Width<br>value: 2.7","row: 28<br>column: Petal.Length<br>value: 4.2","row: 28<br>column: Petal.Width<br>value: 1.3","row: 28<br>column: Sepal.Length<br>value: 5.6"],["row: 19<br>column: Sepal.Width<br>value: 2.9","row: 19<br>column: Petal.Length<br>value: 4.2","row: 19<br>column: Petal.Width<br>value: 1.3","row: 19<br>column: Sepal.Length<br>value: 5.7"],["row: 6<br>column: Sepal.Width<br>value: 2.5","row: 6<br>column: Petal.Length<br>value: 5.8","row: 6<br>column: Petal.Width<br>value: 1.8","row: 6<br>column: Sepal.Length<br>value: 6.7"],["row: 1<br>column: Sepal.Width<br>value: 3","row: 1<br>column: Petal.Length<br>value: 5.9","row: 1<br>column: Petal.Width<br>value: 2.1","row: 1<br>column: Sepal.Length<br>value: 7.1"],["row: 30<br>column: Sepal.Width<br>value: 3.2","row: 30<br>column: Petal.Length<br>value: 5.3","row: 30<br>column: Petal.Width<br>value: 2.3","row: 30<br>column: Sepal.Length<br>value: 6.4"],["row: 8<br>column: Sepal.Width<br>value: 3.4","row: 8<br>column: Petal.Length<br>value: 5.6","row: 8<br>column: Petal.Width<br>value: 2.4","row: 8<br>column: Sepal.Length<br>value: 6.3"],["row: 13<br>column: Sepal.Width<br>value: 3.1","row: 13<br>column: Petal.Length<br>value: 5.4","row: 13<br>column: Petal.Width<br>value: 2.1","row: 13<br>column: Sepal.Length<br>value: 6.9"],["row: 17<br>column: Sepal.Width<br>value: 3","row: 17<br>column: Petal.Length<br>value: 5.2","row: 17<br>column: Petal.Width<br>value: 2","row: 17<br>column: Sepal.Length<br>value: 6.5"],["row: 2<br>column: Sepal.Width<br>value: 3","row: 2<br>column: Petal.Length<br>value: 5.5","row: 2<br>column: Petal.Width<br>value: 1.8","row: 2<br>column: Sepal.Length<br>value: 6.5"],["row: 35<br>column: Sepal.Width<br>value: 3.4","row: 35<br>column: Petal.Length<br>value: 4.5","row: 35<br>column: Petal.Width<br>value: 1.6","row: 35<br>column: Sepal.Length<br>value: 6"],["row: 3<br>column: Sepal.Width<br>value: 3","row: 3<br>column: Petal.Length<br>value: 4.4","row: 3<br>column: Petal.Width<br>value: 1.4","row: 3<br>column: Sepal.Length<br>value: 6.6"],["row: 11<br>column: Sepal.Width<br>value: 3.1","row: 11<br>column: Petal.Length<br>value: 4.9","row: 11<br>column: Petal.Width<br>value: 1.5","row: 11<br>column: Sepal.Length<br>value: 6.9"],["row: 12<br>column: Sepal.Width<br>value: 2.6","row: 12<br>column: Petal.Length<br>value: 5.6","row: 12<br>column: Petal.Width<br>value: 1.4","row: 12<br>column: Sepal.Length<br>value: 6.1"],["row: 4<br>column: Sepal.Width<br>value: 2.7","row: 4<br>column: Petal.Length<br>value: 5.1","row: 4<br>column: Petal.Width<br>value: 1.9","row: 4<br>column: Sepal.Length<br>value: 5.8"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 4.8","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6"],["row: 15<br>column: Sepal.Width<br>value: 2.2","row: 15<br>column: Petal.Length<br>value: 4.5","row: 15<br>column: Petal.Width<br>value: 1.5","row: 15<br>column: Sepal.Length<br>value: 6.2"],["row: 9<br>column: Sepal.Width<br>value: 2.8","row: 9<br>column: Petal.Length<br>value: 4.7","row: 9<br>column: Petal.Width<br>value: 1.2","row: 9<br>column: Sepal.Length<br>value: 6.1"],["row: 23<br>column: Sepal.Width<br>value: 2.9","row: 23<br>column: Petal.Length<br>value: 4.5","row: 23<br>column: Petal.Width<br>value: 1.5","row: 23<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,5.85064099052403],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Petal.Length","Petal.Width","Sepal.Length"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["10","7","21","24","14","29","5","22","25","32","18","16","31","33","27","26","20","28","19","6","1","30","8","13","17","2","35","3","11","12","4","34","15","9","23"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,27.3161124613295],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"f8b2785ab30":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"f8bb7df79":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"f8b27b0814d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"f8b460ba905":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[3],[2],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[2],[2],[2],[3],[3],[3],[2],[2],[2]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 2"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"f8b34f8fa96":{"z":[[3.6,1,0.2,4.6],[3.4,1.4,0.3,4.6],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[4.2,1.4,0.2,5.5],[4.4,1.5,0.4,5.7],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.8,1.6,0.2,5.1],[3.9,1.7,0.4,5.4],[2.2,4,1,6],[2.8,4,1.3,6.1],[2.3,3.3,1,5],[2.5,4.5,1.7,4.9],[2.7,3.9,1.4,5.2],[2.5,4,1.3,5.5],[2.6,4.4,1.2,5.5],[2.7,4.2,1.3,5.6],[2.9,4.2,1.3,5.7],[2.5,5.8,1.8,6.7],[3,5.9,2.1,7.1],[3.2,5.3,2.3,6.4],[3.4,5.6,2.4,6.3],[3.1,5.4,2.1,6.9],[3,5.2,2,6.5],[3,5.5,1.8,6.5],[3.4,4.5,1.6,6],[3,4.4,1.4,6.6],[3.1,4.9,1.5,6.9],[2.6,5.6,1.4,6.1],[2.7,5.1,1.9,5.8],[3,4.8,1.8,6],[2.2,4.5,1.5,6.2],[2.8,4.7,1.2,6.1],[2.9,4.5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 3.6","row: 10<br>column: Petal.Length<br>value: 1","row: 10<br>column: Petal.Width<br>value: 0.2","row: 10<br>column: Sepal.Length<br>value: 4.6"],["row: 7<br>column: Sepal.Width<br>value: 3.4","row: 7<br>column: Petal.Length<br>value: 1.4","row: 7<br>column: Petal.Width<br>value: 0.3","row: 7<br>column: Sepal.Length<br>value: 4.6"],["row: 21<br>column: Sepal.Width<br>value: 3.6","row: 21<br>column: Petal.Length<br>value: 1.4","row: 21<br>column: Petal.Width<br>value: 0.1","row: 21<br>column: Sepal.Length<br>value: 4.9"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.3","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5"],["row: 14<br>column: Sepal.Width<br>value: 4.2","row: 14<br>column: Petal.Length<br>value: 1.4","row: 14<br>column: Petal.Width<br>value: 0.2","row: 14<br>column: Sepal.Length<br>value: 5.5"],["row: 29<br>column: Sepal.Width<br>value: 4.4","row: 29<br>column: Petal.Length<br>value: 1.5","row: 29<br>column: Petal.Width<br>value: 0.4","row: 29<br>column: Sepal.Length<br>value: 5.7"],["row: 5<br>column: Sepal.Width<br>value: 3.4","row: 5<br>column: Petal.Length<br>value: 1.5","row: 5<br>column: Petal.Width<br>value: 0.4","row: 5<br>column: Sepal.Length<br>value: 5.4"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 1.7","row: 22<br>column: Petal.Width<br>value: 0.2","row: 22<br>column: Sepal.Length<br>value: 5.4"],["row: 25<br>column: Sepal.Width<br>value: 3.8","row: 25<br>column: Petal.Length<br>value: 1.6","row: 25<br>column: Petal.Width<br>value: 0.2","row: 25<br>column: Sepal.Length<br>value: 5.1"],["row: 32<br>column: Sepal.Width<br>value: 3.9","row: 32<br>column: Petal.Length<br>value: 1.7","row: 32<br>column: Petal.Width<br>value: 0.4","row: 32<br>column: Sepal.Length<br>value: 5.4"],["row: 18<br>column: Sepal.Width<br>value: 2.2","row: 18<br>column: Petal.Length<br>value: 4","row: 18<br>column: Petal.Width<br>value: 1","row: 18<br>column: Sepal.Length<br>value: 6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4","row: 16<br>column: Petal.Width<br>value: 1.3","row: 16<br>column: Sepal.Length<br>value: 6.1"],["row: 31<br>column: Sepal.Width<br>value: 2.3","row: 31<br>column: Petal.Length<br>value: 3.3","row: 31<br>column: Petal.Width<br>value: 1","row: 31<br>column: Sepal.Length<br>value: 5"],["row: 33<br>column: Sepal.Width<br>value: 2.5","row: 33<br>column: Petal.Length<br>value: 4.5","row: 33<br>column: Petal.Width<br>value: 1.7","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 27<br>column: Sepal.Width<br>value: 2.7","row: 27<br>column: Petal.Length<br>value: 3.9","row: 27<br>column: Petal.Width<br>value: 1.4","row: 27<br>column: Sepal.Length<br>value: 5.2"],["row: 26<br>column: Sepal.Width<br>value: 2.5","row: 26<br>column: Petal.Length<br>value: 4","row: 26<br>column: Petal.Width<br>value: 1.3","row: 26<br>column: Sepal.Length<br>value: 5.5"],["row: 20<br>column: Sepal.Width<br>value: 2.6","row: 20<br>column: Petal.Length<br>value: 4.4","row: 20<br>column: Petal.Width<br>value: 1.2","row: 20<br>column: Sepal.Length<br>value: 5.5"],["row: 28<br>column: Sepal.Width<br>value: 2.7","row: 28<br>column: Petal.Length<br>value: 4.2","row: 28<br>column: Petal.Width<br>value: 1.3","row: 28<br>column: Sepal.Length<br>value: 5.6"],["row: 19<br>column: Sepal.Width<br>value: 2.9","row: 19<br>column: Petal.Length<br>value: 4.2","row: 19<br>column: Petal.Width<br>value: 1.3","row: 19<br>column: Sepal.Length<br>value: 5.7"],["row: 6<br>column: Sepal.Width<br>value: 2.5","row: 6<br>column: Petal.Length<br>value: 5.8","row: 6<br>column: Petal.Width<br>value: 1.8","row: 6<br>column: Sepal.Length<br>value: 6.7"],["row: 1<br>column: Sepal.Width<br>value: 3","row: 1<br>column: Petal.Length<br>value: 5.9","row: 1<br>column: Petal.Width<br>value: 2.1","row: 1<br>column: Sepal.Length<br>value: 7.1"],["row: 30<br>column: Sepal.Width<br>value: 3.2","row: 30<br>column: Petal.Length<br>value: 5.3","row: 30<br>column: Petal.Width<br>value: 2.3","row: 30<br>column: Sepal.Length<br>value: 6.4"],["row: 8<br>column: Sepal.Width<br>value: 3.4","row: 8<br>column: Petal.Length<br>value: 5.6","row: 8<br>column: Petal.Width<br>value: 2.4","row: 8<br>column: Sepal.Length<br>value: 6.3"],["row: 13<br>column: Sepal.Width<br>value: 3.1","row: 13<br>column: Petal.Length<br>value: 5.4","row: 13<br>column: Petal.Width<br>value: 2.1","row: 13<br>column: Sepal.Length<br>value: 6.9"],["row: 17<br>column: Sepal.Width<br>value: 3","row: 17<br>column: Petal.Length<br>value: 5.2","row: 17<br>column: Petal.Width<br>value: 2","row: 17<br>column: Sepal.Length<br>value: 6.5"],["row: 2<br>column: Sepal.Width<br>value: 3","row: 2<br>column: Petal.Length<br>value: 5.5","row: 2<br>column: Petal.Width<br>value: 1.8","row: 2<br>column: Sepal.Length<br>value: 6.5"],["row: 35<br>column: Sepal.Width<br>value: 3.4","row: 35<br>column: Petal.Length<br>value: 4.5","row: 35<br>column: Petal.Width<br>value: 1.6","row: 35<br>column: Sepal.Length<br>value: 6"],["row: 3<br>column: Sepal.Width<br>value: 3","row: 3<br>column: Petal.Length<br>value: 4.4","row: 3<br>column: Petal.Width<br>value: 1.4","row: 3<br>column: Sepal.Length<br>value: 6.6"],["row: 11<br>column: Sepal.Width<br>value: 3.1","row: 11<br>column: Petal.Length<br>value: 4.9","row: 11<br>column: Petal.Width<br>value: 1.5","row: 11<br>column: Sepal.Length<br>value: 6.9"],["row: 12<br>column: Sepal.Width<br>value: 2.6","row: 12<br>column: Petal.Length<br>value: 5.6","row: 12<br>column: Petal.Width<br>value: 1.4","row: 12<br>column: Sepal.Length<br>value: 6.1"],["row: 4<br>column: Sepal.Width<br>value: 2.7","row: 4<br>column: Petal.Length<br>value: 5.1","row: 4<br>column: Petal.Width<br>value: 1.9","row: 4<br>column: Sepal.Length<br>value: 5.8"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 4.8","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6"],["row: 15<br>column: Sepal.Width<br>value: 2.2","row: 15<br>column: Petal.Length<br>value: 4.5","row: 15<br>column: Petal.Width<br>value: 1.5","row: 15<br>column: Sepal.Length<br>value: 6.2"],["row: 9<br>column: Sepal.Width<br>value: 2.8","row: 9<br>column: Petal.Length<br>value: 4.7","row: 9<br>column: Petal.Width<br>value: 1.2","row: 9<br>column: Sepal.Length<br>value: 6.1"],["row: 23<br>column: Sepal.Width<br>value: 2.9","row: 23<br>column: Petal.Length<br>value: 4.5","row: 23<br>column: Petal.Width<br>value: 1.5","row: 23<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---


# Visualizaci√≥n previa


Podemos mejorar la representaci√≥n **estandarizando** las variables.


```r
heatmaply(iris_sample %&gt;%  mutate(across(where(is.numeric), ~scale(.))),
          seriate = "mean", row_dend_left = TRUE, plot_method = "plotly")
```

---


# Visualizaci√≥n previa

<div id="htmlwidget-0c44f57ef2983315589f" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c44f57ef2983315589f">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[10.5754514109665,10.5754514109665,null,10.5754514109665,0,null,10.5754514109665,10.5754514109665,null,10.5754514109665,4.24915701041922,null,4.24915701041922,4.24915701041922,null,4.24915701041922,0,null,4.24915701041922,4.24915701041922,null,4.24915701041922,1.790350286521,null,1.790350286521,1.790350286521,null,1.790350286521,0,null,1.790350286521,1.790350286521,null,1.790350286521,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[5.66661287258982,5.66661287258982,null,5.66661287258982,2.49528217384519,null,2.49528217384519,2.49528217384519,null,2.49528217384519,1.536913316389,null,1.536913316389,1.536913316389,null,1.536913316389,0.670106055753407,null,0.670106055753407,0.670106055753407,null,0.670106055753407,0.471543824477617,null,0.471543824477617,0.471543824477617,null,0.471543824477617,0,null,0.471543824477617,0.471543824477617,null,0.471543824477617,0,null,0.670106055753407,0.670106055753407,null,0.670106055753407,0.3813290749513,null,0.3813290749513,0.3813290749513,null,0.3813290749513,0,null,0.3813290749513,0.3813290749513,null,0.3813290749513,0,null,1.536913316389,1.536913316389,null,1.536913316389,0.978284281983263,null,0.978284281983263,0.978284281983263,null,0.978284281983263,0.315688139680769,null,0.315688139680769,0.315688139680769,null,0.315688139680769,0,null,0.315688139680769,0.315688139680769,null,0.315688139680769,0,null,0.978284281983263,0.978284281983263,null,0.978284281983263,0.569744232344864,null,0.569744232344864,0.569744232344864,null,0.569744232344864,0,null,0.569744232344864,0.569744232344864,null,0.569744232344864,0,null,2.49528217384519,2.49528217384519,null,2.49528217384519,0.563334430278884,null,0.563334430278884,0.563334430278884,null,0.563334430278884,0,null,0.563334430278884,0.563334430278884,null,0.563334430278884,0,null,5.66661287258982,5.66661287258982,null,5.66661287258982,4.09168397963303,null,4.09168397963303,4.09168397963303,null,4.09168397963303,2.4830377010205,null,2.4830377010205,2.4830377010205,null,2.4830377010205,1.36623809356051,null,1.36623809356051,1.36623809356051,null,1.36623809356051,1.26842126174941,null,1.26842126174941,1.26842126174941,null,1.26842126174941,0.645814039671752,null,0.645814039671752,0.645814039671752,null,0.645814039671752,0.421257128233749,null,0.421257128233749,0.421257128233749,null,0.421257128233749,0.306242441765692,null,0.306242441765692,0.306242441765692,null,0.306242441765692,0,null,0.306242441765692,0.306242441765692,null,0.306242441765692,0,null,0.421257128233749,0.421257128233749,null,0.421257128233749,0,null,0.645814039671752,0.645814039671752,null,0.645814039671752,0,null,1.26842126174941,1.26842126174941,null,1.26842126174941,0,null,1.36623809356051,1.36623809356051,null,1.36623809356051,0,null,2.4830377010205,2.4830377010205,null,2.4830377010205,1.95675558959206,null,1.95675558959206,1.95675558959206,null,1.95675558959206,0.844077646332324,null,0.844077646332324,0.844077646332324,null,0.844077646332324,0,null,0.844077646332324,0.844077646332324,null,0.844077646332324,0,null,1.95675558959206,1.95675558959206,null,1.95675558959206,1.20868821823899,null,1.20868821823899,1.20868821823899,null,1.20868821823899,0.714623664354412,null,0.714623664354412,0.714623664354412,null,0.714623664354412,0,null,0.714623664354412,0.714623664354412,null,0.714623664354412,0.45809313188215,null,0.45809313188215,0.45809313188215,null,0.45809313188215,0,null,0.45809313188215,0.45809313188215,null,0.45809313188215,0,null,1.20868821823899,1.20868821823899,null,1.20868821823899,1.07914654000495,null,1.07914654000495,1.07914654000495,null,1.07914654000495,0,null,1.07914654000495,1.07914654000495,null,1.07914654000495,0.839605362660778,null,0.839605362660778,0.839605362660778,null,0.839605362660778,0,null,0.839605362660778,0.839605362660778,null,0.839605362660778,0.509062321729453,null,0.509062321729453,0.509062321729453,null,0.509062321729453,0,null,0.509062321729453,0.509062321729453,null,0.509062321729453,0,null,4.09168397963303,4.09168397963303,null,4.09168397963303,2.1588881688502,null,2.1588881688502,2.1588881688502,null,2.1588881688502,1.41977111825586,null,1.41977111825586,1.41977111825586,null,1.41977111825586,0,null,1.41977111825586,1.41977111825586,null,1.41977111825586,0.466672832288324,null,0.466672832288324,0.466672832288324,null,0.466672832288324,0,null,0.466672832288324,0.466672832288324,null,0.466672832288324,0,null,2.1588881688502,2.1588881688502,null,2.1588881688502,1.56808980626249,null,1.56808980626249,1.56808980626249,null,1.56808980626249,1.01351324098317,null,1.01351324098317,1.01351324098317,null,1.01351324098317,0.5948864876001,null,0.5948864876001,0.5948864876001,null,0.5948864876001,0,null,0.5948864876001,0.5948864876001,null,0.5948864876001,0,null,1.01351324098317,1.01351324098317,null,1.01351324098317,0.344852169691175,null,0.344852169691175,0.344852169691175,null,0.344852169691175,0,null,0.344852169691175,0.344852169691175,null,0.344852169691175,0,null,1.56808980626249,1.56808980626249,null,1.56808980626249,1.26397059834744,null,1.26397059834744,1.26397059834744,null,1.26397059834744,0,null,1.26397059834744,1.26397059834744,null,1.26397059834744,0.469925626479487,null,0.469925626479487,0.469925626479487,null,0.469925626479487,0,null,0.469925626479487,0.469925626479487,null,0.469925626479487,0],"y":[15.1640625,7,null,7,7,null,7,4.5,null,4.5,4.5,null,4.5,2.5,null,2.5,2.5,null,2.5,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.5,6.5,null,6.5,6.5,null,6.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,7,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,15.1640625,23.328125,null,23.328125,23.328125,null,23.328125,17.21875,null,17.21875,17.21875,null,17.21875,15.03125,null,15.03125,15.03125,null,15.03125,14.0625,null,14.0625,14.0625,null,14.0625,13.125,null,13.125,13.125,null,13.125,12.25,null,12.25,12.25,null,12.25,11.5,null,11.5,11.5,null,11.5,11,null,11,11,null,11.5,12,null,12,12,null,12.25,13,null,13,13,null,13.125,14,null,14,14,null,14.0625,15,null,15,15,null,15.03125,16,null,16,16,null,17.21875,19.40625,null,19.40625,19.40625,null,19.40625,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,19.40625,21.3125,null,21.3125,21.3125,null,21.3125,19.75,null,19.75,19.75,null,19.75,19,null,19,19,null,19.75,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.3125,22.875,null,22.875,22.875,null,22.875,22,null,22,22,null,22.875,23.75,null,23.75,23.75,null,23.75,23,null,23,23,null,23.75,24.5,null,24.5,24.5,null,24.5,24,null,24,24,null,24.5,25,null,25,25,null,23.328125,29.4375,null,29.4375,29.4375,null,29.4375,26.75,null,26.75,26.75,null,26.75,26,null,26,26,null,26.75,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,29.4375,32.125,null,32.125,32.125,null,32.125,30.5,null,30.5,30.5,null,30.5,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.5,31.5,null,31.5,31.5,null,31.5,31,null,31,31,null,31.5,32,null,32,32,null,32.125,33.75,null,33.75,33.75,null,33.75,33,null,33,33,null,33.75,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[3],[2],[2],[2],[2],[2],[2],[3],[3],[2],[3],[2],[3],[3],[2],[2],[3],[3],[3],[3],[3]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 27"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 31"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333334","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[0.998295292193147,-1.80453092165217,-1.73266637838938,-1.47200595007867],[0.624601867308011,-1.80453092165217,-1.48438255753522,-1.32687860288781],[0.998295292193147,-1.35553626105151,-1.48438255753522,-1.61713329726952],[0.811448579750579,-1.20587137418463,-1.54645351274876,-1.32687860288781],[0.624601867308011,-0.607211826717082,-1.2981696918946,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.42231160232168,-1.18175125569696],[1.37198871707828,-1.05620648731774,-1.36024064710814,-1.47200595007867],[1.55883542952085,-0.607211826717082,-1.2981696918946,-1.18175125569696],[2.11937556684855,-0.457546939850196,-1.48438255753522,-1.47200595007867],[2.49306899173369,-0.158217166116423,-1.42231160232168,-1.18175125569696],[-0.870171832232529,-0.457546939850196,0.377746098870971,-0.020732478170122],[-0.683325119789961,-0.30788205298331,0.253604188443891,0.124394869020733],[-1.0570185446751,-0.457546939850196,0.129462278016812,0.124394869020733],[-0.683325119789961,-0.906541600450855,0.0673913228032718,0.269522216211587],[-1.0570185446751,-1.35553626105151,0.439817054084511,0.704904257784151],[-1.43071196956023,-1.20587137418463,-0.305034408477967,-0.310987172551831],[-1.6175586820028,0.290777494484236,0.129462278016812,-0.310987172551831],[-1.6175586820028,0.590107268218009,0.439817054084511,0.414649563402442],[-0.309631694904827,-0.158217166116423,0.253604188443891,0.124394869020733],[-0.496478407347395,0.440442381351122,0.129462278016812,0.124394869020733],[-0.496478407347395,0.440442381351122,0.56395896451159,-0.020732478170122],[-0.870171832232529,0.440442381351122,1.12259756143345,0.269522216211587],[-0.683325119789961,-0.00855227924953713,0.812242785365749,0.99515895216586],[-0.309631694904827,0.290777494484236,0.439817054084511,0.414649563402442],[-0.122784982462259,0.290777494484236,0.62602991972513,0.850031604975006],[0.624601867308011,0.290777494484236,0.439817054084511,0.559776910593297],[0.250908442422877,0.889437041951782,0.936384695792829,1.57566834092928],[0.624601867308011,0.739772155084895,1.12259756143345,1.72079568812013],[-0.122784982462259,1.18876681568555,0.377746098870971,0.269522216211587],[0.0640617299803088,1.63776147628621,0.68810087493867,0.414649563402442],[-0.122784982462259,1.03910192881867,1.06052660621991,0.850031604975006],[-0.122784982462259,1.03910192881867,0.874313740579289,1.14028629935672],[-1.0570185446751,1.33843170255244,1.24673947186053,0.850031604975006],[0.0640617299803088,1.63776147628621,0.998455651006369,1.28541364654757],[-0.122784982462259,1.93709125001999,1.30881042707407,1.28541364654757]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 0.998295292193147","row: 10<br>column: Sepal.Length<br>value: -1.80453092165217","row: 10<br>column: Petal.Length<br>value: -1.73266637838938","row: 10<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 7<br>column: Sepal.Width<br>value: 0.624601867308011","row: 7<br>column: Sepal.Length<br>value: -1.80453092165217","row: 7<br>column: Petal.Length<br>value: -1.48438255753522","row: 7<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 21<br>column: Sepal.Width<br>value: 0.998295292193147","row: 21<br>column: Sepal.Length<br>value: -1.35553626105151","row: 21<br>column: Petal.Length<br>value: -1.48438255753522","row: 21<br>column: Petal.Width<br>value: -1.61713329726952"],["row: 24<br>column: Sepal.Width<br>value: 0.811448579750579","row: 24<br>column: Sepal.Length<br>value: -1.20587137418463","row: 24<br>column: Petal.Length<br>value: -1.54645351274876","row: 24<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 22<br>column: Sepal.Width<br>value: 0.624601867308011","row: 22<br>column: Sepal.Length<br>value: -0.607211826717082","row: 22<br>column: Petal.Length<br>value: -1.2981696918946","row: 22<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 5<br>column: Sepal.Width<br>value: 0.624601867308011","row: 5<br>column: Sepal.Length<br>value: -0.607211826717082","row: 5<br>column: Petal.Length<br>value: -1.42231160232168","row: 5<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 25<br>column: Sepal.Width<br>value: 1.37198871707828","row: 25<br>column: Sepal.Length<br>value: -1.05620648731774","row: 25<br>column: Petal.Length<br>value: -1.36024064710814","row: 25<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 32<br>column: Sepal.Width<br>value: 1.55883542952085","row: 32<br>column: Sepal.Length<br>value: -0.607211826717082","row: 32<br>column: Petal.Length<br>value: -1.2981696918946","row: 32<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 14<br>column: Sepal.Width<br>value: 2.11937556684855","row: 14<br>column: Sepal.Length<br>value: -0.457546939850196","row: 14<br>column: Petal.Length<br>value: -1.48438255753522","row: 14<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 29<br>column: Sepal.Width<br>value: 2.49306899173369","row: 29<br>column: Sepal.Length<br>value: -0.158217166116423","row: 29<br>column: Petal.Length<br>value: -1.42231160232168","row: 29<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 20<br>column: Sepal.Width<br>value: -0.870171832232529","row: 20<br>column: Sepal.Length<br>value: -0.457546939850196","row: 20<br>column: Petal.Length<br>value: 0.377746098870971","row: 20<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 28<br>column: Sepal.Width<br>value: -0.683325119789961","row: 28<br>column: Sepal.Length<br>value: -0.30788205298331","row: 28<br>column: Petal.Length<br>value: 0.253604188443891","row: 28<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 26<br>column: Sepal.Width<br>value: -1.0570185446751","row: 26<br>column: Sepal.Length<br>value: -0.457546939850196","row: 26<br>column: Petal.Length<br>value: 0.129462278016812","row: 26<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 27<br>column: Sepal.Width<br>value: -0.683325119789961","row: 27<br>column: Sepal.Length<br>value: -0.906541600450855","row: 27<br>column: Petal.Length<br>value: 0.0673913228032718","row: 27<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 33<br>column: Sepal.Width<br>value: -1.0570185446751","row: 33<br>column: Sepal.Length<br>value: -1.35553626105151","row: 33<br>column: Petal.Length<br>value: 0.439817054084511","row: 33<br>column: Petal.Width<br>value: 0.704904257784151"],["row: 31<br>column: Sepal.Width<br>value: -1.43071196956023","row: 31<br>column: Sepal.Length<br>value: -1.20587137418463","row: 31<br>column: Petal.Length<br>value: -0.305034408477967","row: 31<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 18<br>column: Sepal.Width<br>value: -1.6175586820028","row: 18<br>column: Sepal.Length<br>value: 0.290777494484236","row: 18<br>column: Petal.Length<br>value: 0.129462278016812","row: 18<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 15<br>column: Sepal.Width<br>value: -1.6175586820028","row: 15<br>column: Sepal.Length<br>value: 0.590107268218009","row: 15<br>column: Petal.Length<br>value: 0.439817054084511","row: 15<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 19<br>column: Sepal.Width<br>value: -0.309631694904827","row: 19<br>column: Sepal.Length<br>value: -0.158217166116423","row: 19<br>column: Petal.Length<br>value: 0.253604188443891","row: 19<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 16<br>column: Sepal.Width<br>value: -0.496478407347395","row: 16<br>column: Sepal.Length<br>value: 0.440442381351122","row: 16<br>column: Petal.Length<br>value: 0.129462278016812","row: 16<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 9<br>column: Sepal.Width<br>value: -0.496478407347395","row: 9<br>column: Sepal.Length<br>value: 0.440442381351122","row: 9<br>column: Petal.Length<br>value: 0.56395896451159","row: 9<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 12<br>column: Sepal.Width<br>value: -0.870171832232529","row: 12<br>column: Sepal.Length<br>value: 0.440442381351122","row: 12<br>column: Petal.Length<br>value: 1.12259756143345","row: 12<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 4<br>column: Sepal.Width<br>value: -0.683325119789961","row: 4<br>column: Sepal.Length<br>value: -0.00855227924953713","row: 4<br>column: Petal.Length<br>value: 0.812242785365749","row: 4<br>column: Petal.Width<br>value: 0.99515895216586"],["row: 23<br>column: Sepal.Width<br>value: -0.309631694904827","row: 23<br>column: Sepal.Length<br>value: 0.290777494484236","row: 23<br>column: Petal.Length<br>value: 0.439817054084511","row: 23<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 34<br>column: Sepal.Width<br>value: -0.122784982462259","row: 34<br>column: Sepal.Length<br>value: 0.290777494484236","row: 34<br>column: Petal.Length<br>value: 0.62602991972513","row: 34<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 35<br>column: Sepal.Width<br>value: 0.624601867308011","row: 35<br>column: Sepal.Length<br>value: 0.290777494484236","row: 35<br>column: Petal.Length<br>value: 0.439817054084511","row: 35<br>column: Petal.Width<br>value: 0.559776910593297"],["row: 30<br>column: Sepal.Width<br>value: 0.250908442422877","row: 30<br>column: Sepal.Length<br>value: 0.889437041951782","row: 30<br>column: Petal.Length<br>value: 0.936384695792829","row: 30<br>column: Petal.Width<br>value: 1.57566834092928"],["row: 8<br>column: Sepal.Width<br>value: 0.624601867308011","row: 8<br>column: Sepal.Length<br>value: 0.739772155084895","row: 8<br>column: Petal.Length<br>value: 1.12259756143345","row: 8<br>column: Petal.Width<br>value: 1.72079568812013"],["row: 3<br>column: Sepal.Width<br>value: -0.122784982462259","row: 3<br>column: Sepal.Length<br>value: 1.18876681568555","row: 3<br>column: Petal.Length<br>value: 0.377746098870971","row: 3<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 11<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 11<br>column: Sepal.Length<br>value: 1.63776147628621","row: 11<br>column: Petal.Length<br>value: 0.68810087493867","row: 11<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 2<br>column: Sepal.Width<br>value: -0.122784982462259","row: 2<br>column: Sepal.Length<br>value: 1.03910192881867","row: 2<br>column: Petal.Length<br>value: 1.06052660621991","row: 2<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 17<br>column: Sepal.Width<br>value: -0.122784982462259","row: 17<br>column: Sepal.Length<br>value: 1.03910192881867","row: 17<br>column: Petal.Length<br>value: 0.874313740579289","row: 17<br>column: Petal.Width<br>value: 1.14028629935672"],["row: 6<br>column: Sepal.Width<br>value: -1.0570185446751","row: 6<br>column: Sepal.Length<br>value: 1.33843170255244","row: 6<br>column: Petal.Length<br>value: 1.24673947186053","row: 6<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 13<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 13<br>column: Sepal.Length<br>value: 1.63776147628621","row: 13<br>column: Petal.Length<br>value: 0.998455651006369","row: 13<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 1<br>column: Sepal.Width<br>value: -0.122784982462259","row: 1<br>column: Sepal.Length<br>value: 1.93709125001999","row: 1<br>column: Petal.Length<br>value: 1.30881042707407","row: 1<br>column: Petal.Width<br>value: 1.28541364654757"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,5.66661287258982],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Sepal.Length","Petal.Length","Petal.Width"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["10","7","21","24","22","5","25","32","14","29","20","28","26","27","33","31","18","15","19","16","9","12","4","23","34","35","30","8","3","11","2","17","6","13","1"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,10.5754514109665],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"f8b1992272e":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"f8b7ffbf8c3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"f8b77890bd9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"f8b1bd282ef":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[3],[2],[2],[2],[2],[2],[2],[3],[3],[2],[3],[2],[3],[3],[2],[2],[3],[3],[3],[3],[3]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 29"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 27"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 31"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 12"],["value: virginica<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 34"],["value: versicolor<br>variable: Species<br>row: 35"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 11"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 13"],["value: virginica<br>variable: Species<br>row: 1"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"f8b466910de":{"z":[[0.998295292193147,-1.80453092165217,-1.73266637838938,-1.47200595007867],[0.624601867308011,-1.80453092165217,-1.48438255753522,-1.32687860288781],[0.998295292193147,-1.35553626105151,-1.48438255753522,-1.61713329726952],[0.811448579750579,-1.20587137418463,-1.54645351274876,-1.32687860288781],[0.624601867308011,-0.607211826717082,-1.2981696918946,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.42231160232168,-1.18175125569696],[1.37198871707828,-1.05620648731774,-1.36024064710814,-1.47200595007867],[1.55883542952085,-0.607211826717082,-1.2981696918946,-1.18175125569696],[2.11937556684855,-0.457546939850196,-1.48438255753522,-1.47200595007867],[2.49306899173369,-0.158217166116423,-1.42231160232168,-1.18175125569696],[-0.870171832232529,-0.457546939850196,0.377746098870971,-0.020732478170122],[-0.683325119789961,-0.30788205298331,0.253604188443891,0.124394869020733],[-1.0570185446751,-0.457546939850196,0.129462278016812,0.124394869020733],[-0.683325119789961,-0.906541600450855,0.0673913228032718,0.269522216211587],[-1.0570185446751,-1.35553626105151,0.439817054084511,0.704904257784151],[-1.43071196956023,-1.20587137418463,-0.305034408477967,-0.310987172551831],[-1.6175586820028,0.290777494484236,0.129462278016812,-0.310987172551831],[-1.6175586820028,0.590107268218009,0.439817054084511,0.414649563402442],[-0.309631694904827,-0.158217166116423,0.253604188443891,0.124394869020733],[-0.496478407347395,0.440442381351122,0.129462278016812,0.124394869020733],[-0.496478407347395,0.440442381351122,0.56395896451159,-0.020732478170122],[-0.870171832232529,0.440442381351122,1.12259756143345,0.269522216211587],[-0.683325119789961,-0.00855227924953713,0.812242785365749,0.99515895216586],[-0.309631694904827,0.290777494484236,0.439817054084511,0.414649563402442],[-0.122784982462259,0.290777494484236,0.62602991972513,0.850031604975006],[0.624601867308011,0.290777494484236,0.439817054084511,0.559776910593297],[0.250908442422877,0.889437041951782,0.936384695792829,1.57566834092928],[0.624601867308011,0.739772155084895,1.12259756143345,1.72079568812013],[-0.122784982462259,1.18876681568555,0.377746098870971,0.269522216211587],[0.0640617299803088,1.63776147628621,0.68810087493867,0.414649563402442],[-0.122784982462259,1.03910192881867,1.06052660621991,0.850031604975006],[-0.122784982462259,1.03910192881867,0.874313740579289,1.14028629935672],[-1.0570185446751,1.33843170255244,1.24673947186053,0.850031604975006],[0.0640617299803088,1.63776147628621,0.998455651006369,1.28541364654757],[-0.122784982462259,1.93709125001999,1.30881042707407,1.28541364654757]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 10<br>column: Sepal.Width<br>value: 0.998295292193147","row: 10<br>column: Sepal.Length<br>value: -1.80453092165217","row: 10<br>column: Petal.Length<br>value: -1.73266637838938","row: 10<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 7<br>column: Sepal.Width<br>value: 0.624601867308011","row: 7<br>column: Sepal.Length<br>value: -1.80453092165217","row: 7<br>column: Petal.Length<br>value: -1.48438255753522","row: 7<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 21<br>column: Sepal.Width<br>value: 0.998295292193147","row: 21<br>column: Sepal.Length<br>value: -1.35553626105151","row: 21<br>column: Petal.Length<br>value: -1.48438255753522","row: 21<br>column: Petal.Width<br>value: -1.61713329726952"],["row: 24<br>column: Sepal.Width<br>value: 0.811448579750579","row: 24<br>column: Sepal.Length<br>value: -1.20587137418463","row: 24<br>column: Petal.Length<br>value: -1.54645351274876","row: 24<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 22<br>column: Sepal.Width<br>value: 0.624601867308011","row: 22<br>column: Sepal.Length<br>value: -0.607211826717082","row: 22<br>column: Petal.Length<br>value: -1.2981696918946","row: 22<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 5<br>column: Sepal.Width<br>value: 0.624601867308011","row: 5<br>column: Sepal.Length<br>value: -0.607211826717082","row: 5<br>column: Petal.Length<br>value: -1.42231160232168","row: 5<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 25<br>column: Sepal.Width<br>value: 1.37198871707828","row: 25<br>column: Sepal.Length<br>value: -1.05620648731774","row: 25<br>column: Petal.Length<br>value: -1.36024064710814","row: 25<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 32<br>column: Sepal.Width<br>value: 1.55883542952085","row: 32<br>column: Sepal.Length<br>value: -0.607211826717082","row: 32<br>column: Petal.Length<br>value: -1.2981696918946","row: 32<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 14<br>column: Sepal.Width<br>value: 2.11937556684855","row: 14<br>column: Sepal.Length<br>value: -0.457546939850196","row: 14<br>column: Petal.Length<br>value: -1.48438255753522","row: 14<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 29<br>column: Sepal.Width<br>value: 2.49306899173369","row: 29<br>column: Sepal.Length<br>value: -0.158217166116423","row: 29<br>column: Petal.Length<br>value: -1.42231160232168","row: 29<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 20<br>column: Sepal.Width<br>value: -0.870171832232529","row: 20<br>column: Sepal.Length<br>value: -0.457546939850196","row: 20<br>column: Petal.Length<br>value: 0.377746098870971","row: 20<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 28<br>column: Sepal.Width<br>value: -0.683325119789961","row: 28<br>column: Sepal.Length<br>value: -0.30788205298331","row: 28<br>column: Petal.Length<br>value: 0.253604188443891","row: 28<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 26<br>column: Sepal.Width<br>value: -1.0570185446751","row: 26<br>column: Sepal.Length<br>value: -0.457546939850196","row: 26<br>column: Petal.Length<br>value: 0.129462278016812","row: 26<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 27<br>column: Sepal.Width<br>value: -0.683325119789961","row: 27<br>column: Sepal.Length<br>value: -0.906541600450855","row: 27<br>column: Petal.Length<br>value: 0.0673913228032718","row: 27<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 33<br>column: Sepal.Width<br>value: -1.0570185446751","row: 33<br>column: Sepal.Length<br>value: -1.35553626105151","row: 33<br>column: Petal.Length<br>value: 0.439817054084511","row: 33<br>column: Petal.Width<br>value: 0.704904257784151"],["row: 31<br>column: Sepal.Width<br>value: -1.43071196956023","row: 31<br>column: Sepal.Length<br>value: -1.20587137418463","row: 31<br>column: Petal.Length<br>value: -0.305034408477967","row: 31<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 18<br>column: Sepal.Width<br>value: -1.6175586820028","row: 18<br>column: Sepal.Length<br>value: 0.290777494484236","row: 18<br>column: Petal.Length<br>value: 0.129462278016812","row: 18<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 15<br>column: Sepal.Width<br>value: -1.6175586820028","row: 15<br>column: Sepal.Length<br>value: 0.590107268218009","row: 15<br>column: Petal.Length<br>value: 0.439817054084511","row: 15<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 19<br>column: Sepal.Width<br>value: -0.309631694904827","row: 19<br>column: Sepal.Length<br>value: -0.158217166116423","row: 19<br>column: Petal.Length<br>value: 0.253604188443891","row: 19<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 16<br>column: Sepal.Width<br>value: -0.496478407347395","row: 16<br>column: Sepal.Length<br>value: 0.440442381351122","row: 16<br>column: Petal.Length<br>value: 0.129462278016812","row: 16<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 9<br>column: Sepal.Width<br>value: -0.496478407347395","row: 9<br>column: Sepal.Length<br>value: 0.440442381351122","row: 9<br>column: Petal.Length<br>value: 0.56395896451159","row: 9<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 12<br>column: Sepal.Width<br>value: -0.870171832232529","row: 12<br>column: Sepal.Length<br>value: 0.440442381351122","row: 12<br>column: Petal.Length<br>value: 1.12259756143345","row: 12<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 4<br>column: Sepal.Width<br>value: -0.683325119789961","row: 4<br>column: Sepal.Length<br>value: -0.00855227924953713","row: 4<br>column: Petal.Length<br>value: 0.812242785365749","row: 4<br>column: Petal.Width<br>value: 0.99515895216586"],["row: 23<br>column: Sepal.Width<br>value: -0.309631694904827","row: 23<br>column: Sepal.Length<br>value: 0.290777494484236","row: 23<br>column: Petal.Length<br>value: 0.439817054084511","row: 23<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 34<br>column: Sepal.Width<br>value: -0.122784982462259","row: 34<br>column: Sepal.Length<br>value: 0.290777494484236","row: 34<br>column: Petal.Length<br>value: 0.62602991972513","row: 34<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 35<br>column: Sepal.Width<br>value: 0.624601867308011","row: 35<br>column: Sepal.Length<br>value: 0.290777494484236","row: 35<br>column: Petal.Length<br>value: 0.439817054084511","row: 35<br>column: Petal.Width<br>value: 0.559776910593297"],["row: 30<br>column: Sepal.Width<br>value: 0.250908442422877","row: 30<br>column: Sepal.Length<br>value: 0.889437041951782","row: 30<br>column: Petal.Length<br>value: 0.936384695792829","row: 30<br>column: Petal.Width<br>value: 1.57566834092928"],["row: 8<br>column: Sepal.Width<br>value: 0.624601867308011","row: 8<br>column: Sepal.Length<br>value: 0.739772155084895","row: 8<br>column: Petal.Length<br>value: 1.12259756143345","row: 8<br>column: Petal.Width<br>value: 1.72079568812013"],["row: 3<br>column: Sepal.Width<br>value: -0.122784982462259","row: 3<br>column: Sepal.Length<br>value: 1.18876681568555","row: 3<br>column: Petal.Length<br>value: 0.377746098870971","row: 3<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 11<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 11<br>column: Sepal.Length<br>value: 1.63776147628621","row: 11<br>column: Petal.Length<br>value: 0.68810087493867","row: 11<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 2<br>column: Sepal.Width<br>value: -0.122784982462259","row: 2<br>column: Sepal.Length<br>value: 1.03910192881867","row: 2<br>column: Petal.Length<br>value: 1.06052660621991","row: 2<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 17<br>column: Sepal.Width<br>value: -0.122784982462259","row: 17<br>column: Sepal.Length<br>value: 1.03910192881867","row: 17<br>column: Petal.Length<br>value: 0.874313740579289","row: 17<br>column: Petal.Width<br>value: 1.14028629935672"],["row: 6<br>column: Sepal.Width<br>value: -1.0570185446751","row: 6<br>column: Sepal.Length<br>value: 1.33843170255244","row: 6<br>column: Petal.Length<br>value: 1.24673947186053","row: 6<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 13<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 13<br>column: Sepal.Length<br>value: 1.63776147628621","row: 13<br>column: Petal.Length<br>value: 0.998455651006369","row: 13<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 1<br>column: Sepal.Width<br>value: -0.122784982462259","row: 1<br>column: Sepal.Length<br>value: 1.93709125001999","row: 1<br>column: Petal.Length<br>value: 1.30881042707407","row: 1<br>column: Petal.Width<br>value: 1.28541364654757"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---

# Visualizaci√≥n previa

Con `seriate = ...` podemos cambiar el m√©todo de ordenaci√≥n para una mejor visualizaci√≥n


```r
heatmaply(iris_sample %&gt;% 
            mutate(across(where(is.numeric), ~scale(.))),
          seriate = "OLO",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

---

# Visualizaci√≥n previa

<div id="htmlwidget-ed18d622a76f1d8b9e78" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed18d622a76f1d8b9e78">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[10.5754514109665,10.5754514109665,null,10.5754514109665,0,null,10.5754514109665,10.5754514109665,null,10.5754514109665,4.24915701041922,null,4.24915701041922,4.24915701041922,null,4.24915701041922,0,null,4.24915701041922,4.24915701041922,null,4.24915701041922,1.790350286521,null,1.790350286521,1.790350286521,null,1.790350286521,0,null,1.790350286521,1.790350286521,null,1.790350286521,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[5.66661287258982,5.66661287258982,null,5.66661287258982,2.49528217384519,null,2.49528217384519,2.49528217384519,null,2.49528217384519,0.563334430278884,null,0.563334430278884,0.563334430278884,null,0.563334430278884,0,null,0.563334430278884,0.563334430278884,null,0.563334430278884,0,null,2.49528217384519,2.49528217384519,null,2.49528217384519,1.536913316389,null,1.536913316389,1.536913316389,null,1.536913316389,0.978284281983263,null,0.978284281983263,0.978284281983263,null,0.978284281983263,0.569744232344864,null,0.569744232344864,0.569744232344864,null,0.569744232344864,0,null,0.569744232344864,0.569744232344864,null,0.569744232344864,0,null,0.978284281983263,0.978284281983263,null,0.978284281983263,0.315688139680769,null,0.315688139680769,0.315688139680769,null,0.315688139680769,0,null,0.315688139680769,0.315688139680769,null,0.315688139680769,0,null,1.536913316389,1.536913316389,null,1.536913316389,0.670106055753407,null,0.670106055753407,0.670106055753407,null,0.670106055753407,0.3813290749513,null,0.3813290749513,0.3813290749513,null,0.3813290749513,0,null,0.3813290749513,0.3813290749513,null,0.3813290749513,0,null,0.670106055753407,0.670106055753407,null,0.670106055753407,0.471543824477617,null,0.471543824477617,0.471543824477617,null,0.471543824477617,0,null,0.471543824477617,0.471543824477617,null,0.471543824477617,0,null,5.66661287258982,5.66661287258982,null,5.66661287258982,4.09168397963303,null,4.09168397963303,4.09168397963303,null,4.09168397963303,2.4830377010205,null,2.4830377010205,2.4830377010205,null,2.4830377010205,1.36623809356051,null,1.36623809356051,1.36623809356051,null,1.36623809356051,0,null,1.36623809356051,1.36623809356051,null,1.36623809356051,1.26842126174941,null,1.26842126174941,1.26842126174941,null,1.26842126174941,0,null,1.26842126174941,1.26842126174941,null,1.26842126174941,0.645814039671752,null,0.645814039671752,0.645814039671752,null,0.645814039671752,0,null,0.645814039671752,0.645814039671752,null,0.645814039671752,0.421257128233749,null,0.421257128233749,0.421257128233749,null,0.421257128233749,0,null,0.421257128233749,0.421257128233749,null,0.421257128233749,0.306242441765692,null,0.306242441765692,0.306242441765692,null,0.306242441765692,0,null,0.306242441765692,0.306242441765692,null,0.306242441765692,0,null,2.4830377010205,2.4830377010205,null,2.4830377010205,1.95675558959206,null,1.95675558959206,1.95675558959206,null,1.95675558959206,1.20868821823899,null,1.20868821823899,1.20868821823899,null,1.20868821823899,0.714623664354412,null,0.714623664354412,0.714623664354412,null,0.714623664354412,0,null,0.714623664354412,0.714623664354412,null,0.714623664354412,0.45809313188215,null,0.45809313188215,0.45809313188215,null,0.45809313188215,0,null,0.45809313188215,0.45809313188215,null,0.45809313188215,0,null,1.20868821823899,1.20868821823899,null,1.20868821823899,1.07914654000495,null,1.07914654000495,1.07914654000495,null,1.07914654000495,0.839605362660778,null,0.839605362660778,0.839605362660778,null,0.839605362660778,0.509062321729453,null,0.509062321729453,0.509062321729453,null,0.509062321729453,0,null,0.509062321729453,0.509062321729453,null,0.509062321729453,0,null,0.839605362660778,0.839605362660778,null,0.839605362660778,0,null,1.07914654000495,1.07914654000495,null,1.07914654000495,0,null,1.95675558959206,1.95675558959206,null,1.95675558959206,0.844077646332324,null,0.844077646332324,0.844077646332324,null,0.844077646332324,0,null,0.844077646332324,0.844077646332324,null,0.844077646332324,0,null,4.09168397963303,4.09168397963303,null,4.09168397963303,2.1588881688502,null,2.1588881688502,2.1588881688502,null,2.1588881688502,1.56808980626249,null,1.56808980626249,1.56808980626249,null,1.56808980626249,1.26397059834744,null,1.26397059834744,1.26397059834744,null,1.26397059834744,0,null,1.26397059834744,1.26397059834744,null,1.26397059834744,0.469925626479487,null,0.469925626479487,0.469925626479487,null,0.469925626479487,0,null,0.469925626479487,0.469925626479487,null,0.469925626479487,0,null,1.56808980626249,1.56808980626249,null,1.56808980626249,1.01351324098317,null,1.01351324098317,1.01351324098317,null,1.01351324098317,0.5948864876001,null,0.5948864876001,0.5948864876001,null,0.5948864876001,0,null,0.5948864876001,0.5948864876001,null,0.5948864876001,0,null,1.01351324098317,1.01351324098317,null,1.01351324098317,0.344852169691175,null,0.344852169691175,0.344852169691175,null,0.344852169691175,0,null,0.344852169691175,0.344852169691175,null,0.344852169691175,0,null,2.1588881688502,2.1588881688502,null,2.1588881688502,1.41977111825586,null,1.41977111825586,1.41977111825586,null,1.41977111825586,0.466672832288324,null,0.466672832288324,0.466672832288324,null,0.466672832288324,0,null,0.466672832288324,0.466672832288324,null,0.466672832288324,0,null,1.41977111825586,1.41977111825586,null,1.41977111825586,0],"y":[14.1328125,4,null,4,4,null,4,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,4,6.5,null,6.5,6.5,null,6.5,4.5,null,4.5,4.5,null,4.5,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,4.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,8.5,null,8.5,8.5,null,8.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.5,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,14.1328125,24.265625,null,24.265625,24.265625,null,24.265625,17.09375,null,17.09375,17.09375,null,17.09375,11.96875,null,11.96875,11.96875,null,11.96875,11,null,11,11,null,11.96875,12.9375,null,12.9375,12.9375,null,12.9375,12,null,12,12,null,12.9375,13.875,null,13.875,13.875,null,13.875,13,null,13,13,null,13.875,14.75,null,14.75,14.75,null,14.75,14,null,14,14,null,14.75,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,17.09375,22.21875,null,22.21875,22.21875,null,22.21875,19.9375,null,19.9375,19.9375,null,19.9375,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,19.9375,22.125,null,22.125,22.125,null,22.125,21.25,null,21.25,21.25,null,21.25,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.25,22,null,22,22,null,22.125,23,null,23,23,null,22.21875,24.5,null,24.5,24.5,null,24.5,24,null,24,24,null,24.5,25,null,25,25,null,24.265625,31.4375,null,31.4375,31.4375,null,31.4375,28.625,null,28.625,28.625,null,28.625,26.75,null,26.75,26.75,null,26.75,26,null,26,26,null,26.75,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.625,30.5,null,30.5,30.5,null,30.5,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.5,31.5,null,31.5,31.5,null,31.5,31,null,31,31,null,31.5,32,null,32,32,null,31.4375,34.25,null,34.25,34.25,null,34.25,33.5,null,33.5,33.5,null,33.5,33,null,33,33,null,33.5,34,null,34,34,null,34.25,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[3],[2],[2],[2],[2],[2],[2],[2],[2],[3],[3],[3],[2],[2],[3],[3],[3],[2],[2],[3],[3],[3],[3],[2]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 12"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 13"],["value: versicolor<br>variable: Species<br>row: 11"],["value: versicolor<br>variable: Species<br>row: 3"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 35"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333334","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[2.49306899173369,-0.158217166116423,-1.42231160232168,-1.18175125569696],[2.11937556684855,-0.457546939850196,-1.48438255753522,-1.47200595007867],[1.55883542952085,-0.607211826717082,-1.2981696918946,-1.18175125569696],[1.37198871707828,-1.05620648731774,-1.36024064710814,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.2981696918946,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.42231160232168,-1.18175125569696],[0.811448579750579,-1.20587137418463,-1.54645351274876,-1.32687860288781],[0.998295292193147,-1.35553626105151,-1.48438255753522,-1.61713329726952],[0.998295292193147,-1.80453092165217,-1.73266637838938,-1.47200595007867],[0.624601867308011,-1.80453092165217,-1.48438255753522,-1.32687860288781],[-1.43071196956023,-1.20587137418463,-0.305034408477967,-0.310987172551831],[-1.0570185446751,-1.35553626105151,0.439817054084511,0.704904257784151],[-0.683325119789961,-0.906541600450855,0.0673913228032718,0.269522216211587],[-1.0570185446751,-0.457546939850196,0.129462278016812,0.124394869020733],[-0.870171832232529,-0.457546939850196,0.377746098870971,-0.020732478170122],[-0.683325119789961,-0.30788205298331,0.253604188443891,0.124394869020733],[-0.309631694904827,-0.158217166116423,0.253604188443891,0.124394869020733],[-0.496478407347395,0.440442381351122,0.129462278016812,0.124394869020733],[-0.496478407347395,0.440442381351122,0.56395896451159,-0.020732478170122],[-0.309631694904827,0.290777494484236,0.439817054084511,0.414649563402442],[-0.122784982462259,0.290777494484236,0.62602991972513,0.850031604975006],[-0.683325119789961,-0.00855227924953713,0.812242785365749,0.99515895216586],[-0.870171832232529,0.440442381351122,1.12259756143345,0.269522216211587],[-1.6175586820028,0.290777494484236,0.129462278016812,-0.310987172551831],[-1.6175586820028,0.590107268218009,0.439817054084511,0.414649563402442],[-1.0570185446751,1.33843170255244,1.24673947186053,0.850031604975006],[-0.122784982462259,1.93709125001999,1.30881042707407,1.28541364654757],[0.0640617299803088,1.63776147628621,0.998455651006369,1.28541364654757],[0.0640617299803088,1.63776147628621,0.68810087493867,0.414649563402442],[-0.122784982462259,1.18876681568555,0.377746098870971,0.269522216211587],[-0.122784982462259,1.03910192881867,1.06052660621991,0.850031604975006],[-0.122784982462259,1.03910192881867,0.874313740579289,1.14028629935672],[0.250908442422877,0.889437041951782,0.936384695792829,1.57566834092928],[0.624601867308011,0.739772155084895,1.12259756143345,1.72079568812013],[0.624601867308011,0.290777494484236,0.439817054084511,0.559776910593297]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 29<br>column: Sepal.Width<br>value: 2.49306899173369","row: 29<br>column: Sepal.Length<br>value: -0.158217166116423","row: 29<br>column: Petal.Length<br>value: -1.42231160232168","row: 29<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 14<br>column: Sepal.Width<br>value: 2.11937556684855","row: 14<br>column: Sepal.Length<br>value: -0.457546939850196","row: 14<br>column: Petal.Length<br>value: -1.48438255753522","row: 14<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 32<br>column: Sepal.Width<br>value: 1.55883542952085","row: 32<br>column: Sepal.Length<br>value: -0.607211826717082","row: 32<br>column: Petal.Length<br>value: -1.2981696918946","row: 32<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 25<br>column: Sepal.Width<br>value: 1.37198871707828","row: 25<br>column: Sepal.Length<br>value: -1.05620648731774","row: 25<br>column: Petal.Length<br>value: -1.36024064710814","row: 25<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 22<br>column: Sepal.Width<br>value: 0.624601867308011","row: 22<br>column: Sepal.Length<br>value: -0.607211826717082","row: 22<br>column: Petal.Length<br>value: -1.2981696918946","row: 22<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 5<br>column: Sepal.Width<br>value: 0.624601867308011","row: 5<br>column: Sepal.Length<br>value: -0.607211826717082","row: 5<br>column: Petal.Length<br>value: -1.42231160232168","row: 5<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 24<br>column: Sepal.Width<br>value: 0.811448579750579","row: 24<br>column: Sepal.Length<br>value: -1.20587137418463","row: 24<br>column: Petal.Length<br>value: -1.54645351274876","row: 24<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 21<br>column: Sepal.Width<br>value: 0.998295292193147","row: 21<br>column: Sepal.Length<br>value: -1.35553626105151","row: 21<br>column: Petal.Length<br>value: -1.48438255753522","row: 21<br>column: Petal.Width<br>value: -1.61713329726952"],["row: 10<br>column: Sepal.Width<br>value: 0.998295292193147","row: 10<br>column: Sepal.Length<br>value: -1.80453092165217","row: 10<br>column: Petal.Length<br>value: -1.73266637838938","row: 10<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 7<br>column: Sepal.Width<br>value: 0.624601867308011","row: 7<br>column: Sepal.Length<br>value: -1.80453092165217","row: 7<br>column: Petal.Length<br>value: -1.48438255753522","row: 7<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 31<br>column: Sepal.Width<br>value: -1.43071196956023","row: 31<br>column: Sepal.Length<br>value: -1.20587137418463","row: 31<br>column: Petal.Length<br>value: -0.305034408477967","row: 31<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 33<br>column: Sepal.Width<br>value: -1.0570185446751","row: 33<br>column: Sepal.Length<br>value: -1.35553626105151","row: 33<br>column: Petal.Length<br>value: 0.439817054084511","row: 33<br>column: Petal.Width<br>value: 0.704904257784151"],["row: 27<br>column: Sepal.Width<br>value: -0.683325119789961","row: 27<br>column: Sepal.Length<br>value: -0.906541600450855","row: 27<br>column: Petal.Length<br>value: 0.0673913228032718","row: 27<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 26<br>column: Sepal.Width<br>value: -1.0570185446751","row: 26<br>column: Sepal.Length<br>value: -0.457546939850196","row: 26<br>column: Petal.Length<br>value: 0.129462278016812","row: 26<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 20<br>column: Sepal.Width<br>value: -0.870171832232529","row: 20<br>column: Sepal.Length<br>value: -0.457546939850196","row: 20<br>column: Petal.Length<br>value: 0.377746098870971","row: 20<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 28<br>column: Sepal.Width<br>value: -0.683325119789961","row: 28<br>column: Sepal.Length<br>value: -0.30788205298331","row: 28<br>column: Petal.Length<br>value: 0.253604188443891","row: 28<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 19<br>column: Sepal.Width<br>value: -0.309631694904827","row: 19<br>column: Sepal.Length<br>value: -0.158217166116423","row: 19<br>column: Petal.Length<br>value: 0.253604188443891","row: 19<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 16<br>column: Sepal.Width<br>value: -0.496478407347395","row: 16<br>column: Sepal.Length<br>value: 0.440442381351122","row: 16<br>column: Petal.Length<br>value: 0.129462278016812","row: 16<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 9<br>column: Sepal.Width<br>value: -0.496478407347395","row: 9<br>column: Sepal.Length<br>value: 0.440442381351122","row: 9<br>column: Petal.Length<br>value: 0.56395896451159","row: 9<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 23<br>column: Sepal.Width<br>value: -0.309631694904827","row: 23<br>column: Sepal.Length<br>value: 0.290777494484236","row: 23<br>column: Petal.Length<br>value: 0.439817054084511","row: 23<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 34<br>column: Sepal.Width<br>value: -0.122784982462259","row: 34<br>column: Sepal.Length<br>value: 0.290777494484236","row: 34<br>column: Petal.Length<br>value: 0.62602991972513","row: 34<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 4<br>column: Sepal.Width<br>value: -0.683325119789961","row: 4<br>column: Sepal.Length<br>value: -0.00855227924953713","row: 4<br>column: Petal.Length<br>value: 0.812242785365749","row: 4<br>column: Petal.Width<br>value: 0.99515895216586"],["row: 12<br>column: Sepal.Width<br>value: -0.870171832232529","row: 12<br>column: Sepal.Length<br>value: 0.440442381351122","row: 12<br>column: Petal.Length<br>value: 1.12259756143345","row: 12<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 18<br>column: Sepal.Width<br>value: -1.6175586820028","row: 18<br>column: Sepal.Length<br>value: 0.290777494484236","row: 18<br>column: Petal.Length<br>value: 0.129462278016812","row: 18<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 15<br>column: Sepal.Width<br>value: -1.6175586820028","row: 15<br>column: Sepal.Length<br>value: 0.590107268218009","row: 15<br>column: Petal.Length<br>value: 0.439817054084511","row: 15<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 6<br>column: Sepal.Width<br>value: -1.0570185446751","row: 6<br>column: Sepal.Length<br>value: 1.33843170255244","row: 6<br>column: Petal.Length<br>value: 1.24673947186053","row: 6<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 1<br>column: Sepal.Width<br>value: -0.122784982462259","row: 1<br>column: Sepal.Length<br>value: 1.93709125001999","row: 1<br>column: Petal.Length<br>value: 1.30881042707407","row: 1<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 13<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 13<br>column: Sepal.Length<br>value: 1.63776147628621","row: 13<br>column: Petal.Length<br>value: 0.998455651006369","row: 13<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 11<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 11<br>column: Sepal.Length<br>value: 1.63776147628621","row: 11<br>column: Petal.Length<br>value: 0.68810087493867","row: 11<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 3<br>column: Sepal.Width<br>value: -0.122784982462259","row: 3<br>column: Sepal.Length<br>value: 1.18876681568555","row: 3<br>column: Petal.Length<br>value: 0.377746098870971","row: 3<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 2<br>column: Sepal.Width<br>value: -0.122784982462259","row: 2<br>column: Sepal.Length<br>value: 1.03910192881867","row: 2<br>column: Petal.Length<br>value: 1.06052660621991","row: 2<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 17<br>column: Sepal.Width<br>value: -0.122784982462259","row: 17<br>column: Sepal.Length<br>value: 1.03910192881867","row: 17<br>column: Petal.Length<br>value: 0.874313740579289","row: 17<br>column: Petal.Width<br>value: 1.14028629935672"],["row: 30<br>column: Sepal.Width<br>value: 0.250908442422877","row: 30<br>column: Sepal.Length<br>value: 0.889437041951782","row: 30<br>column: Petal.Length<br>value: 0.936384695792829","row: 30<br>column: Petal.Width<br>value: 1.57566834092928"],["row: 8<br>column: Sepal.Width<br>value: 0.624601867308011","row: 8<br>column: Sepal.Length<br>value: 0.739772155084895","row: 8<br>column: Petal.Length<br>value: 1.12259756143345","row: 8<br>column: Petal.Width<br>value: 1.72079568812013"],["row: 35<br>column: Sepal.Width<br>value: 0.624601867308011","row: 35<br>column: Sepal.Length<br>value: 0.290777494484236","row: 35<br>column: Petal.Length<br>value: 0.439817054084511","row: 35<br>column: Petal.Width<br>value: 0.559776910593297"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,5.66661287258982],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Sepal.Length","Petal.Length","Petal.Width"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["29","14","32","25","22","5","24","21","10","7","31","33","27","26","20","28","19","16","9","23","34","4","12","18","15","6","1","13","11","3","2","17","30","8","35"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,10.5754514109665],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"f8bcf12561":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"f8b68391f10":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"f8b7e2688e4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"f8b3c7a7a44":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[3],[2],[2],[2],[2],[2],[2],[2],[2],[3],[3],[3],[2],[2],[3],[3],[3],[2],[2],[3],[3],[3],[3],[2]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 29"],["value: setosa<br>variable: Species<br>row: 14"],["value: setosa<br>variable: Species<br>row: 32"],["value: setosa<br>variable: Species<br>row: 25"],["value: setosa<br>variable: Species<br>row: 22"],["value: setosa<br>variable: Species<br>row: 5"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 21"],["value: setosa<br>variable: Species<br>row: 10"],["value: setosa<br>variable: Species<br>row: 7"],["value: versicolor<br>variable: Species<br>row: 31"],["value: virginica<br>variable: Species<br>row: 33"],["value: versicolor<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 26"],["value: versicolor<br>variable: Species<br>row: 20"],["value: versicolor<br>variable: Species<br>row: 28"],["value: versicolor<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 4"],["value: virginica<br>variable: Species<br>row: 12"],["value: versicolor<br>variable: Species<br>row: 18"],["value: versicolor<br>variable: Species<br>row: 15"],["value: virginica<br>variable: Species<br>row: 6"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 13"],["value: versicolor<br>variable: Species<br>row: 11"],["value: versicolor<br>variable: Species<br>row: 3"],["value: virginica<br>variable: Species<br>row: 2"],["value: virginica<br>variable: Species<br>row: 17"],["value: virginica<br>variable: Species<br>row: 30"],["value: virginica<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 35"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"f8b13e57170":{"z":[[2.49306899173369,-0.158217166116423,-1.42231160232168,-1.18175125569696],[2.11937556684855,-0.457546939850196,-1.48438255753522,-1.47200595007867],[1.55883542952085,-0.607211826717082,-1.2981696918946,-1.18175125569696],[1.37198871707828,-1.05620648731774,-1.36024064710814,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.2981696918946,-1.47200595007867],[0.624601867308011,-0.607211826717082,-1.42231160232168,-1.18175125569696],[0.811448579750579,-1.20587137418463,-1.54645351274876,-1.32687860288781],[0.998295292193147,-1.35553626105151,-1.48438255753522,-1.61713329726952],[0.998295292193147,-1.80453092165217,-1.73266637838938,-1.47200595007867],[0.624601867308011,-1.80453092165217,-1.48438255753522,-1.32687860288781],[-1.43071196956023,-1.20587137418463,-0.305034408477967,-0.310987172551831],[-1.0570185446751,-1.35553626105151,0.439817054084511,0.704904257784151],[-0.683325119789961,-0.906541600450855,0.0673913228032718,0.269522216211587],[-1.0570185446751,-0.457546939850196,0.129462278016812,0.124394869020733],[-0.870171832232529,-0.457546939850196,0.377746098870971,-0.020732478170122],[-0.683325119789961,-0.30788205298331,0.253604188443891,0.124394869020733],[-0.309631694904827,-0.158217166116423,0.253604188443891,0.124394869020733],[-0.496478407347395,0.440442381351122,0.129462278016812,0.124394869020733],[-0.496478407347395,0.440442381351122,0.56395896451159,-0.020732478170122],[-0.309631694904827,0.290777494484236,0.439817054084511,0.414649563402442],[-0.122784982462259,0.290777494484236,0.62602991972513,0.850031604975006],[-0.683325119789961,-0.00855227924953713,0.812242785365749,0.99515895216586],[-0.870171832232529,0.440442381351122,1.12259756143345,0.269522216211587],[-1.6175586820028,0.290777494484236,0.129462278016812,-0.310987172551831],[-1.6175586820028,0.590107268218009,0.439817054084511,0.414649563402442],[-1.0570185446751,1.33843170255244,1.24673947186053,0.850031604975006],[-0.122784982462259,1.93709125001999,1.30881042707407,1.28541364654757],[0.0640617299803088,1.63776147628621,0.998455651006369,1.28541364654757],[0.0640617299803088,1.63776147628621,0.68810087493867,0.414649563402442],[-0.122784982462259,1.18876681568555,0.377746098870971,0.269522216211587],[-0.122784982462259,1.03910192881867,1.06052660621991,0.850031604975006],[-0.122784982462259,1.03910192881867,0.874313740579289,1.14028629935672],[0.250908442422877,0.889437041951782,0.936384695792829,1.57566834092928],[0.624601867308011,0.739772155084895,1.12259756143345,1.72079568812013],[0.624601867308011,0.290777494484236,0.439817054084511,0.559776910593297]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 29<br>column: Sepal.Width<br>value: 2.49306899173369","row: 29<br>column: Sepal.Length<br>value: -0.158217166116423","row: 29<br>column: Petal.Length<br>value: -1.42231160232168","row: 29<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 14<br>column: Sepal.Width<br>value: 2.11937556684855","row: 14<br>column: Sepal.Length<br>value: -0.457546939850196","row: 14<br>column: Petal.Length<br>value: -1.48438255753522","row: 14<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 32<br>column: Sepal.Width<br>value: 1.55883542952085","row: 32<br>column: Sepal.Length<br>value: -0.607211826717082","row: 32<br>column: Petal.Length<br>value: -1.2981696918946","row: 32<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 25<br>column: Sepal.Width<br>value: 1.37198871707828","row: 25<br>column: Sepal.Length<br>value: -1.05620648731774","row: 25<br>column: Petal.Length<br>value: -1.36024064710814","row: 25<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 22<br>column: Sepal.Width<br>value: 0.624601867308011","row: 22<br>column: Sepal.Length<br>value: -0.607211826717082","row: 22<br>column: Petal.Length<br>value: -1.2981696918946","row: 22<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 5<br>column: Sepal.Width<br>value: 0.624601867308011","row: 5<br>column: Sepal.Length<br>value: -0.607211826717082","row: 5<br>column: Petal.Length<br>value: -1.42231160232168","row: 5<br>column: Petal.Width<br>value: -1.18175125569696"],["row: 24<br>column: Sepal.Width<br>value: 0.811448579750579","row: 24<br>column: Sepal.Length<br>value: -1.20587137418463","row: 24<br>column: Petal.Length<br>value: -1.54645351274876","row: 24<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 21<br>column: Sepal.Width<br>value: 0.998295292193147","row: 21<br>column: Sepal.Length<br>value: -1.35553626105151","row: 21<br>column: Petal.Length<br>value: -1.48438255753522","row: 21<br>column: Petal.Width<br>value: -1.61713329726952"],["row: 10<br>column: Sepal.Width<br>value: 0.998295292193147","row: 10<br>column: Sepal.Length<br>value: -1.80453092165217","row: 10<br>column: Petal.Length<br>value: -1.73266637838938","row: 10<br>column: Petal.Width<br>value: -1.47200595007867"],["row: 7<br>column: Sepal.Width<br>value: 0.624601867308011","row: 7<br>column: Sepal.Length<br>value: -1.80453092165217","row: 7<br>column: Petal.Length<br>value: -1.48438255753522","row: 7<br>column: Petal.Width<br>value: -1.32687860288781"],["row: 31<br>column: Sepal.Width<br>value: -1.43071196956023","row: 31<br>column: Sepal.Length<br>value: -1.20587137418463","row: 31<br>column: Petal.Length<br>value: -0.305034408477967","row: 31<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 33<br>column: Sepal.Width<br>value: -1.0570185446751","row: 33<br>column: Sepal.Length<br>value: -1.35553626105151","row: 33<br>column: Petal.Length<br>value: 0.439817054084511","row: 33<br>column: Petal.Width<br>value: 0.704904257784151"],["row: 27<br>column: Sepal.Width<br>value: -0.683325119789961","row: 27<br>column: Sepal.Length<br>value: -0.906541600450855","row: 27<br>column: Petal.Length<br>value: 0.0673913228032718","row: 27<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 26<br>column: Sepal.Width<br>value: -1.0570185446751","row: 26<br>column: Sepal.Length<br>value: -0.457546939850196","row: 26<br>column: Petal.Length<br>value: 0.129462278016812","row: 26<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 20<br>column: Sepal.Width<br>value: -0.870171832232529","row: 20<br>column: Sepal.Length<br>value: -0.457546939850196","row: 20<br>column: Petal.Length<br>value: 0.377746098870971","row: 20<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 28<br>column: Sepal.Width<br>value: -0.683325119789961","row: 28<br>column: Sepal.Length<br>value: -0.30788205298331","row: 28<br>column: Petal.Length<br>value: 0.253604188443891","row: 28<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 19<br>column: Sepal.Width<br>value: -0.309631694904827","row: 19<br>column: Sepal.Length<br>value: -0.158217166116423","row: 19<br>column: Petal.Length<br>value: 0.253604188443891","row: 19<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 16<br>column: Sepal.Width<br>value: -0.496478407347395","row: 16<br>column: Sepal.Length<br>value: 0.440442381351122","row: 16<br>column: Petal.Length<br>value: 0.129462278016812","row: 16<br>column: Petal.Width<br>value: 0.124394869020733"],["row: 9<br>column: Sepal.Width<br>value: -0.496478407347395","row: 9<br>column: Sepal.Length<br>value: 0.440442381351122","row: 9<br>column: Petal.Length<br>value: 0.56395896451159","row: 9<br>column: Petal.Width<br>value: -0.020732478170122"],["row: 23<br>column: Sepal.Width<br>value: -0.309631694904827","row: 23<br>column: Sepal.Length<br>value: 0.290777494484236","row: 23<br>column: Petal.Length<br>value: 0.439817054084511","row: 23<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 34<br>column: Sepal.Width<br>value: -0.122784982462259","row: 34<br>column: Sepal.Length<br>value: 0.290777494484236","row: 34<br>column: Petal.Length<br>value: 0.62602991972513","row: 34<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 4<br>column: Sepal.Width<br>value: -0.683325119789961","row: 4<br>column: Sepal.Length<br>value: -0.00855227924953713","row: 4<br>column: Petal.Length<br>value: 0.812242785365749","row: 4<br>column: Petal.Width<br>value: 0.99515895216586"],["row: 12<br>column: Sepal.Width<br>value: -0.870171832232529","row: 12<br>column: Sepal.Length<br>value: 0.440442381351122","row: 12<br>column: Petal.Length<br>value: 1.12259756143345","row: 12<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 18<br>column: Sepal.Width<br>value: -1.6175586820028","row: 18<br>column: Sepal.Length<br>value: 0.290777494484236","row: 18<br>column: Petal.Length<br>value: 0.129462278016812","row: 18<br>column: Petal.Width<br>value: -0.310987172551831"],["row: 15<br>column: Sepal.Width<br>value: -1.6175586820028","row: 15<br>column: Sepal.Length<br>value: 0.590107268218009","row: 15<br>column: Petal.Length<br>value: 0.439817054084511","row: 15<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 6<br>column: Sepal.Width<br>value: -1.0570185446751","row: 6<br>column: Sepal.Length<br>value: 1.33843170255244","row: 6<br>column: Petal.Length<br>value: 1.24673947186053","row: 6<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 1<br>column: Sepal.Width<br>value: -0.122784982462259","row: 1<br>column: Sepal.Length<br>value: 1.93709125001999","row: 1<br>column: Petal.Length<br>value: 1.30881042707407","row: 1<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 13<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 13<br>column: Sepal.Length<br>value: 1.63776147628621","row: 13<br>column: Petal.Length<br>value: 0.998455651006369","row: 13<br>column: Petal.Width<br>value: 1.28541364654757"],["row: 11<br>column: Sepal.Width<br>value: 0.0640617299803088","row: 11<br>column: Sepal.Length<br>value: 1.63776147628621","row: 11<br>column: Petal.Length<br>value: 0.68810087493867","row: 11<br>column: Petal.Width<br>value: 0.414649563402442"],["row: 3<br>column: Sepal.Width<br>value: -0.122784982462259","row: 3<br>column: Sepal.Length<br>value: 1.18876681568555","row: 3<br>column: Petal.Length<br>value: 0.377746098870971","row: 3<br>column: Petal.Width<br>value: 0.269522216211587"],["row: 2<br>column: Sepal.Width<br>value: -0.122784982462259","row: 2<br>column: Sepal.Length<br>value: 1.03910192881867","row: 2<br>column: Petal.Length<br>value: 1.06052660621991","row: 2<br>column: Petal.Width<br>value: 0.850031604975006"],["row: 17<br>column: Sepal.Width<br>value: -0.122784982462259","row: 17<br>column: Sepal.Length<br>value: 1.03910192881867","row: 17<br>column: Petal.Length<br>value: 0.874313740579289","row: 17<br>column: Petal.Width<br>value: 1.14028629935672"],["row: 30<br>column: Sepal.Width<br>value: 0.250908442422877","row: 30<br>column: Sepal.Length<br>value: 0.889437041951782","row: 30<br>column: Petal.Length<br>value: 0.936384695792829","row: 30<br>column: Petal.Width<br>value: 1.57566834092928"],["row: 8<br>column: Sepal.Width<br>value: 0.624601867308011","row: 8<br>column: Sepal.Length<br>value: 0.739772155084895","row: 8<br>column: Petal.Length<br>value: 1.12259756143345","row: 8<br>column: Petal.Width<br>value: 1.72079568812013"],["row: 35<br>column: Sepal.Width<br>value: 0.624601867308011","row: 35<br>column: Sepal.Length<br>value: 0.290777494484236","row: 35<br>column: Petal.Length<br>value: 0.439817054084511","row: 35<br>column: Petal.Width<br>value: 0.559776910593297"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---

# Visualizaci√≥n previa

Otra forma de ver las relaciones entre individuos es calcular su **matriz de distancias** con `dist()`, indic√°ndole en `method = ...` el tipo de m√©trica.



```r
d &lt;- dist(iris_sample %&gt;%
            select(-Species) %&gt;% 
            mutate(across(where(is.numeric), ~scale(.))),
          method = "euclidean")
d
```

```
&gt;            1         2         3         4         5         6         7
&gt; 2  1.0283906                                                            
&gt; 3  1.5680898 0.9086143                                                  
&gt; 4  2.1048898 1.2224939 1.5694312                                        
&gt; 5  4.5362975 3.6826028 3.0216765 3.4352929                              
&gt; 6  1.1935644 0.9985319 1.4097278 1.4710071 4.2267424                    
&gt; 7  5.4022515 4.4564936 3.9413750 3.9500074 1.2076787 4.9903935          
&gt; 8  1.4887555 1.1875472 1.8496437 1.7010383 4.0884847 1.9899452 4.7495412
&gt; 9  2.1541648 1.2259076 0.9047426 1.1533378 2.7654359 1.5313423 3.4926275
&gt; 10 5.6666129 4.7472997 4.2075425 4.3147250 1.3243065 5.3264666 0.4715438
&gt; 11 1.1260641 0.8494489 0.5948865 1.9029815 3.5151738 1.3594315 4.4627555
&gt; 12 1.9660253 1.1215277 1.2935920 0.9270257 3.4517655 1.0925653 4.0766524
&gt; 13 0.4699256 0.7659734 1.2860107 1.8406138 4.1594624 1.2639706 5.0151908
&gt; 14 5.1153559 4.3744329 3.7733376 4.4065994 1.5312898 5.1152619 2.0173686
&gt; 15 2.3584092 1.7351607 1.6179173 1.3064753 3.5322621 1.3095327 4.1829464
&gt; 16 2.2623950 1.3753071 0.8845016 1.2086882 2.5433089 1.7016013 3.3177426
&gt; 17 1.0080844 0.3448522 1.0135132 1.1986239 3.7329991 1.0887329 4.5050178
&gt; 18 2.9806132 2.2381205 1.8545536 1.7704795 2.9999835 2.0020134 3.6130502
&gt; 19 2.6242435 1.6267013 1.3732264 1.1101142 2.3641277 2.0763938 2.9512597
&gt; 20 2.9775456 2.0057328 1.8311701 1.2071995 2.6162799 2.1849097 3.0368166
&gt; 21 5.3221164 4.4220559 3.8415220 4.0915488 0.9450114 5.0027701 0.6522965
&gt; 22 4.6294463 3.7715040 3.1025377 3.5510294 0.3156881 4.2990461 1.2203730
&gt; 23 2.0636473 1.0815447 0.9307047 0.8396054 2.7740216 1.5801417 3.4638958
&gt; 24 5.0722391 4.1770780 3.5858227 3.8240330 0.6555746 4.7439975 0.6302045
&gt; 25 5.0913040 4.2280774 3.6507221 4.0160280 0.9210233 4.8808372 1.0747324
&gt; 26 3.0571083 2.1227764 1.9146405 1.2512643 2.6389897 2.2361566 3.0582516
&gt; 27 3.3126439 2.3287428 2.1910825 1.3739495 2.4750113 2.6281943 2.7337805
&gt; 28 2.7956279 1.8183079 1.6095454 1.0769891 2.5129629 2.0887465 3.0128763
&gt; 29 4.9778449 4.3091637 3.7421198 4.4546661 1.9216570 5.1083319 2.4952822
&gt; 30 1.2083769 0.8390508 1.4991130 1.4253349 3.9428943 1.5922117 4.6563938
&gt; 31 4.0916840 3.1564695 2.8719585 2.2240697 2.5669528 3.2201074 2.6468105
&gt; 32 4.7100502 3.9025358 3.3118386 3.8181744 0.9424455 4.6079198 1.5369133
&gt; 33 3.5785931 2.6482875 2.7458479 1.4754529 3.2272014 2.8159633 3.2954710
&gt; 34 1.8346923 0.8653189 1.0977344 0.6778943 3.1126864 1.5348134 3.7605430
&gt; 35 2.1332216 1.2602003 1.2054346 1.4589482 2.7031146 2.1588882 3.4135510
&gt;            8         9        10        11        12        13        14
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9  2.1659679                                                            
&gt; 10 4.9959623 3.8281766                                                  
&gt; 11 1.7364893 1.3974072 4.7055024                                        
&gt; 12 2.1047901 0.7321008 4.4403296 1.5862581                              
&gt; 13 1.1513291 1.9085553 5.2711061 0.9244188 1.8313416                    
&gt; 14 4.5451347 3.7351003 1.7699807 4.1102051 4.4241433 4.7310127          
&gt; 15 2.6873575 1.2182731 4.5668520 1.9967652 1.0335559 2.2351138 4.7248566
&gt; 16 2.2093512 0.4580931 3.6455826 1.4642756 1.0709932 1.9623691 3.5779977
&gt; 17 1.0231429 1.3936731 4.7920230 0.9769999 1.3178981 0.6555746 4.4333690
&gt; 18 3.2161063 1.2458955 4.0060576 2.3411191 1.3799621 2.8188399 4.2985029
&gt; 19 2.2322236 0.7146237 3.3037537 1.9074122 1.2036652 2.2952025 3.3998188
&gt; 20 2.6936305 0.9903064 3.4446438 2.3556289 1.2022630 2.7119011 3.8093453
&gt; 21 4.7400506 3.4934347 0.5332007 4.3220886 4.1318910 4.9418507 1.4436993
&gt; 22 4.2271104 2.8156914 1.3274062 3.5859239 3.4964213 4.2698901 1.5137448
&gt; 23 1.8018311 0.5121328 3.7921160 1.4197385 0.9076651 1.7390572 3.7043325
&gt; 24 4.4980654 3.2528265 0.6701061 4.0830122 3.9000674 4.6845991 1.5151162
&gt; 25 4.4880502 3.3970378 0.9156075 4.0894142 4.0576653 4.7047792 0.9656043
&gt; 26 2.7921736 1.1534467 3.4719878 2.4583456 1.3596603 2.7839275 3.9041606
&gt; 27 2.7641774 1.4765178 3.1475959 2.7273444 1.7212605 2.9884748 3.6739148
&gt; 28 2.4722252 0.8439687 3.4002311 2.1487557 1.1709452 2.4993768 3.6669639
&gt; 29 4.3816544 3.8195579 2.2639049 4.0159621 4.5002822 4.5904937 0.5633344
&gt; 30 0.4666728 1.8567121 4.9222152 1.4158074 1.7886056 0.8264392 4.5226063
&gt; 31 3.7651186 2.1029833 3.1055703 3.4399800 2.3237208 3.8168283 3.9877234
&gt; 32 4.1197149 3.1839256 1.4215532 3.7105282 3.8683284 4.3169021 0.6749280
&gt; 33 2.9523532 2.0203228 3.7261956 3.2190907 1.9789385 3.2963192 4.3974250
&gt; 34 1.3285303 0.9613164 4.0746098 1.4292263 1.0791465 1.4756477 3.9284822
&gt; 35 1.4197711 1.2773500 3.6575661 1.4870366 1.6754656 1.7225553 3.2596048
&gt;           15        16        17        18        19        20        21
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9                                                                       
&gt; 10                                                                      
&gt; 11                                                                      
&gt; 12                                                                      
&gt; 13                                                                      
&gt; 14                                                                      
&gt; 15                                                                      
&gt; 16 1.2082170                                                            
&gt; 17 1.7751847 1.4439111                                                  
&gt; 18 0.8440776 1.2119316 2.3356661                                        
&gt; 19 1.5458284 0.6393091 1.6987644 1.4550732                              
&gt; 20 1.3599915 1.0142674 2.0959697 1.1244862 0.6635335                    
&gt; 21 4.2963830 3.3312615 4.4897577 3.7233794 3.0327816 3.2114752          
&gt; 22 3.6112219 2.6345833 3.8487259 3.0364068 2.4557863 2.6779911 0.8691222
&gt; 23 1.3417419 0.4877286 1.1446559 1.5275935 0.5661442 1.0332497 3.5002440
&gt; 24 4.0129549 3.0554722 4.2260755 3.4613239 2.7750320 2.9658723 0.3813291
&gt; 25 4.2950459 3.2401910 4.2944115 3.7840374 2.9643250 3.2422939 0.5154787
&gt; 26 1.2618845 1.0585793 2.1678536 1.0313836 0.8146144 0.3429555 3.2662081
&gt; 27 1.8090089 1.3690114 2.3471446 1.6270247 0.8691222 0.6458140 2.9994857
&gt; 28 1.3409326 0.7812249 1.8830525 1.1983966 0.4025498 0.3062424 3.1589468
&gt; 29 4.8449219 3.6619403 4.3523110 4.5016762 3.5170787 3.9986447 1.9650272
&gt; 30 2.2749311 1.8755004 0.5962019 2.8390413 1.9960382 2.4355204 4.6532342
&gt; 31 2.0836994 1.9903483 3.2011927 1.5696041 1.6899807 1.1935794 3.0032242
&gt; 32 4.1342649 3.0109874 3.9559751 3.7003010 2.7940625 3.1747652 1.0480589
&gt; 33 2.0454784 1.9932526 2.6429963 2.0378689 1.5374741 1.1711951 3.6494818
&gt; 34 1.5963018 0.9670442 0.8401679 1.9567556 0.9496091 1.3922828 3.8089255
&gt; 35 2.2667034 1.2510388 1.2823241 2.4252493 1.1395707 1.7706445 3.3602794
&gt;           22        23        24        25        26        27        28
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9                                                                       
&gt; 10                                                                      
&gt; 11                                                                      
&gt; 12                                                                      
&gt; 13                                                                      
&gt; 14                                                                      
&gt; 15                                                                      
&gt; 16                                                                      
&gt; 17                                                                      
&gt; 18                                                                      
&gt; 19                                                                      
&gt; 20                                                                      
&gt; 21                                                                      
&gt; 22                                                                      
&gt; 23 2.8738901                                                            
&gt; 24 0.6899360 3.2365058                                                  
&gt; 25 0.8740916 3.3825863 0.6263721                                        
&gt; 26 2.7270635 1.1398002 2.9943359 3.3205692                              
&gt; 27 2.5880395 1.3164280 2.7343989 3.0525019 0.6051097                    
&gt; 28 2.5993786 0.7854700 2.8960552 3.1523476 0.4212571 0.6435297          
&gt; 29 1.9474149 3.7513659 1.9904521 1.4667332 4.0996024 3.8697388 3.8244726
&gt; 30 4.0818080 1.5057033 4.3924693 4.4277710 2.5064631 2.5611519 2.2087891
&gt; 31 2.6300172 2.1396568 2.7568897 3.2154246 1.0382587 1.0601309 1.3662381
&gt; 32 0.9782843 3.1411220 0.9998436 0.5697442 3.2571832 3.0146034 3.0382400
&gt; 33 3.3387681 1.8311701 3.4039655 3.7374885 1.1134164 0.8182307 1.2684213
&gt; 34 3.2340956 0.5090623 3.5456131 3.6586669 1.4852306 1.5481752 1.1566538
&gt; 35 2.8204830 0.9454387 3.1272367 3.1211059 1.9166936 1.8349918 1.5143642
&gt;           29        30        31        32        33        34
&gt; 2                                                             
&gt; 3                                                             
&gt; 4                                                             
&gt; 5                                                             
&gt; 6                                                             
&gt; 7                                                             
&gt; 8                                                             
&gt; 9                                                             
&gt; 10                                                            
&gt; 11                                                            
&gt; 12                                                            
&gt; 13                                                            
&gt; 14                                                            
&gt; 15                                                            
&gt; 16                                                            
&gt; 17                                                            
&gt; 18                                                            
&gt; 19                                                            
&gt; 20                                                            
&gt; 21                                                            
&gt; 22                                                            
&gt; 23                                                            
&gt; 24                                                            
&gt; 25                                                            
&gt; 26                                                            
&gt; 27                                                            
&gt; 28                                                            
&gt; 29                                                            
&gt; 30 4.3922289                                                  
&gt; 31 4.3011830 3.5098084                                        
&gt; 32 1.0439348 4.0678283 3.3226999                              
&gt; 33 4.5895192 2.7848497 1.3224543 3.7393513                    
&gt; 34 3.9202210 1.0587298 2.4830377 3.3859884 1.9075845          
&gt; 35 3.1926805 1.3329122 2.7887823 2.7807725 2.3578079 0.8231100
```

---

# Visualizaci√≥n previa

.pull-left[

Con `fviz_dist()` podremos visualizar dicha matriz de distancias.


```r
fviz_dist(d, show_labels = TRUE)
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-82-1.png" width="100%" /&gt;

]


---

name: jerarquicos
class: center, middle

# Algoritmos jer√°rquicos

---

# Algoritmos jer√°rquicos: simple

.pull-left[

En nuestro caso empezaremos usando solo **algoritmos aglomerativos**, de forma que empezaremos con un cl√∫ster por individuo, e iremos **juntando cl√∫ster** en base a distintos enlaces

* **Enlace simple (single)** o del vecino m√°s cercano: la distancia entre dos cl√∫steres ser√° definida como la **distancia m√≠nima** entre pares de observaciones (cada una perteneciente a uno de los dos cl√∫steres)

`$$d(C_k, C_l) = \min_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, cex = 1) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-84-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

Con `cutree()` podemos indicarle el corte del n√∫mero de cl√∫sters que queremos


```r
single_clust &lt;-
  hclust(d, method = "single")

# Seleccionamos 3 clusters
groups &lt;- cutree(single_clust, k = 3)
```

Con `fviz_dend()` podemos visualizar el dendograma


```r
# k = 3
fviz_dend(single_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (simple)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-87-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

Con `fviz_cluster()` visualizaremos los cl√∫sters en base a las dos componentes que m√°s varianza capturen


```r
# Estandarizamos datos
iris_scale &lt;-
  iris_sample %&gt;%
  select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-89-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: simple

.pull-left[

As√≠ quedar√≠a con todas las observaciones


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")
groups &lt;- cutree(single_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-91-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: complete

.pull-left[

* **Enlace completo (complete)** o del vecino m√°s alejado (complete): la distancia entre dos cl√∫steres ser√° definida como la **distancia m√°xima** entre pares de observaciones (cada una perteneciente a uno de los dos cl√∫steres)

`$$d(C_k, C_l) = \max_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# k = 3
fviz_dend(complete_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-93-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: complete

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
complete_clust &lt;-
  hclust(d, method = "complete")
groups &lt;- cutree(complete_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (complete)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-95-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: average

.pull-left[

* **Enlace medio (average)**: la distancia entre dos cl√∫steres ser√° definida como la **distancia media** entre observaciones de distintos grupos

`$$d(C_k, C_l) = \frac{\sum_{x_i \in C_k} \sum_{x_j \in C_l} d(x_i, x_j)}{n_k n_l}$$`

siendo `\(n_k\)` el n√∫mero de elementos del cl√∫ster `\(C_k\)`.


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# k = 3
fviz_dend(average_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-97-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: average

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
average_clust &lt;-
  hclust(d, method = "average")
groups &lt;- cutree(average_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (average)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-99-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: centroid

.pull-left[

* **Distancia entre centroides** (centroid): la distancia entre dos cl√∫steres ser√° definida como la distancia entre los centroides de cada grupo.

`$$d(C_k, C_l) = d(\overline{x}_k, \overline{x}_l)$$`

donde `\(\overline{x}_k = \frac{\sum_{x_k \in C_k} x_{k}}{n_k}\)`



```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")

# k = 3
fviz_dend(centroid_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (centroid)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-101-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: centroid

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")
groups &lt;- cutree(centroid_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (centroid)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-103-1.png" width="100%" /&gt;

]


---

# Algoritmos jer√°rquicos: Ward

.pull-left[


* **M√©todo de Ward** (m√≠nima varianza): de todas las posibles aglomeraciones, selecciona aquella que **minimiza la variabilidad interna**


`$$W = \sum_{k=1}^{G} W_k, \quad W_k = \sum_{\boldsymbol{X_i} \in C_k} \sum_{j=1}^{p} \left(x_{i,j} - \overline{x}_{j}^{k} \right)$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-√©sima del centroide `\(k\)`.


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# k = 3
fviz_dend(ward_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-105-1.png" width="100%" /&gt;

]

---

# Algoritmos jer√°rquicos: Ward

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (Ward)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-107-1.png" width="100%" /&gt;

]

---

# Ejemplo de jer√°rquico divisivo

.pull-left[

El paquete `{cluster}` nos permite implementar el **algoritmo de clustering jer√°rquico divisivo** m√°s famoso, **DIANA (DIvisive ANAlysis Clustering)**. En cada iteraci√≥n se seleccionar√° el **cl√∫ster con mayor diametro** (la mayor de las diferencias entre dos de sus observaciones) y se identificar√° la observaci√≥n m√°s alejada (en promedio) del resto de observaciones, siendo esta observaci√≥n la que inicia el nuevo cl√∫ster. 



```r
library(cluster)
hc_diana &lt;- diana(x = d, diss = TRUE, stand = FALSE)

fviz_dend(hc_diana , k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (DIANA, divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-109-1.png" width="100%" /&gt;


]

---


name: no-jerarquicos
class: center, middle

# Algoritmos no jer√°rquicos

---

# Algoritmo k-means

Dentro de los no jer√°rquicos nos centraremos en el **algoritmo k-means** (o algoritmo de Lloyd), basado en encontrar los `\(k\)` mejores cl√∫sters, entiendo como mejor cl√∫ster aquel cuya **varianza interna sea lo m√°s peque√±a posible**

1. **Seleccionaremos `\(k\)` puntos iniciales** (tantos c√≥mo n√∫mero de cl√∫sters) aleatorios de nuestro espacio (no tienen porque ser observaciones)  que definiran los **centroides** de nuestros cl√∫sters `\(\left\lbrace C_1, C_2, \ldots, C_k \right\rbrace\)`

2. Asignaremos **cada observaci√≥n a su cl√∫ster m√°s cercano**, entendiendo como cl√∫ster m√°s cercano aquel cuyo centroide tiene m√°s cerca (diagrama de Voronoi)

3. Una vez formado el cl√∫ster, **recalcularemos los `\(k\)` centroides** (c√≥mo las coordenadas medias de las observaciones agrupadas en dichos cl√∫sters)

4. Se **repiten los pasos 2. y 3.** hasta que no haya ning√∫n cambio en los cl√∫ster, hasta que no hayan movido los centroides por encima de una tolerancia o hasta que se haya llegado a un n√∫mero m√°ximo de iteraciones

---

# Algoritmo k-means

En dicho algoritmo se deber√°n tomar dos decisiones:

* La m√©trica usada para medir la distancia entre los individuos (normalmente la Eucl√≠dea)

* **Selecci√≥n inicial de los `\(k\)` centroides**:
  - Seleccionar las `\(k\)` primeras observaciones
  - Seleccionar la primera observaci√≥n como primer centroide, y el centroide i-√©simo como aquella observaci√≥n cuya distancia a los `\(i-1\)` centroides previos sea tan grande como una distancia predefinida.
  - Seleccionar `\(k\)` observaciones aleatorias.
  - Seleccionar `\(k\)` observaciones en base a conocimiento experto.

---

# Algoritmo k-means con R


Vamos a generar un **conjunto aleatorio bidimensional**.


```r
centers &lt;- tibble(cluster = factor(1:3), num_points =  c(100, 150, 50),
                  x = c(5, 0, -3), y = c(-1, 1, -2))
centers
```

```
&gt; # A tibble: 3 √ó 4
&gt;   cluster num_points     x     y
&gt;   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
&gt; 1 1              100     5    -1
&gt; 2 2              150     0     1
&gt; 3 3               50    -3    -2
```

```r
set.seed(1234567)
labelled_points &lt;- centers %&gt;% mutate(x = map2(num_points, x, rnorm), y = map2(num_points, y, rnorm)) %&gt;% 
  select(-num_points) %&gt;%  unnest(cols = c(x, y))
labelled_points
```

```
&gt; # A tibble: 300 √ó 3
&gt;    cluster     x      y
&gt;    &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 1        5.16 -1.32 
&gt;  2 1        6.37 -0.642
&gt;  3 1        5.73 -0.975
&gt;  4 1        3.65  0.559
&gt;  5 1        4.99 -0.379
&gt;  6 1        5.32 -0.760
&gt;  7 1        3.22  0.148
&gt;  8 1        5.91 -2.79 
&gt;  9 1        4.08 -1.28 
&gt; 10 1        4.84 -1.63 
&gt; # ‚Ä¶ with 290 more rows
&gt; # ‚Ñπ Use `print(n = ...)` to see more rows
```

---

# Algoritmo k-means con R

.pull-left[


```r
ggplot(labelled_points,
       aes(x = x, y = y, color = cluster)) +
  geom_point(alpha = 0.5, size = 5) +
  labs(x = "Coordenada X",
       y = "Coordenada Y",
       title = "Datos simulados")
```
  
]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-112-1.png" width="100%" /&gt;
  
]

---

# Algoritmo k-means con R

Para realizar el clustering basta usar la funci√≥n `kmeans()`, indic√°ndole el **n√∫mero de cl√∫sters** y el **n√∫mero m√°ximo de iteraciones**


```r
kclust &lt;- kmeans(labelled_points %&gt;% select(-cluster),
                 centers = 3, iter.max = 50)
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 101, 149, 50
&gt; 
&gt; Cluster means:
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
&gt; [112] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt; [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1
&gt; [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
&gt; [223] 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3 3 3 3 3
&gt; [260] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 2
&gt; [297] 3 3 3 3
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 172.8228 280.8962 107.8477
&gt;  (between_SS / total_SS =  83.5 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[

Los grupos est√°n guardados en `kclust$cluster` y los centroides en `kclust$centers`


```r
kclust$centers
```

```
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
```


```r
fviz_cluster(list(data =
                    labelled_points %&gt;%
                    select(-cluster),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-116-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-117-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-118-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

Podemos tambi√©n implementar el k-means para nuestro conjunto conocido `iris`



```r
kclust &lt;- kmeans(iris %&gt;% select(-Species),
                 centers = 3, iter.max = 50)
kclust$centers
```

```
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
```

```r
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 50, 62, 38
&gt; 
&gt; Cluster means:
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt;  [75] 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 3 3 3
&gt; [112] 3 3 2 2 3 3 3 3 2 3 2 3 2 3 3 2 2 3 3 3 3 3 2 3 3 3 3 2 3 3 3 2 3 3 3 2 3
&gt; [149] 3 2
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 15.15100 39.82097 23.87947
&gt;  (between_SS / total_SS =  88.4 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[


```r
fviz_cluster(list(data =
                    iris %&gt;%
                    select(-Species),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

Recordatorio: de la 1 a la 50 son setosa, de la 51 a la 100 son versicolor, y de la 101 a la 151 virginica. 

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-121-1.png" width="100%" /&gt;

]


---

name: n-grupos
class: center, middle

# Determinaci√≥n del n√∫mero de grupos

---

# Determinaci√≥n del n√∫mero de grupos

Hasta ahora **hemos hecho ¬´trampas¬ª** ya que el **n√∫mero de cl√∫sters se lo hemos indicado a priori**, en un caso porque hemos simulado nosotros los datos, y en otro caso porque es un conjunto del que conocemos su etiqueta (aprendizaje supervisado).

Para decidir el **n√∫mero de cl√∫ster √≥ptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias m√©tricas** a nuestra disposici√≥n

* **Variabilidad total**

`$$T = \sum_{j=1}^{p} \sum_{i=1}^{n} \left(x_{ij} - \overline{x}_j \right)^2$$`

donde `\(\overline{x}_j  = \frac{\sum_{i=1}^{n} x_{ij}}{n}\)`


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinaci√≥n del n√∫mero de grupos


* **Variabilidad del cl√∫ster `\(C_k\)`**

`$$W_k = \sum_{j=1}^{p} \sum_{\boldsymbol{X}_i \in C_k} \left(x_{ij} - \overline{x}_{j}^{k} \right)^2$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-√©sima del centroide `\(k\)`.


```r
kclust$withinss
```

```
&gt; [1] 15.15100 39.82097 23.87947
```

* **Variabilidad total intra-cl√∫steres**

`$$W = \sum_{k=1}^{K} W_k$$`


```r
kclust$tot.withinss
```

```
&gt; [1] 78.85144
```

---

# Determinaci√≥n del n√∫mero de grupos


Para decidir el **n√∫mero de cl√∫ster √≥ptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias m√©tricas** a nuestra disposici√≥n


* **Variabilidad total entre-cl√∫steres**

`$$E = \sum_{k=1}^{K} \sum_{j=1}^{p} \left( \overline{x}_{j}^{k} - \overline{x}_j  \right)^2$$`

tal que `\(T = W + E\)`


```r
kclust$betweenss
```

```
&gt; [1] 602.5192
```


```r
kclust$betweenss + kclust$tot.withinss
```

```
&gt; [1] 681.3706
```


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

Para decidir el **n√∫mero √≥ptimo** se usan principalmente dos m√©todos:

* Basado en la **variabilidad total intra-cl√∫steres (W)**:



```r
fviz_nbclust(iris_scale, kmeans,
             method = "wss") +
  geom_vline(xintercept = 3,
             linetype = 2) +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad total intra-cl√∫steres")
```

Con el **¬´m√©todo del codo¬ª (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el n√∫mero de cl√∫sters.

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-129-1.png" width="100%" /&gt;


]

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

As√≠ ser√≠a para el conjunto de datos simulados

&lt;img src="index_files/figure-html/unnamed-chunk-130-1.png" width="100%" /&gt;

]

.pull-right[


```r
fviz_nbclust(labelled_points %&gt;% select(-cluster),
             kmeans, method = "wss") +
  geom_vline(xintercept = 3, linetype = 2) +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad total intra-cl√∫steres")
```

Con el **¬´m√©todo del codo¬ª (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el n√∫mero de cl√∫sters.

]

---

# Determinaci√≥n del n√∫mero de grupos

.pull-left[

Para decidir el **n√∫mero √≥ptimo** se usan principalmente dos m√©todos:

* Basado en la **compacidad** (√≠ndice silhouette)

`$$S= \frac{\sum_{i=1}^{n} S(i)}{n}, \quad S(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$`

donde `\(a(i)\)` representa las **distancia media de la observaci√≥n i-√©sima** a las observaciones de su cl√∫ster, y y `\(b(i)\)` respecto a la de otros cl√∫sters.


```r
fviz_nbclust(iris_scale, kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Silhouette media",
       title = "N√∫mero √≥ptimo basado en silhouette")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-133-1.png" width="100%" /&gt;

]

---

# Determinaci√≥n del n√∫mero de grupos

La funci√≥n `silhouette()` del paquete `{cluster}` nos permite calcular dicho √≠ndice para la agrupaci√≥n realizada (m√°s adelante veremos como visualizarlo)


```r
kclust &lt;- kmeans(iris_scale,
                 centers = 3, iter.max = 50)
d &lt;- dist(iris_scale, method = "euclidean")
sil &lt;- silhouette(kclust$cluster, d)
sil
```

```
&gt;        cluster neighbor   sil_width
&gt;   [1,]       1        2  0.73419485
&gt;   [2,]       1        2  0.56827391
&gt;   [3,]       1        2  0.67754724
&gt;   [4,]       1        2  0.62050159
&gt;   [5,]       1        2  0.72847412
&gt;   [6,]       1        2  0.60988485
&gt;   [7,]       1        2  0.69838355
&gt;   [8,]       1        2  0.73081691
&gt;   [9,]       1        2  0.48821004
&gt;  [10,]       1        2  0.63154089
&gt;  [11,]       1        2  0.67418286
&gt;  [12,]       1        2  0.72179392
&gt;  [13,]       1        2  0.57847213
&gt;  [14,]       1        2  0.54944562
&gt;  [15,]       1        2  0.55294537
&gt;  [16,]       1        2  0.45806886
&gt;  [17,]       1        2  0.62112236
&gt;  [18,]       1        2  0.72875221
&gt;  [19,]       1        2  0.58590385
&gt;  [20,]       1        2  0.67746392
&gt;  [21,]       1        2  0.66042913
&gt;  [22,]       1        2  0.69021224
&gt;  [23,]       1        2  0.69653476
&gt;  [24,]       1        2  0.63737612
&gt;  [25,]       1        2  0.70132024
&gt;  [26,]       1        2  0.54494792
&gt;  [27,]       1        2  0.70471457
&gt;  [28,]       1        2  0.72151031
&gt;  [29,]       1        2  0.71451919
&gt;  [30,]       1        2  0.66776336
&gt;  [31,]       1        2  0.62562482
&gt;  [32,]       1        2  0.64783099
&gt;  [33,]       1        2  0.58967022
&gt;  [34,]       1        2  0.54088124
&gt;  [35,]       1        2  0.62843507
&gt;  [36,]       1        2  0.67614681
&gt;  [37,]       1        2  0.66543365
&gt;  [38,]       1        2  0.72441906
&gt;  [39,]       1        2  0.55262190
&gt;  [40,]       1        2  0.72470474
&gt;  [41,]       1        2  0.73333453
&gt;  [42,]       1        2  0.07766666
&gt;  [43,]       1        2  0.63725809
&gt;  [44,]       1        2  0.66371521
&gt;  [45,]       1        2  0.64863547
&gt;  [46,]       1        2  0.55934650
&gt;  [47,]       1        2  0.67881722
&gt;  [48,]       1        2  0.66606206
&gt;  [49,]       1        2  0.68912398
&gt;  [50,]       1        2  0.71077363
&gt;  [51,]       3        2  0.34169992
&gt;  [52,]       3        2  0.16627565
&gt;  [53,]       3        2  0.35854546
&gt;  [54,]       2        3  0.54373992
&gt;  [55,]       2        3  0.13270610
&gt;  [56,]       2        3  0.53878741
&gt;  [57,]       3        2  0.23206569
&gt;  [58,]       2        1  0.40978046
&gt;  [59,]       2        3  0.03768897
&gt;  [60,]       2        3  0.54390267
&gt;  [61,]       2        1  0.42467141
&gt;  [62,]       2        3  0.34088756
&gt;  [63,]       2        3  0.46946550
&gt;  [64,]       2        3  0.33187646
&gt;  [65,]       2        3  0.49517920
&gt;  [66,]       3        2  0.18906699
&gt;  [67,]       2        3  0.39249659
&gt;  [68,]       2        3  0.54918014
&gt;  [69,]       2        3  0.40350566
&gt;  [70,]       2        3  0.58259179
&gt;  [71,]       3        2  0.03645185
&gt;  [72,]       2        3  0.45853055
&gt;  [73,]       2        3  0.36638600
&gt;  [74,]       2        3  0.42610282
&gt;  [75,]       2        3  0.21912232
&gt;  [76,]       3        2  0.05112346
&gt;  [77,]       3        2  0.04063911
&gt;  [78,]       3        2  0.34222491
&gt;  [79,]       2        3  0.37447730
&gt;  [80,]       2        3  0.55591003
&gt;  [81,]       2        3  0.56667628
&gt;  [82,]       2        3  0.55697725
&gt;  [83,]       2        3  0.56859072
&gt;  [84,]       2        3  0.39023598
&gt;  [85,]       2        3  0.40497788
&gt;  [86,]       3        2  0.10973108
&gt;  [87,]       3        2  0.27953553
&gt;  [88,]       2        3  0.41829609
&gt;  [89,]       2        3  0.44045285
&gt;  [90,]       2        3  0.58629734
&gt;  [91,]       2        3  0.58416837
&gt;  [92,]       2        3  0.24125752
&gt;  [93,]       2        3  0.58008127
&gt;  [94,]       2        1  0.43896605
&gt;  [95,]       2        3  0.58397553
&gt;  [96,]       2        3  0.43067583
&gt;  [97,]       2        3  0.50035119
&gt;  [98,]       2        3  0.33948876
&gt;  [99,]       2        1  0.43311107
&gt; [100,]       2        3  0.55292391
&gt; [101,]       3        2  0.42463909
&gt; [102,]       2        3  0.34345454
&gt; [103,]       3        2  0.52207700
&gt; [104,]       3        2  0.15132973
&gt; [105,]       3        2  0.43894193
&gt; [106,]       3        2  0.47218801
&gt; [107,]       2        3  0.47007943
&gt; [108,]       3        2  0.44360797
&gt; [109,]       3        2  0.01675919
&gt; [110,]       3        2  0.46637587
&gt; [111,]       3        2  0.44615652
&gt; [112,]       3        2 -0.01058434
&gt; [113,]       3        2  0.50147349
&gt; [114,]       2        3  0.37966719
&gt; [115,]       2        3  0.05778708
&gt; [116,]       3        2  0.44552087
&gt; [117,]       3        2  0.35179075
&gt; [118,]       3        2  0.41131991
&gt; [119,]       3        2  0.33087257
&gt; [120,]       2        3  0.41625797
&gt; [121,]       3        2  0.54976242
&gt; [122,]       2        3  0.31780905
&gt; [123,]       3        2  0.40083606
&gt; [124,]       2        3  0.17744927
&gt; [125,]       3        2  0.52568825
&gt; [126,]       3        2  0.51433621
&gt; [127,]       2        3  0.17430033
&gt; [128,]       3        2 -0.02489394
&gt; [129,]       3        2  0.22253544
&gt; [130,]       3        2  0.43638496
&gt; [131,]       3        2  0.41286324
&gt; [132,]       3        2  0.39874279
&gt; [133,]       3        2  0.24284231
&gt; [134,]       2        3  0.19544119
&gt; [135,]       2        3  0.34505079
&gt; [136,]       3        2  0.46884592
&gt; [137,]       3        2  0.42243015
&gt; [138,]       3        2  0.36093602
&gt; [139,]       2        3  0.08594176
&gt; [140,]       3        2  0.53818328
&gt; [141,]       3        2  0.50861824
&gt; [142,]       3        2  0.51142970
&gt; [143,]       2        3  0.34345454
&gt; [144,]       3        2  0.54298088
&gt; [145,]       3        2  0.50444897
&gt; [146,]       3        2  0.46228025
&gt; [147,]       2        3  0.22992489
&gt; [148,]       3        2  0.38121152
&gt; [149,]       3        2  0.38714414
&gt; [150,]       2        3  0.09788140
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

---

# Poniendo en pr√°ctica: clustering de pa√≠ses

Para poner en pr√°ctica lo aprendido vamos a analizar los **datos de esperanza de vida de distintos pa√≠ses**, en hombres y mujeres, a distintas edades, que tenemos en el archivo `EsperanzaVida.xlsx`


```r
library(readxl)
esperanza &lt;-
  read_xlsx(path = "./DATOS/EsperanzaVida.xlsx")
glimpse(esperanza)
```

```
&gt; Rows: 26
&gt; Columns: 9
&gt; $ PAIS &lt;chr&gt; "Algeria", "Cameroon", "Madagascar", "Mauritius", "Reunion", "Sey‚Ä¶
&gt; $ m0   &lt;dbl&gt; 63, 34, 38, 59, 56, 62, 65, 56, 69, 65, 64, 56, 60, 61, 49, 59, 6‚Ä¶
&gt; $ m25  &lt;dbl&gt; 51, 29, 30, 42, 38, 44, 44, 46, 47, 48, 50, 44, 44, 45, 40, 42, 4‚Ä¶
&gt; $ m50  &lt;dbl&gt; 30, 13, 17, 20, 18, 24, 22, 24, 24, 26, 28, 25, 22, 22, 22, 22, 2‚Ä¶
&gt; $ m75  &lt;dbl&gt; 13, 5, 7, 6, 7, 7, 7, 11, 8, 9, 11, 10, 6, 8, 9, 6, 8, 8, 14, 9, ‚Ä¶
&gt; $ w0   &lt;dbl&gt; 67, 38, 38, 64, 62, 69, 72, 63, 75, 68, 66, 61, 65, 65, 51, 61, 6‚Ä¶
&gt; $ w25  &lt;dbl&gt; 54, 32, 34, 46, 46, 50, 50, 54, 53, 50, 51, 48, 45, 49, 41, 43, 4‚Ä¶
&gt; $ w50  &lt;dbl&gt; 34, 17, 20, 25, 25, 28, 27, 33, 29, 27, 29, 27, 25, 27, 23, 22, 2‚Ä¶
&gt; $ w75  &lt;dbl&gt; 15, 6, 7, 8, 10, 14, 9, 19, 10, 10, 11, 12, 9, 10, 8, 7, 9, 8, 13‚Ä¶
```

---

# Clustering de pa√≠ses

### Visualizaci√≥n previa


.pull-left[

La funci√≥n `heatmaply()` del paquete hom√≥nimo qos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
# Convertimos a data.frame para
# tener row.names y eliminamos PAIS
esperanza_df &lt;-
  as.data.frame(esperanza) %&gt;%
  select(-PAIS)
row.names(esperanza_df) &lt;- esperanza %&gt;% pull(PAIS)

library(heatmaply)
heatmaply(esperanza_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_1.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]


---

# Clustering de pa√≠ses

### Visualizaci√≥n previa

.pull-left[

Dicha representaci√≥n puede ser mejorada estandarizando los datos


```r
# Estandarizamos
esperanza_scale_df &lt;-
  esperanza_df %&gt;%
  mutate(across(where(is.numeric),
                ~scale(.)))

heatmaply(esperanza_scale_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_2.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Clustering de pa√≠ses

### Matriz de distancias

.pull-left[

Con los datos estandarizados podemos visualizar su matriz de distancias


```r
# matriz de distancias
d &lt;- dist(esperanza_scale_df,
          method = "euclidean")

# Visualizamos
fviz_dist(d, show_labels = TRUE)
```

Podemos ya atisbar cuatro grupos de pa√≠ses: Madasgar-Camer√∫n, Nicaragua-Algeria-Tunez, Groenlandia-...-Guatemala, y los dem√°s.

]
.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-143-1.png" width="95%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (single)

.pull-left[


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # a√±ade rect√°ngulo
          rect = TRUE) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-145-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (complete)

.pull-left[


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# Dendograma
fviz_dend(complete_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # A√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-147-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (average)

.pull-left[


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# Dendograma
fviz_dend(average_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-149-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Clustering (centroid)

.pull-left[


```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")

# Dendograma
fviz_dend(centroid_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (centroid)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-151-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering (Ward)

.pull-left[


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# Dendograma
fviz_dend(ward_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-153-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Clustering divisivo

.pull-left[


```r
# Clustering divisivo
hc_diana &lt;-
  diana(x = d, diss = TRUE,
        stand = FALSE)

# Dendograma
fviz_dend(hc_diana, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #a√±ade un rect√°ngulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-155-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Clustering no jer√°rquico

.pull-left[


```r
# Clustering k-means
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4,
                 iter.max = 50)
kclust$totss

# Clustering
fviz_cluster(list(data =
                    esperanza_scale_df,
                  cluster =
                    kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB",
                 "#E7B800", "#FC4E07"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-157-1.png" width="100%" /&gt;

]

---


# Clustering de pa√≠ses

### Comparativa de clusterings


.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-158-1.png" width="100%" /&gt;

]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-159-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Comparativa de clusterings

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-160-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-161-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Comparativa de clusterings

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-162-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-163-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "wss") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en variabilidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-165-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "n¬∫ cl√∫steres (k)",
       y = "Variabilidad total intra-cl√∫steres (W)",
       title = "N√∫mero √≥ptimo basado en compacidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-167-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
sil
```

]

.pull-right[


```
&gt;       cluster neighbor   sil_width
&gt;  [1,]       2        3  0.41474025
&gt;  [2,]       4        1  0.71161564
&gt;  [3,]       4        1  0.64807433
&gt;  [4,]       1        3  0.42956603
&gt;  [5,]       1        3  0.30980004
&gt;  [6,]       3        1  0.35360131
&gt;  [7,]       3        1  0.22675528
&gt;  [8,]       2        3  0.19380903
&gt;  [9,]       3        1  0.44705360
&gt; [10,]       3        1  0.50410114
&gt; [11,]       2        3 -0.12873387
&gt; [12,]       3        1  0.33044631
&gt; [13,]       1        3  0.30745661
&gt; [14,]       3        1  0.27880518
&gt; [15,]       1        3  0.27557000
&gt; [16,]       1        3  0.45235498
&gt; [17,]       3        1  0.18609043
&gt; [18,]       1        3  0.04774938
&gt; [19,]       2        3  0.27794760
&gt; [20,]       3        1  0.48800548
&gt; [21,]       1        3  0.27118869
&gt; [22,]       3        1  0.44893332
&gt; [23,]       3        1  0.52424137
&gt; [24,]       3        1  0.38152994
&gt; [25,]       3        1  0.12458923
&gt; [26,]       3        2  0.32183229
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

]

---


# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualizaci√≥n
fviz_silhouette(sil, label = TRUE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "√çndice silhouette para k-means con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust=1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-171-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

.pull-left[



```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 4)
sil &lt;- silhouette(groups, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualizaci√≥n
fviz_silhouette(sil, label = TRUE,
                print.summary = FALSE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "√çndice silhouette para jer√°rquico Ward con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust = 1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-173-1.png" width="100%" /&gt;

]

---

# Clustering de pa√≠ses

### Elecci√≥n del n√∫mero de clusters

Podemos ejecutar varios clustering a la vez mapeando sobre el n√∫mero de clusters (por ejemplo, usando el k-medias)


```r
library(tidymodels)
kclusts &lt;- 
  tibble(k = 1:9) %&gt;%
  mutate(kclust =
           map(k, ~kmeans(esperanza_scale_df, .x)),
         tidied = map(kclust, tidy),
         glanced = map(kclust, glance),
         augmented = map(kclust, augment,
                         esperanza_scale_df)
         )
clusters &lt;- 
  kclusts %&gt;% unnest(cols = c(tidied))

assignments &lt;- 
  kclusts %&gt;% unnest(cols = c(augmented))

clusterings &lt;- 
  kclusts %&gt;% unnest(cols = c(glanced))
```

---

# Recursos y bibliograf√≠a

&amp;nbsp;

### **Leyenda de los recursos**

&amp;nbsp;

&amp;nbsp;


#### üìö **Art√≠culos o libros** cient√≠ficos que han sido sometidos a revisi√≥n por pares.

&amp;nbsp;

#### üîó **Recursos online** recomendados

&amp;nbsp;

#### üíª Recursos para la **programaci√≥n en R**

---

# Bibliograf√≠a general

üíª **Tidy Data Tutor**: para visualizar la mec√°nica interna de `{tidyverse}`. &lt;https://tidydatatutor.com/&gt;

üîó Web con recursos para la **introducci√≥n a la estad√≠stica y Machine Learning en R** &lt;https://artofstat.com/&gt;

üìö **¬´An Introduction to Multivariate Statistical Analysis¬ª**. Anderson (1958) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/introduction_mva_anderson_2003.pdf&gt;

üìö **¬´A New Measure of Rank Correlation¬ª**. Kendall (1938) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/correlation_kendall_1938.pdf&gt;

üìö **¬´The generalised product moment distribution in samples from a normal multivariate population¬ª**. Wishart (1928) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multivariate_normal_wishart_1928.pdf&gt;

üìö **¬´On lines and planes of closest fit to systems of points in space¬ª**. Pearson (1901) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/fit_pearson_1901.pdf&gt;


---

# Recursos dataviz

### Dataviz

üìö **¬´Gram√°tica de las gr√°ficas: pistas para mejorar las representaciones de datos¬ª**. Sevilla (2005) &lt;http://academica-e.unavarra.es/bitstream/handle/2454/15785/Gram%C3%A1tica.pdf&gt;

üìö **¬´Quantitative Graphics in Statistics: A Brief History¬ª**. Beniger and Robyn &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/graphics_beniger_robin_1978.pdf&gt;
 
 
üíª **¬´Analizando datos, visualizando informaci√≥n, contando historias¬ª** (curso de dataviz en R). √Ålvarez-Li√©bana y Valverde-Castilla (2022) &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;

---

# Bibliograf√≠a componentes principales

üíª **Componentes principales** en `{tidymodels}`. &lt;https://www.tmwr.org/dimensionality.html#beans&gt;


üìö **¬´Principal Component Analysis¬ª**. Jolliffe (2002) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/pca_jolliffe_2002.pdf&gt;

üìö **¬´Principal Component Analysis¬ª**. Herv√© and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

üìö **¬´Principal Component Analysis: a review and recent developments¬ª**. Jolliffe and Cadima (2016) &lt;https://royalsocietypublishing.org/doi/10.1098/rsta.2015.0202&gt;

üîó **¬´The Mathematics Behind Principal Component Analysis¬ª**. Dubey (2018).  &lt;https://towardsdatascience.com/the-mathematics-behind-principal-component-analysis-fff2d7f4b643&gt;


üîó **¬´A One-Stop Shop for Principal Component Analysis¬ª**. Brems (2017). &lt;https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&gt;

üìö **¬´On the number of principal components: a test of dimensionality based on measurements of similarity between matrices¬ª**. Dray (2008) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/numer_pca_dray_2008.pdf&gt;


---

# Bibliograf√≠a an√°lisis cl√∫ster

üìö **¬´Multiclass classification of dry beans using computer vision and machine learning techniques¬ª**. Koklu y Ozkan (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multiclass_classif_koklu_ozlan_2020.pdf&gt;

üíª **¬´Clustering y heatmaps: aprendizaje no supervisado¬ª**. Amat (2017). &lt;https://rpubs.com/Joaquin_AR/310338&gt;

üíª **¬´K-means clustering with tidy data principles¬ª** &lt;https://www.tidymodels.org/learn/statistics/k-means/&gt;

üîó **¬´ISLR tidymodels Labs¬ª** &lt;https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/unsupervised-learning.html#kmeans-clustering&gt;


üìö **¬´Algorithm AS 136: a K-Means Clustering Algorithm¬ª**. Hartigan y Wong (1979) &lt;http://www.jstor.org/stable/2346830&gt;

üîó **¬´Machine Learning for Social Scientists¬ª**. Cimentada (2020) &lt;https://cimentadaj.github.io/ml_socsci/unsupervised-methods.html&gt;

---

# Recursos y bibliograf√≠a

### Otras t√©cnicas de reducci√≥n de la dimensi√≥n

üîó Sobre **PCA y PLS**. Amat (2017). &lt;https://www.cienciadedatos.net/documentos/35_principal_component_analysis#Introducci%C3%B3n&gt;

üìö **¬´On the early history of the singular value decomposition¬ª**. Stewart (1993) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/svd_stewart_1993.pdf&gt;

üìö **¬´UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction¬ª**. McInnes, healy and Melville (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/umap_mcinnesetal_2020.pdf&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
