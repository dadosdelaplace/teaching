<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>TÉCNICAS DE ANÁLISIS MULTIVARIANTE</title>
    <meta charset="utf-8" />
    <meta name="author" content="Profesor: Javier Álvarez Liébana" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Click para copiar código","success":"Código copiado","error":"Ctrl+C para copiar"})</script>
    <script src="libs/freezeframe/freezeframe.min.js"></script>
    <script src="libs/xaringanExtra-freezeframe/freezeframe-init.js"></script>
    <script id="xaringanExtra-freezeframe-options" type="application/json">{"selector":"img[src$=\"gif\"]","trigger":"click","overlay":false,"responsive":true,"warnings":true}</script>
    <link href="libs/animate.css-xaringan/animate.fade.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/plotly-binding/plotly.js"></script>
    <script src="libs/typedarray/typedarray.min.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# TÉCNICAS DE ANÁLISIS MULTIVARIANTE
## Máster propio (NTIC) en «Big Data y Business Analytics»
### Profesor: Javier Álvarez Liébana
### Facultad de Estudios Estadísticos (UCM)
### 22/04/2022 - 23/04/2022 (actualizado: 2022-04-22)

---





class: inverse center middle

# ATAJOS DE LAS DIAPOSITIVAS



`$$\\[2.7in]$$`

.left[Pulsa &lt;kbd-black&gt;O&lt;/kbd-black&gt; para ver el panel de diapositivas]
.left[Pulsa &lt;kbd-black&gt;H&lt;/kbd-black&gt; para ver otros atajos]

---


# Material de las clases


.pull-left[

- **Diapositivas** del curso:
&lt;https://dadosdelaplace.github.io/teaching/pca-clustering&gt;

- **Scripts** del curso:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/scripts&gt;

- **Evaluaciones**:
&lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/eval&gt;

- **Bibliografía**: &lt;https://github.com/dadosdelaplace/teaching/tree/main/bdba-pca-clustering-2022/biblio&gt;

- **Manual** de R: &lt;https://dadosdelaplace.github.io/courses-intro-R/&gt;

- **Curso de dataviz** en R: &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;


]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="83%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Me presento: la turra

.pull-left[

&lt;img src="./img/me.jpeg" width="80%" style="display: block; margin: auto auto auto 0;" /&gt;

]

.pull-right[

* **Javier Álvarez Liébana**, nacido en 1989 en Carabanchel Bajo (Madrid)

* Licenciado (UCM) en **Matemáticas** (Erasmus en Bologna mediante). **Máster (UCM) en Ingeniería Matemática** (2013-2014)

&amp;nbsp;

* **Doctorado en estadística** por la Universidad de Granada


* Encargado de la **visualización y análisis de datos covid** de la Consejería de Salud del **Principado de Asturias**

]

&amp;nbsp;

Intentando la **divulgación** por `Twitter (@dadosdelaplace)` e `Instagram (@javieralvarezliebana)`. Tengo una newsletter: &lt;https://cartasdelaplace.substack.com/&gt;

---

# Objetivos


.pull-left[

El propósito de estas clases será el tratamiento de **datos multidimensionales**, con tres objetivos principales:

- **Reducción de la dimensión**: ¿todas las variables aportan información? ¿Todas son necesarias? ¿Podemos transformar las variables para mantener la información de los datos pero reducir la dimensionalidad de los mismos?

- **Visualización**: ¿cuántas dimensiones podemos incluir en un gráfico 2D? ¿Cómo visualizar datos multidimensionales?

- **Encontrar patrones**: ¿cómo agrupar (clusterizar) los elementos en función de sus diferencias y similitudes?

]

.pull-right[

&lt;img src="./img/portada_master.jpg" width="120%" style="display: block; margin: auto auto auto 0;" /&gt;

]

&amp;nbsp;

📚 Estas **diapositivas** han sido elaboradas con el propio `R` haciendo uso del paquete `{xaringan}`
y `{xaringanExtra}`.


---


# Requisitos

Para el presente curso los únicos **requisitos** serán:

1. **Conexión a internet** (para la descarga de algunos datos y paquetes).

2. **Instalar R**: será nuestro **lenguaje**, nuestro **castellano** para poder «comunicarnos con el ordenador. La descarga la haremos (gratuitamente) desde &lt;https://cran.r-project.org/&gt;

3. **Instalar R Studio**. De la misma manera que podemos escribir castellano en un ordenador, en un Word, en un papel o en un tuit, podemos usar distintos IDE (entornos de desarrollo integrados, nuestro Office), para que el trabajo sea más cómodo. Nuestro **Word** para nosotros será **RStudio**.

.left[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/cran-R.jpg" alt = "cran-R" align = "left" width = "500" style = "margin-top: 5vh"&gt;
]

.right[
  &lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/R-studio.jpg" alt = "RStudio" align = "right" width = "500" style = "margin-top: 5vh;"&gt;
]


---

class: inverse center middle

# POR SI ACASO...¿POR QUÉ R Y NO EXCEL?


---

# R vs excel

![](./img/meme_barco.jpg)

---

# Incel vs excel

&lt;img src="./img/incel.jpg" width="85%" style="display: block; margin: auto;" /&gt;

---

# Datos: de la celda a la tabla

&lt;img src = "https://raw.githubusercontent.com/dadosdelaplace/slides-ECI-2022/main/img/celdas.jpg" alt = "celdas" align = "center" width = "850" style = "margin-top: 1vh;"&gt;


* **Celda**: un **dato individual** de un tipo concreto.
* **Variable**: **concatenación de datos** del mismo tipo.
* **Matriz**: **concatenación de variables** del **mismo tipo** y longitud.
* **Tabla**: **concatenación de variables** de **distinto tipo** pero igual longitud.

---

class: inverse center middle

# BLOQUE I. Selección de variables: PCA

&amp;nbsp;


### [¿Por qué es un paso importante en el análisis de datos multidimensional?](#intro-PCA)

### [Teoría: análisis de componentes principales](#teoria-PCA)

### [Práctica: PCA en R (visualización)](#practica-PCA)

---

name: intro-PCA
class: center, middle

# ¿Por qué es un paso importante en el análisis de datos multidimensional?

### **¿Qué es el análisis multivariante?**

---

# Breve historia de la estadística

.pull-left[

## Origen

* Del (neo)latín «statisticum collegium»: consejo de **Estado**.
* Del alemán «statistik» (ciencia del **Estado**, intoducido por G. Achenwall).


## Primeros usos: elaboración de censos

Los **primeros usos** documentados de la estadística fueron la elaboración de **censos** por parte de **mesopotámicos, chinos y egipcios**, con tres fines:

* Cobrar **impuestos** (un saludo, Willyrex).
* Reparto de **tierras** y optimización de su uso.
* **Reclutamiento de soldados**.

]

.pull-right[

## Estadística en la guerra

Según Tucídides, conceptos estadísticos como la **moda** datan del **siglo V a.C.**: para asaltar la muralla de la ciudad de Platea, ponían a contar a varios soldados el número de ladrillos vistos en la muralla, quedándose con el **conteo más repetido (la moda, el más frecuente)**, permitiendo el cálculo de la altura de la muralla.

&lt;img src="./img/peloponeso.jpg" width="70%" style="display: block; margin: auto;" /&gt;

]

---

# ¿Qué han hecho los romanos por nosotros?

.pull-left[

Precisamente por el tamaño de su Imperio, fueron los **romanos** quienes hicieron un uso más intenso de la estadística:

* **Censos** (elaborados por la censura, que elaboraba no solo el censo sino la supervisión de la moralidad pública).
* Primeras **tablas de natalidad/mortalidad**
* Primeros **catastros** (registros oficiales de propiedades, primeros impuestos)

&lt;img src="./img/catastro.jpg" width="60%" style="display: block; margin: auto;" /&gt;

]

.pull-right[

&lt;img src="https://www.publico.es/tremending/wp-content/uploads/2019/02/lifeofbrian3.jpg" width="95%" style="display: block; margin: auto auto auto 0;" /&gt;

]

---

# Breve historia de la estadística

.pull-left[

## **ÁRABES**

Autores de los **primeros tratados de estadística**, como el manuscrito de **Al-Kindi (801-873)**, que usó la distribución de **frecuencias de palabras** para el desarrollo de métodos de cifrado y descifrado de **mensajes encriptados**.

]

.pull-right[

## **MÉXICO**

Ya en el **año 1116, el rey Xólotl** implementó un **censo** que consistía en la **estimación de piedras**, tirando cada súbdito una a un montón (Nepohualco).
]


&amp;nbsp;

.pull-left[

## **INGLATERRA**

Desde el siglo XII se realiza la **Prueba del Pyx**, considerado uno de los **primeros controles de calidad**: se extre una de las monedas acuñadas y se deposita en una caja, para un año después comprobar su calidad y pureza.

]

.pull-right[

## **ITALIA**

En paralelo al **auge de los primeros «sistemas financieros» en Italia**, «La Nuova Crónica» de G. Villani fue considerado durante mucho tiempo el primer tratado de estadística (hasta el descubrimiento de los trabajos de Al-Kindi).

]

---

# Navegación y astronomía

Y es de aquella época medieval, en la que la navegación y la astronomía empezaban a tomar relevancia científica, cuando aparece la que se considera la primera gráfica (aunque no propiamente estadística) &lt;sup&gt;1&lt;/sup&gt;, representando el **movimiento cíclico de los planetas** (entre los siglos X y XI)

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/dataviz_historico_1.png" alt="Gráfica extraída de Beniger y Robyn (1978)" width="60%" /&gt;
&lt;p class="caption"&gt;Gráfica extraída de Beniger y Robyn (1978)&lt;/p&gt;
&lt;/div&gt;

[1] [📚 «Quantitative Graphics in Statistics: A Brief History» de James R. Beniger y Dorothy L. Robyn. The American Statistician (1978)](https://www.jstor.org/stable/2683467)

 
---

# Navegación y astronomía

Con una motivación similar, en torno a 1360 el matemático **Nicole Oresme** diseñó el **primer gráfico de barras**&lt;sup&gt;1&lt;/sup&gt; (no estadístico), con la idea de **visualizar a la vez dos magnitudes físicas teóricas** (pero...aún sin representar datos).


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/dataviz_historico_2.jpeg" alt="Gráfica extraída de Friendly y Valero-Mora (2010), de «Tractatus De Latitudinibus Formarum»" width="30%" /&gt;
&lt;p class="caption"&gt;Gráfica extraída de Friendly y Valero-Mora (2010), de «Tractatus De Latitudinibus Formarum»&lt;/p&gt;
&lt;/div&gt;

[1] [📚 «The First (Known) Statistical Graph: Michael Florent van Langren and the 'Secret' of Longitude» de M. Friendly y P. M. Valero-Mora. The American Statistician (2010)](https://www.researchgate.net/publication/227369016_The_First_Known_Statistical_Graph_Michael_Florent_van_Langren_and_the_Secret_of_Longitude)

 
---

# Primer gráfico estadístico

La mayoría de expertos, como Tufte &lt;sup&gt;1,2&lt;/sup&gt;, consideran **este gráfico** casi longitudinal como la **primera visualización de datos** de la historia, hecha por **van Langren** en 1644, representando la **distancia (en longitud) entre Toledo y Roma** (un poco mal medida ya que la distancia real es de 16.5º).

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/longitud_dataviz.jpg" alt="Gráfica original extraída de Friendly y Valero-Mora (2010)" width="45%" /&gt;
&lt;p class="caption"&gt;Gráfica original extraída de Friendly y Valero-Mora (2010)&lt;/p&gt;
&lt;/div&gt;

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/dataviz_historico_3.jpeg" alt="Adaptación extraída de Friendly y Valero-Mora (2010)" width="45%" /&gt;
&lt;p class="caption"&gt;Adaptación extraída de Friendly y Valero-Mora (2010)&lt;/p&gt;
&lt;/div&gt;

[1] [📚 «Visual explanations: images and quantities, evidence and narrative» de E. Tufte](https://archive.org/details/visualexplanatio00tuft)

[2] [📚 «PowerPoint is evil» de E. Tufte](https://www.wired.com/2003/09/ppt2/)

---


# Navegación y astronomía

.pull-left[

### T. Brahe

Uno de los primeros usos «modernos» de la estadística fue en la **navegación y la astronomía**, siendo Tycho Brahe de los primeros en utilizar la estadística para **reducir los errores** observacionales.
]

.pull-right[

### E. Wright

Fue el primero en usar en 1599 lo que hoy llamamos **mediana** en su libro «Certaine errors in navigation», aplicada a la navegación.

]

.pull-left[

### G. Galileo

Aunque la fama se la llevó **Gauss**, fue el primero en plantear una idea similar a la que hoy llamamos **método de mínimos cuadrados**: los valores más probables serían aquellos que minimizaran los errores.

]

.pull-right[
### C. F. Gauss y A. M. Legendre

El **método de los mínimos cuadrados**, en el que basan modelos actuales como la regresión, fue desarrollado por **Legendre y Gauss** (el último lo aplicó a la detección más probable del planeta enano Ceres).

]

---

# Demografía, epidemiología y fisiología

.pull-left[

### J. Graunt

Autor de «Natural and Political Observations Made upon the Bills of Mortality» (1662), uno de los primeros trabajos en los que ya se hablaba de **exceso de mortalidad** a partir de las primeras tablas de natalidad y mortalidad, **estimando la población de Londres**.
]

.pull-right[

### G. Neumann

Las **fakes news** ya existían en el siglo XVII: Gaspar Neumann también un precursor en el **análisis estadístico de tablas de mortalidad**, para desmentir bulos (ejemplo: desmontó la creencia de que en los años acabados en siete morían más personas).
]

&amp;nbsp;

Son precisamente las tablas de Graunt las que usó **Christiaan Huygens** (pionero en teoría de probabilidad con su «De ratiociniis in ludo aleae» en 1656) para generar la **primera gráfica de densidad** de una distribución continua, visualizando la **esperanza de vida** (en función de la edad).


---

# Primer gráfico de densidad


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://omeka.lehigh.edu/files/fullsize/65fc32c11a768f1d3263a99caca28dff.jpg" alt="Primera función de densidad, extraída de https://omeka.lehigh.edu/exhibits/show/data_visualization/vital_statistics/huygen" width="50%" /&gt;
&lt;p class="caption"&gt;Primera función de densidad, extraída de https://omeka.lehigh.edu/exhibits/show/data_visualization/vital_statistics/huygen&lt;/p&gt;
&lt;/div&gt;

---

# El gran boom: los gráficos de Playfair

La figura que cambió el dataviz fue, sin lugar a dudas, el economista y político **William Playfair (1759-1823)**. En 1786 publicó el **«Atlas político y comercial»**&lt;sup&gt;1,2&lt;/sup&gt; con 44 gráficas (43 series temporales y el **diagrama de barras más famoso**, aunque no el primero).

.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/playfair_1.jpg" alt="Gráficas de Playfair, extraídas de Funkhouser y Walker (1935)" width="85%" /&gt;
&lt;p class="caption"&gt;Gráficas de Playfair, extraídas de Funkhouser y Walker (1935)&lt;/p&gt;
&lt;/div&gt;

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/playfair_2.jpg" alt="Gráficas de Playfair, extraídas de Funkhouser y Walker (1935)" width="35%" /&gt;
&lt;p class="caption"&gt;Gráficas de Playfair, extraídas de Funkhouser y Walker (1935)&lt;/p&gt;
&lt;/div&gt;

]

[1] [📚 «Atlas político y comercial» de William Playfair (1786)](https://www.amazon.es/Playfairs-Commercial-Political-Statistical-Breviary/dp/0521855543)

[2] [📚 «Playfair and his charts» de H. Gray Funkhouser and  Helen M. Walker (1935)](https://www.jstor.org/stable/45366440)

---

# Primer gráfico de barras

Playfair es además el **autor del gráfico de barras más famoso** (aunque no fue el primero, pero sí el que sentó un precedente, quien lo hizo _mainstream_).

.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/playfair_5.jpg" alt="Gráficas de Playfair de importaciones (barras grises) y exportaciones (negras) de Escocia en 1781, extraídas de la wikipedia." width="95%" /&gt;
&lt;p class="caption"&gt;Gráficas de Playfair de importaciones (barras grises) y exportaciones (negras) de Escocia en 1781, extraídas de la wikipedia.&lt;/p&gt;
&lt;/div&gt;

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/playfair_6.jpg" alt="Primer diagrama de barras (Philippe Buache y Guillaume de L’Isle), visualizando los niveles del Sena desde 1732 hasta 1766, extraída de https://friendly.github.io/HistDataVis" width="95%" /&gt;
&lt;p class="caption"&gt;Primer diagrama de barras (Philippe Buache y Guillaume de L’Isle), visualizando los niveles del Sena desde 1732 hasta 1766, extraída de https://friendly.github.io/HistDataVis&lt;/p&gt;
&lt;/div&gt;

]


---


# Epidemiología y bioestadística

.pull-left[

### F. Galton

Primo de Charles Darwin, inventor de los **silbatos para perretes**, de los mapas de predicción meteorológica y la persona que acuñó el concepto de **regresión** (y el de eugenesia :/).

&lt;img src="https://www.bogleheads.org/w/images/thumb/9/95/Screen_Shot_2012-01-03_at_7.36.29_AM.png/600px-Screen_Shot_2012-01-03_at_7.36.29_AM.png" width="93%" style="display: block; margin: auto;" /&gt;


]

.pull-right[

&lt;img src="./img/galton_1.jpg" width="58%" style="display: block; margin: auto;" /&gt;

&lt;img src="./img/galton_2.png" width="58%" style="display: block; margin: auto;" /&gt;

]



---

# Epidemiología y bioestadística

.pull-left[

### John Snow

Se le considera uno de los pioneros de la **epidemiología moderna** y la **estadística espacial**: aunque los **diagramas de Voronoi** tardarían años en ser formalizados, John Snow aplicó el mismo concepto para mitigar la **epidemia de cólera en Londres**, con su **mapa con diagrama de barras**, localizando el foco en la conocida fuente de Broad Street.

]

.pull-right[

&lt;img src="https://media.revistagq.com/photos/5cc84a91c46d3a2b7435d7cf/2:3/w_1799,h_2699,c_limit/pelo%20jon%20snow.jpg" width="100%" style="display: block; margin: auto;" /&gt;

]

---

# El boom de la estadística: epidemiología y bioestadística


.pull-left[

#### John Snow

Se le considera uno de los pioneros de la **epidemiología moderna** y la **estadística espacial**: aunque los **diagramas de Voronoi** tardarían años en ser formalizados, John Snow aplicó el mismo concepto para mitigar la **epidemia de cólera en Londres**, con su **mapa con diagrama de barras**, localizando el foco en la conocida fuente de Broad Street&lt;sup&gt;1&lt;/sup&gt;.


[1] [📚 «El mapa fantasma», Steven Johnson, sobre la historia de John Snow](https://capitanswing.com/libros/el-mapa-fantasma/)


]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://s1.eestatic.com/2016/04/22/reportajes/reportajes_119248513_3987143_854x640.jpg" alt="John Snow, el epidemiólogo" width="100%" /&gt;
&lt;p class="caption"&gt;John Snow, el epidemiólogo&lt;/p&gt;
&lt;/div&gt;

]

---

# Primeros usos de la estadística espacial

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/snow_mapa.jpg" alt="Mapa de Londres, mostrando los casos de cólera del 19 de agosto al 30 de septiembre de 1854, extraído de https://friendly.github.io/HistDataVis." width="77%" /&gt;
&lt;p class="caption"&gt;Mapa de Londres, mostrando los casos de cólera del 19 de agosto al 30 de septiembre de 1854, extraído de https://friendly.github.io/HistDataVis.&lt;/p&gt;
&lt;/div&gt;

---

# ¿Qué es el análisis multidimensional?

Hasta la década de los 60, la mayoría de la estadística que se realizaba era

* **estadística unidimensional**: extraer información de una sola variable (rentas, impuestos, exportaciones, etc).

* **estadística bidimensional**: desde que Galton acuñó la regresión, los grandes estadísticos de principios de siglo se centraron en el **análisis bidimensional**, analizando la dependencia entre una variable `\(X\)` y otra variable `\(Y\)`, con herramientas como los **coeficientes de correlación** de Pearson, Spearman o Kendall&lt;sup&gt;1&lt;/sup&gt;


[1] [📚 Kendall, M. (1938). «A New Measure of Rank Correlation». Biometrika 30 (1–2): 81-89. doi:10.1093/biomet/30.1-2.81](https://doi.org/10.1093/biomet/30.1-2.81)

--

&amp;nbsp;

## Wishart, contigo empezó todo

En 1928, Wishart publicó su famoso artículo &lt;sup&gt;2&lt;/sup&gt; en el que, se demostraba y desarrollaba explícitamente la función de distribución de una 
**distribución normal multivariante**, trabajo más tarde extendido y formalizado por Fisher.

[2] [📚 Wishart, J. (1928). «The generalised product moment distribution in samples from a normal multivariate population». Biometrika. 20A (1–2): 32–52. doi:10.1093/biomet/20A.1-2.32](https://doi.org/10.1093/biomet/20A.1-2.32)


---
 
# ¿Qué es el análisis multidimensional?
 
Aunque el verdadero boom no llegó hasta la **década de los 60**, con la publicación del libro «An Introduction to Multivariate Statistical Analysis»&lt;sup&gt;1&lt;/sup&gt; de Anderson (1958), proporcionando todo un marco teórico con el que poder trabajar.

[1] [📚 Anderson, T.W. (1958). «An Introduction to Multivariate Analysis». New York: Wiley ISBN 0471026409](http://www.ru.ac.bd/stat/wp-content/uploads/sites/25/2019/03/301_03_Anderson_An-Introduction-to-Multivariate-Statistical-Analysis-2003.pdf)

--

&amp;nbsp;

## **Definición**

&gt; El Análisis Multivariante es la rama de la estadística que estudia las relaciones (CONJUNTAMENTE) entre conjuntos de variables dependientes y los individuos para los cuales se han medido dichas variables (Kendall)


## **Notación**

* `\(n\)` tamaño muestral (número de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estarán en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)

---

# Ejemplo de distribución bidimensional: normal bivariante

.pull-left[ 

Veamos un ejemplo sencillo con algo que seguramente nos sea familiar: la **distribución Normal o campana de Gauss** `\(X \sim \mathcal{N}\left(\mu, \sigma \right)\)`, cuya función de densidad es

`$$f(x) = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}}, \quad \mu \in\mathbb{R},~\sigma &gt;0$$`

&amp;nbsp;

La normal univariante depende de **dos parámetros**:

* **esperanza o media** `\(\mu = {\rm E} [X]\)` 
* **varianza** (unidimensional) `\(\sigma^2 := {\rm Var} [X] = {\rm E} [\left(X - \mu \right)^2] = {\rm E} [X^2] - \mu^2\)`


]


.pull-right[


```r
# Generamos muestra normal
rnorm(n = 10000, mean = 0, sd = 1)
```



&lt;img src="index_files/figure-html/unnamed-chunk-23-1.png" width="80%" /&gt;
  

]

---

# Normal bivariante

### **¿Y si medimos para cada individuo DOS variables?**

Si tenemos `\(\boldsymbol{X} = \left(X_1, X_2 \right)\)`, ¿qué estadísticos tenemos ahora a nuestra disposición?

* **Medidas marginales** (cada variable por separado):
  - medias `\(\mu_1:= {\rm E} [X_1]\)` y `\(\mu_2:= {\rm E} [X_2]\)`
  - varianzas `\(\sigma_{1}^{2}:=\sigma_{1, 1}^{2} = \sigma_{X_1, X_1}^2\)` y `\(\sigma_{2}^{2}:=\sigma_{2, 2}^{2} = \sigma_{X_2, X_2}^2\)`.

--

&amp;nbsp;

### **Covarianza**

La varianza `\({\rm Var} [X] := \sigma_{X}^2 = {\rm E} [ \left( X - \mu \right)^2 ]\)` es una medida de dispersión que nos **cuantifica** la relación de una variable consigo misma. ¿Y si en lugar de medir `\(X_1\)` vs `\(X_1\)` medimos `\(X_1\)` vs `\(X_2\)`?

Definiremos la **covarianza** como una especie de varianza en la que cambiamos una de las `\(X\)` por otra variable

`$$Cov (X_1, X_2) := \sigma_{1,2} =  {\rm E} [ \left( X_1 - \mu_1 \right) \left( X_2 - \mu_2 \right) ] = {\rm E}[X_1 * X_2] - \mu_1 * \mu_2 = \sigma_{2,1}$$`

---

# Normal bivariante

### **Matriz de covarianzas**

Desde un punto de vista teórico, dada una variable aleatoria bidimensional `\(\boldsymbol{X} = \left(X_1, X_2 \right)^{T}\)`, con vector de medias `\(\boldsymbol{\mu} = \left(\mu_1, \mu_2 \right)^{T}\)` definiremos la **matriz de varianzas y covarianzas** `\(\Sigma\)` de la siguiente manera:

`$$\boldsymbol{\Sigma} := \begin{pmatrix} \sigma_{1,1}^2 &amp; \sigma_{1,2} \\ \sigma_{2,1} &amp; \sigma_{2,2}^2 \end{pmatrix} = \begin{pmatrix} \sigma_{1}^2 &amp; \sigma_{1,2} \\ \sigma_{1,2} &amp; \sigma_{2}^2 \end{pmatrix}, \quad \left| \boldsymbol{\Sigma} \right| = \sigma_{1}^{2}  \sigma_{2}^{2} - \sigma_{1,2}^{2} &gt; 0$$`

--

Se puede expresar **matricialmente** como

`\(\begin{eqnarray}\boldsymbol{\Sigma} = {\rm E} \left[\left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T}\left(\boldsymbol{X} - \boldsymbol{\mu} \right) \right] &amp;=&amp; {\rm E} \left[\left( X_1  - \mu_1, X_2 - \mu_2 \right)^{T} \begin{pmatrix} X_1  - \mu_1 \\ X_2 - \mu_2 \end{pmatrix} \right] \\ &amp;=&amp; \begin{pmatrix} {\rm E} \left[ \left(X_1  - \mu_1 \right)^2 \right] &amp; {\rm E} \left[\left(X_1  - \mu_1 \right)\left(X_2  - \mu_2 \right) \right] \\ {\rm E} \left[\left(X_2  - \mu_2 \right)\left(X_1  - \mu_1 \right) \right] &amp; {\rm E} \left[\left(X_2  - \mu_2 \right)^2\right] \end{pmatrix} \end{eqnarray}\)`

**IMPORTANTE**: es una **matriz simétrica** (nos da igual medir `\(X\)` vs `\(Y\)`, que `\(Y\)` vs `\(X\)`).

---

# Normal multivariante

### **Normal univariante**

`$$X \sim \mathcal{N} \left(\mu, \sigma^2 \right), \quad \boldsymbol{\Sigma} = \sigma^2, \quad f(x) =  \frac{1}{\sigma {\sqrt{2\pi}}} e^{-{\frac{(x-\mu )^{2}}{2\sigma^{2}}}} = \frac{1}{\sigma {\sqrt{2\pi}}} e^{-\frac{1}{2} (x-\mu ) \boldsymbol{\Sigma}^{-1} (x-\mu )}$$`


### **Normal bivariante**

`$$\boldsymbol{X} = \left(X_1, X_2 \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, x_2) = \frac{1}{2\pi \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

--

### **Normal multivariante (caso general)** 

Multivariante de `\(p \ll n\)` variables

`$$\boldsymbol{X} = \left(X_1, \ldots, X_p \right)^{T}  \sim \mathcal{N} \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right), \quad f(x_1, \ldots, x_p) = \frac{1}{\left(2\pi \right)^{p/2} \left| \Sigma \right|^{1/2}} e^{-\frac{1}{2}{(\boldsymbol{x} - \mu )^{T} \boldsymbol{\Sigma}^{-1}(\boldsymbol{x} - \mu )}}$$`

`$$\boldsymbol{\Sigma} = \left(\Sigma_{i,j} \right)_{i,j=1,\ldots,p}, \quad \Sigma_{i,j}:= Cov (X_i, X_j ) = {\rm E}[(X_i-\mu_i) (X_j - \mu_j)]$$`

---

# Versión muestral

Lo anterior nos permite conocer la **formulación teórica (poblacional)**: ¿cómo calculamos la varianza y covarianza cuando tenemos una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` observaciones medidas?


`$$\boldsymbol{X} = \begin{pmatrix} x_{1, 1} &amp; \ldots &amp; x_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ x_{n, 1} &amp; \ldots &amp; x_{n, p} \end{pmatrix} \quad \text{muestra}$$`

#### **p = 2**

* **Varianzas muestrales**: `\(s_{x_1}^{2} := s_{1}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 1} - \overline{x}_1 \right)^2\)` y `\(s_{x_2}^{2} := s_{2}^2 = \frac{1}{n} \sum_{i=1}^n \left(x_{i, 2} - \overline{x}_2 \right)^2\)`, donde `\(\overline{x}_1\)` y `\(\overline{x}_2\)` son sus medias muestrales.

* **Covarianza muestral**: `\(s_{x_1, x_2}^{2} := s_{1, 2} = s_{2, 1}^2 = \frac{1}{n} \sum_{i=1}^n \sum_{j=1}^n \left(x_{i, 1} - \overline{x}_1 \right)\left(x_{j, 2} - \overline{x}_2 \right)\)`

--

#### **Estimadores insesgados**

Seguramente dichos valores los hallas visto divididos por `\(n-1\)` en lugar de `\(n\)`: los valores muestrales son estimadores de los valores poblacionales, y de aquí en adelante usaremos **estimadores insesgados**, estimadores `\(T\)` del valor población `\(U\)` tal que `\({\rm E}[T] = U\)`

* Estimador insesgado de `\(\mu_{x}\)`: `\(\overline{x}\)` tal que `\({\rm E}[\overline{x}] = \mu\)`

* Estimador insesgado de `\(\sigma_{x}^2\)`: la **cuasivarianza** `\(S_{x}^2 = \frac{n}{n-1} s_{x}^{2}\)` tal que `\({\rm E}[\sigma_{x}^2] = S_{x}^2\)`

* Estimador insesgado de `\(\sigma_{x, y}\)`: la **cuasicovarianza** `\(S_{x, y} = \frac{n}{n-1} s_{x, y}\)` tal que `\({\rm E}[\sigma_{x, y}] = S_{x, y}\)`

---

# Matriz de covarianzas (versión muestral)


En un **caso general**, dada una muestra `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables

`$$S_{x_{k}}^2 := S_{k}^2 = \frac{1}{n-1} \sum_{i=1}^{n} \left(x_{i, k} - \overline{x}_k \right)^2 \quad \text{(cuasi) var. muestrales (marginales)}$$`


`$$S_{x_{k}, x_{l}} := S_{k, l} = \frac{1}{n-1} \sum_{i=1}^{n} \sum_{j=1}^{n} \left(x_{i, k} - \overline{x}_k \right)\left(x_{j, l} - \overline{x}_l \right) \quad \text{(cuasi) covarianzas}$$`

Así, la **matriz de (cuasi) covarianzas empíricas** quedará como

`$$S := \frac{1}{n-1} \left(\boldsymbol{X} - \boldsymbol{\mu} \right)^{T} \left(\boldsymbol{X} - \boldsymbol{\mu} \right) =_{\boldsymbol{\mu} = 0} \frac{1}{n-1} \boldsymbol{X}^{T} \boldsymbol{X} = \begin{pmatrix} S_{1,1} &amp;  \ldots &amp; S_{1, p} \\ \vdots &amp; \ddots &amp; \vdots \\ S_{p,1} &amp; \ldots &amp; S_{p, p} \end{pmatrix}$$`

&amp;nbsp;

--

Las **covarianzas (y varianzas)** tienen un **«problema»**: **dependen de la magnitud** de los datos, proporcionando una medida que solo nos sirve para ser comparada con otra covariana, pero que **no nos proporciona una escala absoluta** para poder cuantificar.

---

# Matriz de correlaciones (versión muestral)


Para resolverlo, tenemos la **correlación (de Pearson)** 

`$$\rho_{k, l} := r_{k, l} = \frac{s_{k, l}}{\sqrt{s_{k}^2} \sqrt{s_{l}^2}} = \frac{S_{k, l}}{\sqrt{S_{k}^2} \sqrt{S_{l}^2}}$$`

tal que siempre `\(-1 \leq r_{k, l} \leq 1\)`.

&amp;nbsp;

--

De esta forma la **matriz de correlaciones** se puede expresar como

`$$R := \left(r_{k, l} \right)_{k,l=1,\ldots,p} = D^{-1/2} S D^{-1/2}, \quad D = diag(S) = \begin{pmatrix} S_{1,1}^2 &amp; \ldots &amp; 0 \\ \vdots  &amp; \ddots &amp; \vdots \\  0 &amp; \ldots &amp; S_{p, p}^2 \end{pmatrix}$$`


---


name: teoria-PCA
class: center, middle

# Teoría: análisis de componentes principales

---

# Objetivo: ¿reducir dimensión?

.pull-left[

El **objetivo «mainstream»** del **análisis de componentes principales** (PCA en inglés) suele ser el de **reducir la dimensión** de nuestros datos: pasar de un conjunto de `\(n\)` individuos y `\(p\)` variables a otro de `\(k &lt; p\)` variables (para los mismos `\(n\)` individuos).

&amp;nbsp;

Esta reducción de la dimensión se suele hacer con **3 objetivos** principalmente:

* **Mejora computacional** de los algoritmos al tener un dataset más reducido.

* **Permitir la visualización** en 2 o 3 dimensiones de conjuntos `\(n\)`-dimensionales.

* **«Reflotar» patrones** subyacentes en los datos.

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/959/1*kK4aMPHQ89ssFEus6RT4Yw.jpeg" alt="Extraída de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa" width="100%" /&gt;
&lt;p class="caption"&gt;Extraída de https://towardsdatascience.com/dimensionality-reduction-cheatsheet-15060fee3aa&lt;/p&gt;
&lt;/div&gt;

]

---


# Objetivo: ¿reducir dimensión?

.pull-left[

¿Entonces? ¿No tiene sentido aplicar componentes principales o técnicas de reducción de la dimensión en **datos bidimensionales**?

&amp;nbsp;

Empecemos por un sencillo ejemplo, visualizando la **longitud y anchura de pétalo** del famoso conjunto de datos `iris`

&amp;nbsp;

**¿Cuáles podrían ser los objetivos?** ¿Tiene sentido en este ejemplo aplicar **técnicas de reducción de la dimensión** como las componentes principales?

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-25-1.png" width="100%" /&gt;

]

---

# Objetivo: maximizar la información


&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" alt="Gráfica extraída de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c" width="80%" /&gt;
&lt;p class="caption"&gt;Gráfica extraída de https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&lt;/p&gt;
&lt;/div&gt;

Como veremos, el **objetivo real** será **maximizar la información obtenido al menor coste posible**, y eso hace que siga siendo útil, aunque no reduzcamos dimensiones, hacerlo en el caso bidimensional: una **clave** de las componentes principales es que las **componentes resultantes** serán **ortogonales** (perpendiculares), es decir, **linealmente independientes**.

&amp;nbsp;

Las **componentes principales** pueden ser una herramienta muy útil para atajar problemas de **colinealidad** (variables altamente correladas entre sí, interfiriendo entre ellas)


---


# Idea principal

La **idea subyacente** tras el cálculo de las componentes principales se puede resumir de forma **geométrica**: para un conjunto de puntos `\(p\)`-dimensionales, encontrar un **nuevo sistema de coordenadas** de dimensión `\(k \leq p\)` en el que expresar los datos, de forma que las **nuevas variables sean linealmente independientes**.

En el **caso bidimensional**, el resultado de aplicar componentes principales será una especie de «rotación» de los datos


&lt;img src="https://miro.medium.com/max/1400/1*V3JWBvxB92Uo116Bpxa3Tw.png" width="75%" style="display: block; margin: auto;" /&gt;

📚 **«Principal Component Analysis»**. Hervé and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;


---

# Idea principal: caso bidimensional


En el **caso bidimensional**, la idea será buscar esa **elipse** en torno a la cual tenemos los datos, de forma que la dirección que marca el **eje mayor** será la **primera componente** (la que tiene mayor rango --&gt; mayor varianza) y la dirección que marca el **eje menor** será la **segunda componente**.


.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_1.jpg" alt="Gráfica extraída de Hervé and Lynne (2010)" width="77%" /&gt;
&lt;p class="caption"&gt;Gráfica extraída de Hervé and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]


.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_words_23.jpg" alt="Gráfica extraída de Hervé and Lynne (2010)" width="58%" /&gt;
&lt;p class="caption"&gt;Gráfica extraída de Hervé and Lynne (2010)&lt;/p&gt;
&lt;/div&gt;

]

📚 **«Principal Component Analysis»**. Hervé and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

---

# Caso inicial bidimensional


.pull-left[

Vamos a empezar por un **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del pétalo.




```
&gt; # A tibble: 150 × 2
&gt;    Petal.Length Petal.Width
&gt;           &lt;dbl&gt;       &lt;dbl&gt;
&gt;  1          1.4         0.2
&gt;  2          1.4         0.2
&gt;  3          1.3         0.2
&gt;  4          1.5         0.2
&gt;  5          1.4         0.2
&gt;  6          1.7         0.4
&gt;  7          1.4         0.3
&gt;  8          1.5         0.2
&gt;  9          1.4         0.2
&gt; 10          1.5         0.1
&gt; # … with 140 more rows
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-32-1.png" width="100%" /&gt;

]

---

# Caso bidimensional

.pull-left[

1. Encontrar las **direcciónes de máxima varianza**. Dichas direcciones vendrán determinadas por **dos vectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2 \right\rbrace\)` perpendiculares entre sí y que serán **combinación lineal de las variables** originales.

`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`


]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_1.jpg" alt="Direcciones de máxima varianza" width="85%" /&gt;
&lt;p class="caption"&gt;Direcciones de máxima varianza&lt;/p&gt;
&lt;/div&gt;

]

---

# Caso bidimensional

.pull-left[


1. Encontrar las **direcciónes de máxima varianza**. Dichas direcciones vendrán determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre sí y que serán **combinación lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos será obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyección ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyección ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---


# Caso bidimensional

.pull-left[


1. Encontrar las **direcciónes de máxima varianza**. Dichas direcciones vendrán determinadas por **dos vectores** `\(\left\lbrace \Phi_1, \Phi_2 \right\rbrace\)` perpendiculares entre sí y que serán **combinación lineal de las variables** originales.
`$$\Phi_1 = z_{1, 1} * \boldsymbol{x}_1 + z_{2, 1} * \boldsymbol{x}_2, \quad \Phi_2 = z_{1, 2} * \boldsymbol{x}_1 + z_{2, 2} * \boldsymbol{x}_2$$`

2. Dado un registro `\(\boldsymbol{x}_i = \left(x_{i, 1}, x_{i, 2} \right)\)` (que puede entenderse como un vector `\(\overline{\boldsymbol{x}}_i := \boldsymbol{x}_i\)`), lo que haremos será obtener las **nuevas coordenadas** **proyectando ortogonalmente** el vector sobre las nuevas direcciones:
`$$x_{i, 1}' =\left| \boldsymbol{x}_i \right| cos (\alpha)  =  \frac{\langle \boldsymbol{x}_i, \Phi_1 \rangle}{ \left| \Phi_1 \right|}, \quad x_{i, 2}' =  \frac{\langle \boldsymbol{x}_i, \Phi_2 \rangle}{ \left| \Phi_2 \right|}$$`

3. Las **nuevas direcciones** las seleccionaremos  **ortonormales** (módulo unitario):
`$$x_{i, 1}'  =  \langle \boldsymbol{x}_i, \Phi_1 \rangle =  \left(x_{i, 1}, x_{i, 2} \right) \left(z_{1, 1}, z_{2, 1} \right)^{T} = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{1}^{T}, \quad x_{i, 2}' = \langle \boldsymbol{x}_i, \Phi_2 \rangle = \boldsymbol{x}_{i} \boldsymbol{\Phi}_{2}^{T}$$`

]

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="./img/pca_iris_2.jpg" alt="Proyección ortogonal" width="78%" /&gt;
&lt;p class="caption"&gt;Proyección ortogonal&lt;/p&gt;
&lt;/div&gt;

]

---

# Idea general


Nuestros datos originales `\(\boldsymbol{X}\)`  (dimensiones `\(n \times p\)`) serán reconvertidos en un conjunto `\(\boldsymbol{X}'\)` de dimensiones `\(n \times k\)`, con `\(k \leq p\)`, tal que 

`$$\boldsymbol{X}' = \boldsymbol{X} \boldsymbol{\Phi}^{T}$$`

--

tal que `\(\boldsymbol{\Phi}^{T}\)` es una matriz `\(p \times k\)` que contiene por columnas las `\(k\)` **direcciones principales**

`$$\boldsymbol{\Phi}^{T} = \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix}$$`

--

bajo la condición de que sean **direcciones ortonormales**

`$$\Phi \Phi^{T} = \begin{pmatrix} 1 &amp; \ldots &amp; 0 \\  \vdots &amp;  \ddots &amp; \vdots \\ 0  &amp; \ldots &amp; 1 \end{pmatrix}$$`

tal que dichas direcciones **maximicen la varianza**.

---

# Primera componente

Por ejemplo, para la **primera componente** el objetivo es encontrar, de entre todas las direcciones  `\(\boldsymbol{u}_1\)` posibles, la dirección `\(\boldsymbol{\Phi}_1\)` que **maximice la varianza de nuestros datos cuando los proyectamos sobre dicha dirección**

`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ z_{1,2} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ x_{2,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`


--

&amp;nbsp;

Dicha dirección por tanto saldrá de un proceso de **optimización**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

---

# Primera componente

Dicha dirección por tanto saldrá de un proceso de **optimización**

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{x}_{1}'  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)$$`

--

Si **centramos los datos** (restamos su media para tener media nula)


`$$\begin{eqnarray}\boldsymbol{\Phi}_1 &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} {\rm Var} \left( \boldsymbol{X}\boldsymbol{u}_{1}^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left({\rm E} \left[\left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right)^{T}\left( \boldsymbol{X} \boldsymbol{u}_{1}^{T} \right)\right] \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_{1} = 1} \left({\rm E} \left[ \boldsymbol{u}_{1} \boldsymbol{X}^{T} \boldsymbol{X} \boldsymbol{u}_1^{T} \right] \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 {\rm E} \left[\boldsymbol{X}^{T} \boldsymbol{X} \right] \boldsymbol{u}_{1}^{T}  \right) \\ &amp;=&amp; \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_{1}^{T}  \right)\end{eqnarray}$$`

--

Si **estandarizamos los datos** (restamos su media y dividimos entre su desviación típica, teniendo **datos con media cero y varianza unitaria** para que todos los datos ponderen por igual)

`$$\boldsymbol{\Phi}_1 = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} {\rm Var} \left( \boldsymbol{X} \boldsymbol{u}_1^{T} \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 S \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right)$$`

---

# Primera componente

Para **encontrar esa dirección `\(\boldsymbol{u}_1\)`** que nos maximiza la varianza de los proyectados en ella, sujeto a la restrcción de que `\(\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1\)`, se puede usar la técnica de los **multiplicadores de Lagrange** que nos dice que

`$$\boldsymbol{\Phi}_1 =  \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  \right) = \arg \max_{\boldsymbol{u}_{1}^{T} \boldsymbol{u}_1 = 1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right), \quad \lambda \in \mathbb{R}$$`

--

Eso es equivalente a encontrar el valor que nos **iguale la derivada a cero**

`$$\frac{\partial}{\partial \boldsymbol{u}_1} \left( \boldsymbol{u}_1 R \boldsymbol{u}_1^{T}  - \lambda \left(\boldsymbol{u}_1^{T} \boldsymbol{u}_1  - 1\right) \right) =   R \boldsymbol{u}_1  - \lambda \boldsymbol{u}_1^{T} = \left(R - \lambda \boldsymbol{Id}_{p} \right) \boldsymbol{u}_1^{T}  =  0$$`
--

Esto es lo mismo que decir que `\(R \boldsymbol{u}_1^{T}  = \lambda \boldsymbol{u}_1^{T}\)`, es decir, la dirección que buscamos `\(\boldsymbol{u}_{1}^{T}\)` es un **autovector de la matriz de covarianzas** (tras **estandarizar** los datos).

---

# Paréntesis: autovectores y autovalores

En álgebra matricial, dada una matriz `\(\boldsymbol{A}\)` cuadrada de tamaño `\(p \times p\)`, decimos que `\(v\)` es su **autovector** y `\(\lambda\)` su **autovalor asociado** si y solo sí

`$$A v= \lambda v, \quad v = \left(v_1, \ldots, v_p \right) \neq 0$$`

Esto es equivalente a decir que 

`$$A v - \lambda v = 0 \rightarrow (A - \lambda I_{p}) v = 0$$`

donde `\(I_p\)` es la matriz identidad de tamaño `\(p \times p\)`. Dicha ecuación tiene solución si y solo sí

`$$\left| A - \lambda I_{p} \right| = 0$$`

Además, por el **Teorema Fundamental del Algebra** sabemos que dicho determinante puede expresarse como un polinomio de grado `\(p\)` (conocido como **polinomio característico**)

`$$\left| A - \lambda I_{p} \right| = \left(\lambda_1 - \lambda \right)\left(\lambda_2 - \lambda \right) \ldots \left(\lambda_p - \lambda \right) = p (\lambda)$$`

Además el determinante `\(\left| A \right|\)` será el producto de todos sus autovalores.

---

# Primera componente

Recapitulando, para obtener la **primera componente** `\(\boldsymbol{\Phi}_1\)`, debemos de 

* **Estandarizar** nuestros datos
* Calcular la **matriz de (cuasi)covarianzas** `\(\boldsymbol{S}\)`
* Calcula sus **autovectores** tal que `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)` (normalizados a módulo 1).

--

Además si es un autovector de la matriz de covarianzas tenemos entonces que la **varianza maximizada**, la **proporción de información** que **explica dicha componente**, será

`$$\boldsymbol{\Phi}_{1} \left(  S \boldsymbol{\Phi}_{1}^{T} \right) = \boldsymbol{\Phi}_{1} \left( R \boldsymbol{\Phi}_{1}^{T} \right) =\boldsymbol{\Phi}_{1}\left(  \lambda_1 \boldsymbol{\Phi}_{1}^{T} \right) =  \lambda_1 \boldsymbol{\Phi}_{1} \boldsymbol{\Phi}_{1}^{T} =_{\text{ortonormales}} \lambda_1$$` 

--

Así que obtener la dirección (de todos los autovalores) que mayor información captura nos fijaremos en aquella que tenga **asociada el autovalor más grande**.


`$$\boldsymbol{x}_{1}' = \boldsymbol{X} \boldsymbol{\Phi}_{1}^{T} = \begin{pmatrix} x_{1,1} &amp; \ldots &amp; x_{1, p}  \\ \vdots  &amp; \ddots &amp; \vdots
\\ x_{n,1}  &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} \\ \vdots \\ z_{1,p} \end{pmatrix} =  \begin{pmatrix} x_{1,1}^{'} \\ \vdots \\ x_{n, 1}^{'} \end{pmatrix}$$`

donde `\(S \boldsymbol{\Phi}_{1}^{T} = \lambda_1 \boldsymbol{\Phi}_{1}^{T}\)`, siendo `\(\lambda_1\)` el mayor de los autovalores de la matriz de (cuasi)covarianzas `\(S\)`, y `\(\boldsymbol{\Phi}_{1}^{T}\)` su autovector asociado. El **resto de las componentes** se obtendrán de forma similar, siendo ortogonales a cada una de las direcciones obtenidas.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Dados unos datos `\(\boldsymbol{X}\)` de `\(n\)` individuos y `\(p\)` variables, el objetivo es encontrar nuevas **direcciones ortonormales** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)`, con `\(1 \leq k \leq p\)`, como combinación lineal de las variables originales.

* Los **datos son estandarizados**  tal que

`$$\begin{pmatrix} \frac{x_{1,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{1,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{1,p} - \overline{x}_p}{S_{p}} \\  \frac{x_{2,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{2,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{2,p} - \overline{x}_p}{S_{p}} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \frac{x_{n,1} - \overline{x}_1}{S_{1}} &amp; \frac{x_{n,2} - \overline{x}_2}{S_{2}} &amp; \ldots &amp; \frac{x_{n,p} - \overline{x}_p}{S_{p}} \end{pmatrix}$$`

* Calcular la **matriz `\(S\)` de (cuasi)covarianzas** de dichos datos estandarizados.

---

# Idea general paso a paso 

El proceso completo es el siguiente:

* Calculamos los `\(p\)` **autovectores** `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_p \right\rbrace\)`, y sus **autovalores asociados** `\(\left\lbrace \lambda_1, \ldots, \lambda_p \right\rbrace\)`, de la matriz `\(S\)`, tal que `\(S  \boldsymbol{\Phi}_k = \lambda_k  \boldsymbol{\Phi}_k\)`.

* Seleccionamos las primeras `\(k \leq p\)` componentes `\(\left\lbrace \boldsymbol{\Phi}_1, \ldots, \boldsymbol{\Phi}_k \right\rbrace\)` asociadas a los primeros `\(\left\lbrace \lambda_1, \ldots, \lambda_k \right\rbrace\)` autovalores.

* La **varianza (información) capturada** por la dirección `\(k\)`-ésima será igual a `\(\lambda_k\)`.

* Las nuevas coordenadas serán

`$$\boldsymbol{X}^{'} = \boldsymbol{X} \boldsymbol{\Phi}^{T} = \begin{pmatrix} x_{1,1} &amp; x_{1, 2} &amp; \ldots &amp; x_{1, p} \\ x_{2,1} &amp; x_{2, 1} &amp; \ldots &amp; x_{2, p} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots
\\ x_{n,1} &amp; x_{n, 2} &amp; \ldots &amp; x_{n, p}\end{pmatrix} \begin{pmatrix} z_{1,1} &amp; z_{2,1} &amp; \ldots &amp; z_{k,1} \\ z_{1,2} &amp; z_{2,2} &amp; \ldots &amp; z_{k,2}  \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ z_{1,p} &amp; z_{2,p} &amp; \ldots &amp; z_{k,p} \end{pmatrix} = \begin{pmatrix} \boldsymbol{x}_1 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_1 \boldsymbol{\Phi}_k^{T} \\ \boldsymbol{x}_2 \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_2 \boldsymbol{\Phi}_k^{T} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ \boldsymbol{x}_n \boldsymbol{\Phi}_1^{T} &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_2^{T} &amp; \ldots &amp; \boldsymbol{x}_n \boldsymbol{\Phi}_k^{T}\end{pmatrix}$$`

---

# Glosario 

* **Autovectores**: nos indican la **dirección de la componente**

* **Loadings**: serán los **coeficientes** de dichos autovectores (los que generan la combinación lineal de las variables originales) nos indican el **peso que tiene cada variable original en dicha componente**. Si por ejemplo `\(\boldsymbol{\Phi}_1 = \left(0.95, 0.15, 0.273 \right)\)`, significa que la primera componente (la que más varianza captura) será `\(0.95* \boldsymbol{X}_1 + 0.15 * \boldsymbol{X}_2 + 0.273 * \boldsymbol{X}_3\)`, estando dominada por la variable original `\(\boldsymbol{X}_1\)` (un peso de 0.95).


* **Signo de los loadings**: nos indica el **sentido de la relación entre la componente y la variable original** (correlación positiva/negativa). Si alguno de ellos fuese 0 significaría que la nueva componente está incorrelada respecto a dicha variable original.


* **Scores**: para cada observación `\(i\)`, las nuevas coordenadas `\(\left(x_{i, 1}^{'}, \ldots, x_{i, k}^{'} \right)\)`, calculadas tras **proyectar la observación original en las direcciones principales** `\(\boldsymbol{x}_{i} \boldsymbol{\Phi}^{T}\)`.


* **Truncamiento o número de componentes**: para seleccionar el número `\(k\)` de componentes a seleccionar el método más sencillo es **fijar de antemano** un **umbral varianza explicada** que queremos conservar (por ejemplo, `\(95%\)`), de forma que nos quedemos con el primer número `\(k\)` tal que `\(\sum_{j=1}^{k} \lambda_k &gt; 0.95\)` (**varianza explicada acumulada**, teniendo los autovalores ordenados de mayor a menor).


---


name: practica-PCA
class: center, middle

# Práctica: PCA en R

---

# PCA en R: caso «manual»


Volvemos a nuestro **ejemplo sencillo (bidimensional)** tomando de `{iris}` solo las variables del pétalo.


```r
iris_bi &lt;- 
  tibble(iris) %&gt;%
  select(contains("Petal"))
iris_bi
```

```
&gt; # A tibble: 150 × 2
&gt;    Petal.Length Petal.Width
&gt;           &lt;dbl&gt;       &lt;dbl&gt;
&gt;  1          1.4         0.2
&gt;  2          1.4         0.2
&gt;  3          1.3         0.2
&gt;  4          1.5         0.2
&gt;  5          1.4         0.2
&gt;  6          1.7         0.4
&gt;  7          1.4         0.3
&gt;  8          1.5         0.2
&gt;  9          1.4         0.2
&gt; 10          1.5         0.1
&gt; # … with 140 more rows
```

---

# PCA en R: caso «manual»


**Primer paso**: **estandarizar** los datos.


```r
iris_bi_std &lt;-
  iris_bi %&gt;%
  mutate(Petal.Length = (Petal.Length - mean(Petal.Length)) /  sd(Petal.Length),
         Petal.Width = (Petal.Width - mean(Petal.Width)) / sd(Petal.Width))

iris_bi_std
```

```
&gt; # A tibble: 150 × 2
&gt;    Petal.Length Petal.Width
&gt;           &lt;dbl&gt;       &lt;dbl&gt;
&gt;  1        -1.34       -1.31
&gt;  2        -1.34       -1.31
&gt;  3        -1.39       -1.31
&gt;  4        -1.28       -1.31
&gt;  5        -1.34       -1.31
&gt;  6        -1.17       -1.05
&gt;  7        -1.34       -1.18
&gt;  8        -1.28       -1.31
&gt;  9        -1.34       -1.31
&gt; 10        -1.28       -1.44
&gt; # … with 140 more rows
```

---

# PCA en R: caso «manual»

.pull-left[
&lt;img src="index_files/figure-html/unnamed-chunk-38-1.png" width="100%" /&gt;

]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-39-1.png" width="100%" /&gt;

]

---


# PCA en R: caso «manual»

**Segundo paso**: calcular la **matriz de covarianzas**


```r
cov_mat &lt;- cov(iris_bi_std)
cov_mat
```

```
&gt;              Petal.Length Petal.Width
&gt; Petal.Length    1.0000000   0.9628654
&gt; Petal.Width     0.9628654   1.0000000
```

Al estar estandarizados los datos, es equivalente a calcular la matriz de correlaciones


```r
library(corrr)
iris_bi_std %&gt;% correlate(diagonal = 1)
```

```
&gt; # A tibble: 2 × 3
&gt;   term         Petal.Length Petal.Width
&gt;   &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt;
&gt; 1 Petal.Length        1           0.963
&gt; 2 Petal.Width         0.963       1
```

---

# PCA en R: caso «manual»

**Tercer paso**: calcular los **autovalores y autovectores** de la matriz de covarianzas


```r
autoelementos &lt;- eigen(cov_mat)
autoelementos
```

```
&gt; eigen() decomposition
&gt; $values
&gt; [1] 1.96286543 0.03713457
&gt; 
&gt; $vectors
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

**IMPORTANTE** al tener las **variables estandarizadas**, la **suma de los autovalores** es `\(p\)` (ya que será la suma de las varianzas de las variables que tenemos).

---

# PCA en R: caso «manual»

**Cuarto paso**: **ordenar** autovectores segun autovalores (de mayor a menor)


```r
order_lambda &lt;-
  order(autoelementos$values, decreasing = TRUE)
lambda &lt;- autoelementos$values[order_lambda]
PC &lt;- autoelementos$vectors[, order_lambda]
lambda # autovalores ordenadores
```

```
&gt; [1] 1.96286543 0.03713457
```

La **varianza capturada** por `\(\boldsymbol{\Phi}_1\)` es `\(1.963\)` y `\(0.037\)` para la segunda componente `\(\boldsymbol{\Phi}_2\)`.


```r
PC # autovectores asociados --&gt; direcciones principales
```

```
&gt;           [,1]       [,2]
&gt; [1,] 0.7071068 -0.7071068
&gt; [2,] 0.7071068  0.7071068
```

---

# PCA en R: caso «manual»


**Quinto paso**: calcular la **varianza explicada acumulada** por cada componente (una vez ordenadas)


```r
cumsum(lambda) / sum(lambda)
```

```
&gt; [1] 0.9814327 1.0000000
```

La **primera componente captura el 98.14% de la información (de la varianza)** y la segunda el 1.86% restante.

---

# PCA en R: caso «manual»

* **Sexto paso**: proyectar en las nuevas componentes para obtener las **nuevas coordenadas** (¡respecto a la nueva base, a las nuevas componentes!)
 


```r
iris_pca &lt;- iris_bi_std * t(PC)
names(iris_pca) &lt;- c("PC_1", "PC_2")
iris_pca
```

```
&gt;            PC_1          PC_2
&gt; 1   -0.94451904 -0.9270538645
&gt; 2    0.94451904 -0.9270538645
&gt; 3   -0.98457498 -0.9270538645
&gt; 4   -0.90446310  0.9270538645
&gt; 5   -0.94451904 -0.9270538645
&gt; 6    0.82435122 -0.7415194019
&gt; 7   -0.94451904 -0.8342866332
&gt; 8   -0.90446310  0.9270538645
&gt; 9   -0.94451904 -0.9270538645
&gt; 10   0.90446310 -1.0198210958
&gt; 11  -0.90446310 -0.9270538645
&gt; 12  -0.86440716  0.9270538645
&gt; 13  -0.94451904 -1.0198210958
&gt; 14   1.06468686 -1.0198210958
&gt; 15  -1.02463092 -0.9270538645
&gt; 16  -0.90446310  0.7415194019
&gt; 17  -0.98457498 -0.7415194019
&gt; 18   0.94451904 -0.8342866332
&gt; 19  -0.82435122 -0.8342866332
&gt; 20  -0.90446310  0.8342866332
&gt; 21  -0.82435122 -0.9270538645
&gt; 22   0.90446310 -0.7415194019
&gt; 23  -1.10474279 -0.9270538645
&gt; 24  -0.82435122  0.6487521707
&gt; 25  -0.74423934 -0.9270538645
&gt; 26   0.86440716 -0.9270538645
&gt; 27  -0.86440716 -0.7415194019
&gt; 28  -0.90446310  0.9270538645
&gt; 29  -0.94451904 -0.9270538645
&gt; 30   0.86440716 -0.9270538645
&gt; 31  -0.86440716 -0.9270538645
&gt; 32  -0.90446310  0.7415194019
&gt; 33  -0.90446310 -1.0198210958
&gt; 34   0.94451904 -0.9270538645
&gt; 35  -0.90446310 -0.9270538645
&gt; 36  -1.02463092  0.9270538645
&gt; 37  -0.98457498 -0.9270538645
&gt; 38   0.94451904 -1.0198210958
&gt; 39  -0.98457498 -0.9270538645
&gt; 40  -0.90446310  0.9270538645
&gt; 41  -0.98457498 -0.8342866332
&gt; 42   0.98457498 -0.8342866332
&gt; 43  -0.98457498 -0.9270538645
&gt; 44  -0.86440716  0.5559849394
&gt; 45  -0.74423934 -0.7415194019
&gt; 46   0.94451904 -0.8342866332
&gt; 47  -0.86440716 -0.9270538645
&gt; 48  -0.94451904  0.9270538645
&gt; 49  -0.90446310 -0.9270538645
&gt; 50   0.94451904 -0.9270538645
&gt; 51   0.37732694  0.1861529107
&gt; 52   0.29721507 -0.2789201420
&gt; 53   0.45743882  0.2789201420
&gt; 54  -0.09693537  0.0933856795
&gt; 55   0.33727101  0.2789201420
&gt; 56   0.29721507 -0.0933856795
&gt; 57   0.37732694  0.3716873733
&gt; 58   0.18345620 -0.1849160143
&gt; 59   0.33727101  0.0933856795
&gt; 60   0.05687943 -0.1861529107
&gt; 61  -0.10334432 -0.1849160143
&gt; 62  -0.17704725  0.2789201420
&gt; 63   0.09693537 -0.1849160143
&gt; 64   0.37732694 -0.1861529107
&gt; 65  -0.06328838  0.0933856795
&gt; 66  -0.25715913  0.1861529107
&gt; 67   0.29721507  0.2789201420
&gt; 68   0.13699131  0.1849160143
&gt; 69   0.29721507  0.2789201420
&gt; 70  -0.05687943 -0.0921487831
&gt; 71   0.41738288  0.5572218358
&gt; 72   0.09693537 -0.0933856795
&gt; 73   0.45743882  0.2789201420
&gt; 74  -0.37732694  0.0006184482
&gt; 75   0.21710319  0.0933856795
&gt; 76   0.25715913 -0.1861529107
&gt; 77   0.41738288  0.1861529107
&gt; 78  -0.49749476  0.4644546046
&gt; 79   0.29721507  0.2789201420
&gt; 80  -0.10334432  0.1849160143
&gt; 81   0.01682349 -0.0921487831
&gt; 82   0.02323244 -0.1849160143
&gt; 83   0.05687943  0.0006184482
&gt; 84   0.53755070 -0.3716873733
&gt; 85   0.29721507  0.2789201420
&gt; 86  -0.29721507  0.3716873733
&gt; 87   0.37732694  0.2789201420
&gt; 88   0.25715913 -0.0933856795
&gt; 89   0.13699131  0.0933856795
&gt; 90  -0.09693537  0.0933856795
&gt; 91   0.25715913  0.0006184482
&gt; 92   0.33727101 -0.1861529107
&gt; 93   0.09693537  0.0006184482
&gt; 94   0.18345620 -0.1849160143
&gt; 95   0.17704725  0.0933856795
&gt; 96   0.17704725 -0.0006184482
&gt; 97   0.17704725  0.0933856795
&gt; 98  -0.21710319  0.0933856795
&gt; 99  -0.30362402 -0.0921487831
&gt; 100  0.13699131 -0.0933856795
&gt; 101  0.89805415  1.2065924547
&gt; 102 -0.53755070  0.6499890671
&gt; 103  0.85799821  0.8355235296
&gt; 104  0.73783039 -0.5572218358
&gt; 105  0.81794227  0.9282907609
&gt; 106 -1.13838978  0.8355235296
&gt; 107  0.29721507  0.4644546046
&gt; 108  1.01822197 -0.5572218358
&gt; 109  0.81794227  0.5572218358
&gt; 110 -0.93811009  1.2065924547
&gt; 111  0.53755070  0.7427562984
&gt; 112  0.61766258 -0.6499890671
&gt; 113  0.69777446  0.8355235296
&gt; 114 -0.49749476  0.7427562984
&gt; 115  0.53755070  1.1138252234
&gt; 116  0.61766258 -1.0210579922
&gt; 117  0.69777446  0.5572218358
&gt; 118 -1.17844572  0.9282907609
&gt; 119  1.25855760  1.0210579922
&gt; 120  0.49749476 -0.2789201420
&gt; 121  0.77788633  1.0210579922
&gt; 122 -0.45743882  0.7427562984
&gt; 123  1.17844572  0.7427562984
&gt; 124  0.45743882 -0.5572218358
&gt; 125  0.77788633  0.8355235296
&gt; 126 -0.89805415  0.5572218358
&gt; 127  0.41738288  0.5572218358
&gt; 128  0.45743882 -0.5572218358
&gt; 129  0.73783039  0.8355235296
&gt; 130 -0.81794227  0.3716873733
&gt; 131  0.93811009  0.6499890671
&gt; 132  1.05827790 -0.7427562984
&gt; 133  0.73783039  0.9282907609
&gt; 134 -0.53755070  0.2789201420
&gt; 135  0.73783039  0.1861529107
&gt; 136  0.93811009 -1.0210579922
&gt; 137  0.73783039  1.1138252234
&gt; 138 -0.69777446  0.5572218358
&gt; 139  0.41738288  0.5572218358
&gt; 140  0.65771852 -0.8355235296
&gt; 141  0.73783039  1.1138252234
&gt; 142 -0.53755070  1.0210579922
&gt; 143  0.53755070  0.6499890671
&gt; 144  0.85799821 -1.0210579922
&gt; 145  0.77788633  1.2065924547
&gt; 146 -0.57760664  1.0210579922
&gt; 147  0.49749476  0.6499890671
&gt; 148  0.57760664 -0.7427562984
&gt; 149  0.65771852  1.0210579922
&gt; 150 -0.53755070  0.5572218358
```

---

# PCA en R: con prcomp

Dentro de los paquete básicos cargados por `R` tenemos `prcomp` que nos permite realizar los cálculos anteriores de manera automática (`scale. = TRUE` debe ser indicado si los han datos no entran estandarizados previamente).


```r
pca &lt;- prcomp(iris_bi, scale. = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

* **Rotation**: la matriz cuyas columnas son las componentes principales `\(\boldsymbol{\Phi}_1, \boldsymbol{\Phi}_2\)` (recuerda que dijimos que estábamos «rotando» los datos).

* **Standard deviations**: dado que cada `\(\lambda_j = {\rm Var} \left(\boldsymbol{\Phi}_j \right)\)` representa la varianza de las componentes principales, lo que nos proporciona la salida es `\(\sqrt{\lambda_j}\)`, para cada `\(j=1,\ldots,p\)`


```r
pca$sdev^2 # autovalores
```

```
&gt; [1] 1.96286543 0.03713457
```

---

# PCA en R: con prcomp


```r
pca &lt;- prcomp(iris_bi, scale. = TRUE)
pca
```

```
&gt; Standard deviations (1, .., p=2):
&gt; [1] 1.4010230 0.1927033
&gt; 
&gt; Rotation (n x k) = (2 x 2):
&gt;                    PC1        PC2
&gt; Petal.Length 0.7071068 -0.7071068
&gt; Petal.Width  0.7071068  0.7071068
```

La **primera componente** viene definida como

`$$\boldsymbol{\Phi}_1 = 0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$` 

La **segunda componente** viene definida como 

`$$\boldsymbol{\Phi}_2 = -0.7071068 * Petal.Length^* +  0.7071068 * Petal.Width^*$$`


---

# PCA en R: con prcomp

.pull-left[

En `pca$x` quedan guardados los **scores** o nuevas coordenadas de nuestros datos


```r
as_tibble(pca$x)
```

```
&gt; # A tibble: 150 × 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # … with 140 more rows
```

]

.pull-right[

También podemos calcularlas nosotros mismos **proyectando los datos en las nuevas componentes**


```r
as_tibble(as.matrix(iris_bi_std) %*%
            pca$rotation)
```

```
&gt; # A tibble: 150 × 2
&gt;      PC1     PC2
&gt;    &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 -1.87  0.0175
&gt;  2 -1.87  0.0175
&gt;  3 -1.91  0.0575
&gt;  4 -1.83 -0.0226
&gt;  5 -1.87  0.0175
&gt;  6 -1.57  0.0828
&gt;  7 -1.78  0.110 
&gt;  8 -1.83 -0.0226
&gt;  9 -1.87  0.0175
&gt; 10 -1.92 -0.115 
&gt; # … with 140 more rows
```

]

---

# Visualizando la transformación

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-52-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-53-1.png" width="100%" /&gt;

]

---

# Visualizando la transformación


Si ahora pintamos los datos **codificando el color en función de la especie** podemos darnos cuenta de por qué la primera componente es la que captura prácticamente toda la información.

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-54-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-55-1.png" width="100%" /&gt;

]


---

# PCA en R: con factominer y factoextra

Ahora que controlamos un poco cómo se calculan y qué significan, vamos a ampliar al dataset entero de iris `{iris}` con sus **4 variables numéricas**


```r
iris_full &lt;- iris %&gt;% select(-Species)

# Covarianza y correlación sin estandarizar antes
library(corrr)
cov(iris_full)
```

```
&gt;              Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; Sepal.Length    0.6856935  -0.0424340    1.2743154   0.5162707
&gt; Sepal.Width    -0.0424340   0.1899794   -0.3296564  -0.1216394
&gt; Petal.Length    1.2743154  -0.3296564    3.1162779   1.2956094
&gt; Petal.Width     0.5162707  -0.1216394    1.2956094   0.5810063
```

```r
iris_full %&gt;% correlate(diagonal = 1) %&gt;% fashion()
```

```
&gt;           term Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1 Sepal.Length         1.00        -.12          .87         .82
&gt; 2  Sepal.Width         -.12        1.00         -.43        -.37
&gt; 3 Petal.Length          .87        -.43         1.00         .96
&gt; 4  Petal.Width          .82        -.37          .96        1.00
```

---

# PCA en R: con factominer y factoextra

.pull-left[

Las correlaciones también podemos **visualizarlas** con el paquete `{corrplot}`

Las variables con mayor correlación (positiva además) es entre la longitud y la anchura del pétalo.

]

.pull-right[


```r
library(corrplot)
corrplot(cor(iris_full), type = "upper", tl.col = "black")
```

&lt;img src="index_files/figure-html/unnamed-chunk-57-1.png" width="100%" /&gt;
]

---


# PCA en R: con factominer y factoextra

Con `{FactoMineR}` podemos calcular con `PCA()` de forma muy sencilla, indicándole que de momento no queremos gráficos, que queremos tantas componentes como variables (luego ya decidiremos con cual nos quedamos) y que estandarice los datos (`scale.unit = TRUE`).


```r
library(FactoMineR)
library(factoextra)
pca_fit &lt;-
  PCA(iris_full, scale.unit = TRUE,
      ncp = ncol(iris_full), graph = FALSE)
```

--

Para mostrar los autovalores basta con `pca_fit$eig` (ya nos los da ordenados y con la varianza explicada, tanto componente a componente como acumulada). También se obtienen con `get_eig(pca_fit)`


```r
pca_fit$eig # Alternativa: get_eig(pca_fit)
```

```
&gt;        eigenvalue percentage of variance cumulative percentage of variance
&gt; comp 1 2.91849782             72.9624454                          72.96245
&gt; comp 2 0.91403047             22.8507618                          95.81321
&gt; comp 3 0.14675688              3.6689219                          99.48213
&gt; comp 4 0.02071484              0.5178709                         100.00000
```

---

# PCA en R: con factominer y factoextra

En `pca_fit$svd$V` se guardan los **autovectores o componentes principales (de nuevo por columnas)** asociados a los autovalores que ya tenemos ordenados


```r
pca_fit$svd$V
```

```
&gt;            [,1]       [,2]       [,3]       [,4]
&gt; [1,]  0.5210659 0.37741762 -0.7195664 -0.2612863
&gt; [2,] -0.2693474 0.92329566  0.2443818  0.1235096
&gt; [3,]  0.5804131 0.02449161  0.1421264  0.8014492
&gt; [4,]  0.5648565 0.06694199  0.6342727 -0.5235971
```

Además con `pca_fit$var$contrib` nos muestra en **porcentaje lo que aporta cada variable** a la varianza explicada por cada componente (la suma de cada columna es el 100%)


```r
pca_fit$var$contrib
```

```
&gt;                  Dim.1       Dim.2     Dim.3     Dim.4
&gt; Sepal.Length 27.150969 14.24440565 51.777574  6.827052
&gt; Sepal.Width   7.254804 85.24748749  5.972245  1.525463
&gt; Petal.Length 33.687936  0.05998389  2.019990 64.232089
&gt; Petal.Width  31.906291  0.44812296 40.230191 27.415396
```

---

# PCA en R: con factominer y factoextra


Así que darían expresadas los **loadings de las nuevas componentes principales** en función de las variables originales (estandarizadas `\(^*\)`)


|  Phi_1| Phi_2|  Phi_3|  Phi_4|
|------:|-----:|------:|------:|
|  0.521| 0.377| -0.720| -0.261|
| -0.269| 0.923|  0.244|  0.124|
|  0.580| 0.024|  0.142|  0.801|
|  0.565| 0.067|  0.634| -0.524|


`$$\boldsymbol{\Phi}_1 = 0.521 * Sepal.Length^* - 0.269 * Sepal.Width^* + 0.580 * Petal.Length^*  + 0.565 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_2 = 0.377 * Sepal.Length^*  + 0.923 * Sepal.Width^*  + 0.024 * Petal.Length^*  + 0.067 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_3 = -0.719 * Sepal.Length^*  + 0.244 * Sepal.Width^*  + 0.142 * Petal.Length^*  + 0.634 * Petal.Width^*$$`

`$$\boldsymbol{\Phi}_4 = -0.261 * Sepal.Length^*  + 0.124 * Sepal.Width^*  + 0.801 * Petal.Length^*  - 0.524 * Petal.Width^*$$`

---


# PCA en R: con factominer y factoextra

En `pca_fit$ind$coord` tenemos guardados los **scores**, las **nuevas coordenadas de los datos** (los **datos proyectados** en las nuevas direcciones).


```r
pca_scores &lt;- as_tibble(pca_fit$ind$coord)
names(pca_scores) &lt;- c("PC_1", "PC_2", "PC_3", "PC_4")
pca_scores # Nuevas coordenadas
```

```
&gt; # A tibble: 150 × 4
&gt;     PC_1    PC_2    PC_3     PC_4
&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
&gt;  1 -2.26  0.480  -0.128  -0.0242 
&gt;  2 -2.08 -0.674  -0.235  -0.103  
&gt;  3 -2.36 -0.342   0.0442 -0.0284 
&gt;  4 -2.30 -0.597   0.0913  0.0660 
&gt;  5 -2.39  0.647   0.0157  0.0359 
&gt;  6 -2.08  1.49    0.0270 -0.00661
&gt;  7 -2.44  0.0476  0.335   0.0368 
&gt;  8 -2.23  0.223  -0.0887  0.0246 
&gt;  9 -2.33 -1.12    0.145   0.0269 
&gt; 10 -2.18 -0.469  -0.254   0.0399 
&gt; # … with 140 more rows
```

---

# PCA en R: con factominer y factoextra


Podemos también calcular las **covarianzas entre cada componente principal y las variables originales**, tal que `\(Cov(\boldsymbol{\Phi}_i, \boldsymbol{x}_j ) = \lambda_i z_{i,j}\)`, donde `\(z_{i,j}\)` es el coeficiente `\(j\)`-ésimo de la componente `\(i\)`-ésima (el peso de la variable `\(\boldsymbol{x}_j\)` en la componente `\(\boldsymbol{\Phi}_i\)`)

La correlación será calculada como `\({\rm Cor}(\boldsymbol{\Phi}_i, \boldsymbol{x}_j ) = \frac{Cov (\boldsymbol{\Phi}_i, \boldsymbol{x}_j )}{s_{\boldsymbol{\Phi}_i} s_{\boldsymbol{x}_j}} = \frac{\lambda_i z_{i,j}}{\sqrt{\lambda_i} s_{\boldsymbol{x}_j}} = \frac{\sqrt{\lambda_i}}{s_{x_j}} z_{i,j}\)`

Dichas correlaciones las tenemos guardadas en `pca_fit$var$cor` y representan las **coordenadas de cada variable en cada componente** 


```r
pca_fit$var$cor
```

```
&gt;                   Dim.1      Dim.2       Dim.3       Dim.4
&gt; Sepal.Length  0.8901688 0.36082989 -0.27565767 -0.03760602
&gt; Sepal.Width  -0.4601427 0.88271627  0.09361987  0.01777631
&gt; Petal.Length  0.9915552 0.02341519  0.05444699  0.11534978
&gt; Petal.Width   0.9649790 0.06399985  0.24298265 -0.07535950
```

---


# PCA en R: con factominer y factoextra

.pull-left[

En `pca_fit$var$cos2` tenemos las **correlaciones al cuadrado**, que expresan la **proporción de varianza de cada variable explicada por cada componente**


```r
round(pca_fit$var$cos2, 3)
```

```
&gt;              Dim.1 Dim.2 Dim.3 Dim.4
&gt; Sepal.Length 0.792 0.130 0.076 0.001
&gt; Sepal.Width  0.212 0.779 0.009 0.000
&gt; Petal.Length 0.983 0.001 0.003 0.013
&gt; Petal.Width  0.931 0.004 0.059 0.006
```

Con `fviz_pca_var` podemos **visualizar de forma bidimensional** como se relacionan las variables originales con las dos componentes que mayor cantidad de varianza capturan.

La **primera componente captura** sobre todo las **dos variables del pétalo** (dichas variables prácticamente están sobre la horizontal de la primera componente). La **segunda componente** captura ligeramente el sépalo, aunque longitud del sépalo es la peor variable representada de todas.

]

.pull-right[


```r
col &lt;- c("#00AFBB", "#E7B800", "#FC4E07")
fviz_pca_var(pca_fit, col.var = "cos2",
             gradient.cols = col,
             repel = TRUE) +
  theme_minimal() + 
  labs(title = "Coordenadas de las variables",
       color = "Prop. var. explicada")
```

&lt;img src="index_files/figure-html/unnamed-chunk-66-1.png" width="93%" /&gt;
]



---


# PCA en R: con factominer y factoextra

.pull-left[

Con `fviz_cos2()` podemos mostrar el **porcentaje de la varianza de las variables que es explicada** por las componentes que le indiquemos en `axes`

Así podemos apreciar que todas las 
**dos primeras componentes ya son capaces de capturar** al menos el 75% de la varianza de todas y cada una de las variables, rozando el 100% en las variables `Sepal.Width` y `Petal.Length`

]

.pull-right[


```r
fviz_cos2(pca_fit, choice = "var",
          axes = 1:2)
```

&lt;img src="index_files/figure-html/unnamed-chunk-67-1.png" width="93%" /&gt;
]

---

# PCA en R: con factominer y factoextra

.pull-left[

Con `fviz_eig()` podemos visualizar la varianza explicada por cada componente


```r
fviz_eig(pca_fit,
         barfill = "darkolivegreen",
         addlabels = TRUE) +
  theme_minimal() +
  labs(x = "Componente", 
       y = "% varianza explicada",
       title = "Porcentaje de varianza explicada")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-69-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra



.pull-left[

También podemos visualizar la **varianza acumulada** de forma manual


```r
cumvar &lt;- as_tibble(pca_fit$eig)
names(cumvar) &lt;- c("lambda", "var", "cumvar")

ggplot(cumvar, aes(x = 1:4, y = cumvar)) +
  geom_col(fill = "pink") +
  geom_hline(yintercept = 90,
             linetype = "dashed") +
  theme_minimal() +
  labs(x = "Componente", 
       y = "% varianza explicada",
       title = "% varianza acumulada")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-71-1.png" width="100%" /&gt;

]

---

# PCA en R: con factominer y factoextra

.pull-left[

Por último `fviz_pca_biplot()` nos permite visualizar en las dos dimensiones que más varianza capturan, e incluso nos permite **visualizar clústers** de observaciones con las elipses definidas por las matrices de covarianza de cada uno de los grupos.


```r
fviz_pca_biplot(pca_fit,
                col.ind = iris$Species,
                palette = "jco",
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                legend.title = "Especies")
```

Observamos de nuevo como la componente determinante es la primera, que nos discrimina perfectamente la especie de Setosa.

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-73-1.png" width="100%" /&gt;

]

---

# PCA con tidymodels

Por último, ahora que entendemos las componentes principales vamos a calcularlas haciendo uso de `{tidymodels}`, un conjunto de paquetes y herramientas para obtener un **único flujo de trabajo en el preprocesamiento, modelización y evaluación** de modelos.



&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="https://www.tmwr.org/premade/data-science-model.svg" alt="Infografía extraída de https://www.tmwr.org/dimensionality.html" width="75%" /&gt;
&lt;p class="caption"&gt;Infografía extraída de https://www.tmwr.org/dimensionality.html&lt;/p&gt;
&lt;/div&gt;


```r
library(tidymodels)
```

---


# Filosofía tidymodels

La idea detrás de `{tidymodels}` es **tratar por separado** la depuración y preparación de los datos, el modelo o paradigma de aprendizaje que se quiere aplicar, la optimización de los parámetros de dicho modelo, el ajuste, la evaluación y la predicción correspondiente, **creando un flujo de trabajo muy flexible**. La **filosofía es la misma que hay detrás de cocinar un plato**:

1. Primero **escribimos la RECETA**, una lista de pasos e instrucciones.
2. Después **preparamos HERRAMIENTAS y utensilios para cocinar** (nuestro modelo).
3. Con la **RECETA + HERRAMIENTAS** podemos cocinar el plato muchas veces, con **distintos lotes de ingredientes (datos)**.

&amp;nbsp;

&lt;img src="https://www.tmwr.org/premade/recipes-process.svg" width="85%" style="display: block; margin: auto;" /&gt;


---

# Ejemplo tidymodels: algoritmo knn

.pull-left[

Los datos utilizados forman parte de un cojunto de reservas de hotel elaborado por [Antonio et al., 2019](https://www.sciencedirect.com/science/article/pii/S2352340918315191?via%3Dihub). El **conjunto utilizado tiene 50 000 registros de reservas**, con algunas de las siguientes [variables](https://linkinghub.elsevier.com/retrieve/pii/S2352340918315191)

* `hotel`: nombre del hotel.
* `lead_time`: lapso de tiempo entre la reserva y la estancia.
* `children`: si la reserva tiene niños o no.
* `meal`: régimen de comidas.
* `country`: país de origen.
* `average_daily_rate`: tarifa media diaria.
* `arrival_date`: fecha de llegada.

]

.pull-right[

El **objetivo es predecir si una serva incluye niños/as o no**.


```r
hoteles_raw &lt;- read_csv("./DATOS/hotels.csv")
glimpse(hoteles_raw)
```

```
&gt; Rows: 50,000
&gt; Columns: 23
&gt; $ hotel                          &lt;chr&gt; "City_Hotel", "City_Hotel", "Resort_Hot…
&gt; $ lead_time                      &lt;dbl&gt; 217, 2, 95, 143, 136, 67, 47, 56, 80, 6…
&gt; $ stays_in_weekend_nights        &lt;dbl&gt; 1, 0, 2, 2, 1, 2, 0, 0, 0, 2, 1, 0, 1, …
&gt; $ stays_in_week_nights           &lt;dbl&gt; 3, 1, 5, 6, 4, 2, 2, 3, 4, 2, 2, 1, 2, …
&gt; $ adults                         &lt;dbl&gt; 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 2, 1, 2, …
&gt; $ children                       &lt;chr&gt; "none", "none", "none", "none", "none",…
&gt; $ meal                           &lt;chr&gt; "BB", "BB", "BB", "HB", "HB", "SC", "BB…
&gt; $ country                        &lt;chr&gt; "DEU", "PRT", "GBR", "ROU", "PRT", "GBR…
&gt; $ market_segment                 &lt;chr&gt; "Offline_TA/TO", "Direct", "Online_TA",…
&gt; $ distribution_channel           &lt;chr&gt; "TA/TO", "Direct", "TA/TO", "TA/TO", "D…
&gt; $ is_repeated_guest              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
&gt; $ previous_cancellations         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
&gt; $ previous_bookings_not_canceled &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
&gt; $ reserved_room_type             &lt;chr&gt; "A", "D", "A", "A", "F", "A", "C", "B",…
&gt; $ assigned_room_type             &lt;chr&gt; "A", "K", "A", "A", "F", "A", "C", "A",…
&gt; $ booking_changes                &lt;dbl&gt; 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
&gt; $ deposit_type                   &lt;chr&gt; "No_Deposit", "No_Deposit", "No_Deposit…
&gt; $ days_in_waiting_list           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
&gt; $ customer_type                  &lt;chr&gt; "Transient-Party", "Transient", "Transi…
&gt; $ average_daily_rate             &lt;dbl&gt; 80.75, 170.00, 8.00, 81.00, 157.60, 49.…
&gt; $ required_car_parking_spaces    &lt;chr&gt; "none", "none", "none", "none", "none",…
&gt; $ total_of_special_requests      &lt;dbl&gt; 1, 3, 2, 1, 4, 1, 1, 1, 1, 1, 0, 1, 0, …
&gt; $ arrival_date                   &lt;date&gt; 2016-09-01, 2017-08-25, 2016-11-19, 20…
```

]

---

# Ejemplo tidymodels: algoritmo knn


### **Muestreo inicial**

Una de las primeras acciones que quizás queremos realizar es un **muestreo inicial** de los datos

* **Muestreo inicial**: `slice_sample` realiza un **muestreo aleatorio**, indicándole en `prop` el porcentaje de datos a extraer (**reminder**: los que no selecciones no continuan a lo largo del flujo).



```r
# Sample inicial: nos quedamos el 15% de los datos
hoteles &lt;- hoteles_raw %&gt;% slice_sample(prop = 0.15)
dim(hoteles_raw)
```

```
&gt; [1] 50000    23
```

```r
dim(hoteles)
```

```
&gt; [1] 7500   23
```

---

# Ejemplo tidymodels: algoritmo knn


### **Partición train/test**

Otra acción habitual será obtener varios **subconjuntos**:

* `train`: para entrenar el algoritmo.
* `validation`: para validar el modelo (quizás haya que volver a `train`)
* `test`: para puntuar nuestro algoritmo (con datos que no han sido usados ni para entrenar ni para validar)

Dado que **tenemos muy pocos 1's en nuestra variable objetivo**, debemos intentar preservar los máximos posibles (para que no nos quede un conjunto aún más desbalanceado).


```r
# Objetivo: predecir si la reserva tiene niños o no
hoteles_raw %&gt;%
  count(children) %&gt;%
  mutate(porc = 100 * n / sum(n))
```

```
&gt; # A tibble: 2 × 3
&gt;   children     n  porc
&gt;   &lt;chr&gt;    &lt;int&gt; &lt;dbl&gt;
&gt; 1 children  4038  8.08
&gt; 2 none     45962 91.9
```

---

# Ejemplo tidymodels: algoritmo knn


### **Partición train/test**

Realizaremos una **partición train-test** estratificado por la variable `children`: repartiremos en **80-20%** los datos **PERO asegurándonos de que la proporción de 0's-1's se preserva**.


```r
# Partición 80-20%: estratificada para que mantenga 1/0
hoteles_split &lt;- initial_split(hoteles, strata = children, prop = 0.8)
hoteles_split
```

```
&gt; &lt;Analysis/Assess/Total&gt;
&gt; &lt;6000/1500/7500&gt;
```

&amp;nbsp;

En `hoteles_split` tenemos **guardada las instrucciones** de lo que queremos hacer cuando lo apliquemos, pero hasta que no se aplique no realiza ninguna acción.


```r
hotel_train &lt;- training(hoteles_split)
hotel_test &lt;- testing(hoteles_split)
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**

* Asignar roles a variables
* Recategorizar
* Procesar outliers
* Datos ausentes
* Fechas
* Estandarización por rango y/o normalización (tipificación)

La lista de arriba son **algunas de las opciones que quizás querramos hacer** con nuestras variables antes de poder aplicar un modelo.

&amp;nbsp;

Lo que haremos será indicarle una **lista de instrucciones**, algo así como la **receta escrita que tenemos guardada en un cajón** para preparar un plato. La receta por sí sola no se pone a cocinarte menús, simplemente es una lista de instrucciones, lista para cuando la necesites.

Las funciones que empiezan por `step_` tienen implementadas muchas de las funcionalidades que podemos realizar en depuración con `{tidyverse}`. La diferencia al incluirlo en la receta es que **se ejecutará cada vez que dicha receta se aplique (tanto a train como a test)**.

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .)
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).
* **Convertimos a cualitativa** las variables de texto.


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor))
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).
* **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**: actualizar rol de la variable (`update_role()`), añadir rol amén del existente (`add_role()`), eliminar rol (`remove_role()`)


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel") 
```


---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).
* **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**: actualizar rol de la variable (`update_role()`), añadir rol amén del existente (`add_role()`), eliminar rol (`remove_role()`).
* **Recategorizar variables**: vamos a pasar a binaria `is_repeated_guest` y convertiremos a factor `previous_cancellations`, `reserved_room_type`, `assigned_room_type`, `booking_changes`, `deposit_type` y `days_in_waiting_list`. Con `step_other()` además le vamos a indicar que si en una **variable cualitativa hay algún nivel en proporciones ínfimas (por ejemplo, representa menos del 0.5% del total) las reagrupe** en una categoría llamada «others».


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel") %&gt;%
  step_mutate(is_repeated_guest = (is_repeated_guest == 1),
              across(previous_cancellations:days_in_waiting_list,
                     as.factor)) %&gt;%
  # Indicamos % mínimo en categoría (si &lt; 0.5%, reagrupa a others)
  step_other(all_nominal_predictors(), threshold = 0.005)
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).
* **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**: actualizar rol de la variable (`update_role()`), añadir rol amén del existente (`add_role()`), eliminar rol (`remove_role()`).
* **Recategorizar variables**.
* **Estandarizar por rango** con `step_range()` (siempre entre 0 y 1, aunque podríamos asignarle otro rango dando valores a `max` y `min`). Con `step_normalize()` normalizaríamos (media nula y varianza unitaria).



```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel")  %&gt;%
  step_mutate(is_repeated_guest = (is_repeated_guest == 1),
              across(previous_cancellations:days_in_waiting_list,
                     as.factor)) %&gt;%
  # Indicamos % mínimo en categoría (si &lt; 0.5%, reagrupa a others)
  step_other(all_nominal_predictors(), threshold = 0.005) %&gt;% 
  step_range(all_numeric_predictors(), min = 0, max = 1)
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo).
* **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**.
* **Recategorizar variables**.
* **Estandarizar por rango**.
* **Rebalancear objetivo**: en nuestros datos tan solo tenemos cerca del 8% de registros con `children = children` (1's). Usaremos el **sobremuestreo**: duplicar algunos registros con 1 en la variable objetivo para que **equilibrar** la proporción de 0's vs 1's. Para ello basta con añadir en nuestra receta el paso `step_upsample` del paquete `{themis}`, indicándole en `over_ratio` la relación que queremos entre la clase minoritaria y la mayoritaria.



```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel")  %&gt;%
  step_mutate(is_repeated_guest = (is_repeated_guest == 1),
              across(previous_cancellations:days_in_waiting_list,
                     as.factor)) %&gt;%
  # Indicamos % mínimo en categoría (si &lt; 0.5%, reagrupa a others)
  step_other(all_nominal_predictors(), threshold = 0.005) %&gt;% 
  step_range(all_numeric_predictors(), min = 0, max = 1) %&gt;%
  themis::step_upsample(children, over_ratio = 0.5)
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo). **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**. **Recategorizar variables**.
* **Estandarizar** por rango. **Rebalancear** objetivo.
* **Tratar datos atípicos y missings**.


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel")  %&gt;%
  step_mutate(is_repeated_guest = (is_repeated_guest == 1),
              across(previous_cancellations:days_in_waiting_list,
                     as.factor)) %&gt;%
  # Indicamos % mínimo en categoría (si &lt; 0.5%, reagrupa a others)
  step_other(all_nominal_predictors(), threshold = 0.005) %&gt;% 
  step_range(all_numeric_predictors(), min = 0, max = 1) %&gt;%
  themis::step_upsample(children, over_ratio = 0.5) %&gt;%
  step_mutate_at(all_numeric_predictors(),
                 fn = function(x) { ifelse(abs(x - mean(x, na.rm = TRUE)) &gt; 5 * sd(x, na.rm = TRUE), NA, x)}) %&gt;%
  # Imputamos por la media las numéricas, por la moda las cuali
  step_impute_mean(all_numeric_predictors()) %&gt;%
  step_impute_mode(all_nominal_predictors())
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


* **Variable objetivo**: `children` será nuestra outcome (variable objetivo). **Convertimos a cualitativa** las variables de texto.
* **Roles de variables**. **Recategorizar variables**.
* **Estandarizar** por rango. **Rebalancear** objetivo.
* **Tratar datos atípicos y missings**. Convertimos **cualitativas a dummy**.


```r
receta &lt;-
  recipe(data = hotel_train, children ~ .) %&gt;% 
  step_mutate(across(where(is.character), as.factor)) %&gt;%
  add_role(hotel, new_role = "type_hotel")  %&gt;%
  step_mutate(is_repeated_guest = (is_repeated_guest == 1),
              across(previous_cancellations:days_in_waiting_list,
                     as.factor)) %&gt;%
  # Indicamos % mínimo en categoría (si &lt; 0.5%, reagrupa a others)
  step_other(all_nominal_predictors(), threshold = 0.005) %&gt;% 
  step_range(all_numeric_predictors(), min = 0, max = 1) %&gt;%
  themis::step_upsample(children, over_ratio = 0.5) %&gt;%
  step_mutate_at(all_numeric_predictors(),
                 fn = function(x) { ifelse(abs(x - mean(x, na.rm = TRUE)) &gt; 5 * sd(x, na.rm = TRUE), NA, x)}) %&gt;%
  # Imputamos por la media las numéricas, por la moda las cuali
  step_impute_mean(all_numeric_predictors()) %&gt;%
  step_impute_mode(all_nominal_predictors()) %&gt;% 
  # nominales las pasemos a dummy 1/0 (country también)
  step_dummy(all_nominal(), -all_outcomes())
```

---

# Ejemplo tidymodels: algoritmo knn

### **Receta sencilla (recipe)**


```r
receta
```

```
&gt; Recipe
&gt; 
&gt; Inputs:
&gt; 
&gt;        role #variables
&gt;     outcome          1
&gt;   predictor         22
&gt;  type_hotel          1
&gt; 
&gt; Operations:
&gt; 
&gt; Variable mutation for across(where(is.character), as.factor)
&gt; Variable mutation for (is_repeated_guest == 1), across(previous_...
&gt; Collapsing factor levels for all_nominal_predictors()
&gt; Range scaling to [0,1] for all_numeric_predictors()
&gt; $terms
&gt; &lt;list_of&lt;quosure&gt;&gt;
&gt; 
&gt; [[1]]
&gt; &lt;quosure&gt;
&gt; expr: ^children
&gt; env:  0x7fec347345b8
&gt; 
&gt; 
&gt; $over_ratio
&gt; [1] 0.5
&gt; 
&gt; $ratio
&gt; [1] NA
&gt; 
&gt; $role
&gt; [1] NA
&gt; 
&gt; $trained
&gt; [1] FALSE
&gt; 
&gt; $column
&gt; NULL
&gt; 
&gt; $target
&gt; [1] NA
&gt; 
&gt; $skip
&gt; [1] TRUE
&gt; 
&gt; $id
&gt; [1] "upsample_2Zkur"
&gt; 
&gt; $seed
&gt; [1] 42898
&gt; 
&gt; attr(,"class")
&gt; [1] "step_upsample" "step"         
&gt; Variable mutation for all_numeric_predictors()
&gt; Mean imputation for all_numeric_predictors()
&gt; Mode imputation for all_nominal_predictors()
&gt; Dummy variables from all_nominal(), -all_outcomes()
```

---

# Ejemplo tidymodels: algoritmo knn

### **Horneado (bake)**

Tras escribir la receta vamos a **prepararla** y a **hornear los datos** con `bake()`: para hornearla en el conjunto de train, basta con poner `new_data = NULL`.


```r
# Aplicado a train
bake(receta %&gt;% prep(), new_data = NULL)
```

```
&gt; # A tibble: 8,295 × 72
&gt;    lead_time stays_in_weekend_nights stays_in_week_nigh… adults is_repeated_gue…
&gt;        &lt;dbl&gt;                   &lt;dbl&gt;               &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;           
&gt;  1   0.0535                   0.143               0.2      0.25 FALSE           
&gt;  2   0                        0                   0.0286   0.5  FALSE           
&gt;  3   0.00185                  0.143               0.0286   0.5  FALSE           
&gt;  4   0.0554                   0.0714              0.0571   0.5  FALSE           
&gt;  5   0.0554                   0.0714              0.0857   0.5  FALSE           
&gt;  6   0.116                    0                   0.0286   0.5  FALSE           
&gt;  7   0                        0                   0.0286   0.25 FALSE           
&gt;  8   0.0867                   0                   0.0286   0.5  FALSE           
&gt;  9   0.0793                   0                   0.114    0.5  FALSE           
&gt; 10   0.0185                   0                   0.0286   0.5  FALSE           
&gt; # … with 8,285 more rows, and 67 more variables: average_daily_rate &lt;dbl&gt;,
&gt; #   total_of_special_requests &lt;dbl&gt;, arrival_date &lt;date&gt;, children &lt;fct&gt;,
&gt; #   hotel_Resort_Hotel &lt;dbl&gt;, meal_HB &lt;dbl&gt;, meal_SC &lt;dbl&gt;,
&gt; #   meal_Undefined &lt;dbl&gt;, meal_other &lt;dbl&gt;, country_BEL &lt;dbl&gt;,
&gt; #   country_BRA &lt;dbl&gt;, country_CHE &lt;dbl&gt;, country_CHN &lt;dbl&gt;, country_CN &lt;dbl&gt;,
&gt; #   country_DEU &lt;dbl&gt;, country_ESP &lt;dbl&gt;, country_FRA &lt;dbl&gt;, country_GBR &lt;dbl&gt;,
&gt; #   country_IRL &lt;dbl&gt;, country_ISR &lt;dbl&gt;, country_ITA &lt;dbl&gt;, …
```

---

# Ejemplo tidymodels: algoritmo knn

### **Horneado (bake)**

Para hornearla en el conjunto de test basta con poner `new_data = hotel_test`. Nuestra receta, aplicada a nuestros ingredientes, está lista. Este «horneado» con `bake()` solo lo necesitamos **si queremos ya aplicar la receta a nuestros datos**.


```r
bake(receta %&gt;% prep(), new_data = hotel_test)
```

```
&gt; # A tibble: 1,500 × 72
&gt;    lead_time stays_in_weekend_nights stays_in_week_nigh… adults is_repeated_gue…
&gt;        &lt;dbl&gt;                   &lt;dbl&gt;               &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;           
&gt;  1   0.00185                  0.0714              0.0286   0.5  FALSE           
&gt;  2   0.0332                   0.0714              0.0286   0.5  FALSE           
&gt;  3   0.0387                   0.0714              0.0857   0.5  FALSE           
&gt;  4   0.00738                  0.143               0.0857   0.5  FALSE           
&gt;  5   0.00369                  0                   0.0286   0.25 FALSE           
&gt;  6   0.393                    0.0714              0.0286   0.5  FALSE           
&gt;  7   0.0627                   0.143               0.143    0.5  FALSE           
&gt;  8   0.0480                   0                   0.0286   0.25 FALSE           
&gt;  9   0.0185                   0.143               0.0857   0.5  FALSE           
&gt; 10   0.415                    0.0714              0.0857   0.25 FALSE           
&gt; # … with 1,490 more rows, and 67 more variables: average_daily_rate &lt;dbl&gt;,
&gt; #   total_of_special_requests &lt;dbl&gt;, arrival_date &lt;date&gt;, children &lt;fct&gt;,
&gt; #   hotel_Resort_Hotel &lt;dbl&gt;, meal_HB &lt;dbl&gt;, meal_SC &lt;dbl&gt;,
&gt; #   meal_Undefined &lt;dbl&gt;, meal_other &lt;dbl&gt;, country_BEL &lt;dbl&gt;,
&gt; #   country_BRA &lt;dbl&gt;, country_CHE &lt;dbl&gt;, country_CHN &lt;dbl&gt;, country_CN &lt;dbl&gt;,
&gt; #   country_DEU &lt;dbl&gt;, country_ESP &lt;dbl&gt;, country_FRA &lt;dbl&gt;, country_GBR &lt;dbl&gt;,
&gt; #   country_IRL &lt;dbl&gt;, country_ISR &lt;dbl&gt;, country_ITA &lt;dbl&gt;, …
```

---

# Ejemplo tidymodels: algoritmo knn

### **Utensilios (modelo)**

Una vez que tenemos nuestra lista de instrucciones, lo siguiente que haríamos al **cocinar un plato** es buscar los utensilios: cuchillos, cacerolas, batidora, etc. En nuestro caso los **utensilios serán nuestro modelo (en este caso de clasificación)**, con `nearest_neighbor()` (echa un vistazo a los modelos del paquete `{parsnip}`). 

- `mode`: admite dos opciones, `mode = "classification"` o `mode = "regression"`.
- `neighbors`: el número de vecinos `k` que consideramos como entorno de vecindad.
- `weight_func`: función (kernel) para promedir distancias (`weight_func = "inv"` nos promedia por el inverso de la distancia; ver opciones en &lt;https://epub.ub.uni-muenchen.de/1769/&gt;)
- `dist_power`: número `\(p\)` de la distancia de Minkowski


```r
knn_model &lt;-
  nearest_neighbor(mode = "classification", neighbors = 10,
                   weight_func = "inv", dist_power = 2) %&gt;%
  set_engine("kknn") # el «motor» que realiza el ajuste
knn_model
```

```
&gt; K-Nearest Neighbor Model Specification (classification)
&gt; 
&gt; Main Arguments:
&gt;   neighbors = 10
&gt;   weight_func = inv
&gt;   dist_power = 2
&gt; 
&gt; Computational engine: kknn
```

---

# Ejemplo tidymodels: algoritmo knn

### **Flujo de trabajo**


Con dichos ingredientes podemos crear ya un **flujo de trabajo** con `workflow()`


```r
# Flujo de trabajo
hoteles_wflow &lt;-
  workflow() %&gt;%
  add_recipe(receta) %&gt;%
  add_model(knn_model)
hoteles_wflow
```

```
&gt; ══ Workflow ════════════════════════════════════════════════════════════════════
&gt; Preprocessor: Recipe
&gt; Model: nearest_neighbor()
&gt; 
&gt; ── Preprocessor ────────────────────────────────────────────────────────────────
&gt; 9 Recipe Steps
&gt; 
&gt; • step_mutate()
&gt; • step_mutate()
&gt; • step_other()
&gt; • step_range()
&gt; • step_upsample()
&gt; • step_mutate_at()
&gt; • step_impute_mean()
&gt; • step_impute_mode()
&gt; • step_dummy()
&gt; 
&gt; ── Model ───────────────────────────────────────────────────────────────────────
&gt; K-Nearest Neighbor Model Specification (classification)
&gt; 
&gt; Main Arguments:
&gt;   neighbors = 10
&gt;   weight_func = inv
&gt;   dist_power = 2
&gt; 
&gt; Computational engine: kknn
```

---

# Ejemplo tidymodels: algoritmo knn

### **Ajuste y predicción**

Dichos pasos vamos a **proporcionárselos a nuestro conjunto de entrenamiento** para que nos **aplique el flujo de trabajo** que hemos construido, usando `fit(data = hotel_train)`.


```r
# Aplicamos flujo
library("kknn")
hoteles_knn_fit &lt;-
  hoteles_wflow %&gt;% fit(data = hotel_train)
hoteles_knn_fit
```

```
&gt; ══ Workflow [trained] ══════════════════════════════════════════════════════════
&gt; Preprocessor: Recipe
&gt; Model: nearest_neighbor()
&gt; 
&gt; ── Preprocessor ────────────────────────────────────────────────────────────────
&gt; 9 Recipe Steps
&gt; 
&gt; • step_mutate()
&gt; • step_mutate()
&gt; • step_other()
&gt; • step_range()
&gt; • step_upsample()
&gt; • step_mutate_at()
&gt; • step_impute_mean()
&gt; • step_impute_mode()
&gt; • step_dummy()
&gt; 
&gt; ── Model ───────────────────────────────────────────────────────────────────────
&gt; 
&gt; Call:
&gt; kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(10,     data, 5), distance = ~2, kernel = ~"inv")
&gt; 
&gt; Type of response variable: nominal
&gt; Minimal misclassification: 0.02845087
&gt; Best kernel: inv
&gt; Best k: 10
```

---

# Ejemplo tidymodels: algoritmo knn

### **Ajuste y predicción**

Dicho ajuste guardado en `hoteles_knn_fit` podemos usarlo para **predecir el conjunto test** de dos maneras:

* **Clase**
* **Probabilidades** (de pertenencia a dichas clases, necesario para el cálculo de la **curva ROC**)

Ambas se hacen con `predict()` pasándole un argumento de `type` diferente. **Reminder**: al tenerlo todo integrado en un flujo, **aplicará el procesamiento que necesite al conjunto de test**, tal cual lo hemos indicado en las instrucciones.


```r
# Predecir el conjunto test: devuelve la clase
predict(hoteles_knn_fit, hotel_test)
```

```
&gt; # A tibble: 1,500 × 1
&gt;    .pred_class
&gt;    &lt;fct&gt;      
&gt;  1 none       
&gt;  2 none       
&gt;  3 none       
&gt;  4 none       
&gt;  5 none       
&gt;  6 none       
&gt;  7 none       
&gt;  8 none       
&gt;  9 none       
&gt; 10 none       
&gt; # … with 1,490 more rows
```

```r
# Predecir las probabilidades (las necesitamos para la ROC)
predict(hoteles_knn_fit, hotel_test, type = "prob")
```

```
&gt; # A tibble: 1,500 × 2
&gt;    .pred_children .pred_none
&gt;             &lt;dbl&gt;      &lt;dbl&gt;
&gt;  1          0          1    
&gt;  2          0          1    
&gt;  3          0          1    
&gt;  4          0          1    
&gt;  5          0          1    
&gt;  6          0          1    
&gt;  7          0.167      0.833
&gt;  8          0          1    
&gt;  9          0.308      0.692
&gt; 10          0          1    
&gt; # … with 1,490 more rows
```

---

# Ejemplo tidymodels: algoritmo knn

### **Ajuste y predicción**

Dentro del paquete `{parsnip}` que hemos cargado dentro de `{tidymodels}` tenemos a nuestra disposición una función llamada `augment()` que nos permite **incluir en una misma tabla las predicciones de la clase, de las probabilidades y los datos de test originales** (añadiendo columnas).


```r
# Para obtener las probabilidades en los datos (con variables)
prob_test &lt;- augment(hoteles_knn_fit, hotel_test)
print(prob_test, width = Inf)
```

```
&gt; # A tibble: 1,500 × 26
&gt;    hotel        lead_time stays_in_weekend_nights stays_in_week_nights adults
&gt;    &lt;chr&gt;            &lt;dbl&gt;                   &lt;dbl&gt;                &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 City_Hotel           1                       1                    1      2
&gt;  2 City_Hotel          18                       1                    1      2
&gt;  3 City_Hotel          21                       1                    3      2
&gt;  4 Resort_Hotel         4                       2                    3      2
&gt;  5 City_Hotel           2                       0                    1      1
&gt;  6 Resort_Hotel       213                       1                    1      2
&gt;  7 Resort_Hotel        34                       2                    5      2
&gt;  8 Resort_Hotel        26                       0                    1      1
&gt;  9 Resort_Hotel        10                       2                    3      2
&gt; 10 Resort_Hotel       225                       1                    3      1
&gt;    children meal  country market_segment distribution_channel is_repeated_guest
&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt;                            &lt;dbl&gt;
&gt;  1 children BB    PRT     Direct         Direct                               0
&gt;  2 none     BB    PRT     Groups         TA/TO                                0
&gt;  3 none     SC    FRA     Online_TA      TA/TO                                0
&gt;  4 none     HB    FRA     Online_TA      TA/TO                                0
&gt;  5 none     BB    GBR     Online_TA      TA/TO                                0
&gt;  6 none     HB    DEU     Groups         TA/TO                                0
&gt;  7 none     BB    PRT     Direct         Direct                               0
&gt;  8 none     BB    NULL    Corporate      Corporate                            0
&gt;  9 none     BB    IRL     Online_TA      TA/TO                                0
&gt; 10 none     BB    GBR     Groups         Direct                               0
&gt;    previous_cancellations previous_bookings_not_canceled reserved_room_type
&gt;                     &lt;dbl&gt;                          &lt;dbl&gt; &lt;chr&gt;             
&gt;  1                      0                              0 A                 
&gt;  2                      0                              0 A                 
&gt;  3                      0                              0 A                 
&gt;  4                      0                              0 E                 
&gt;  5                      0                              0 A                 
&gt;  6                      0                              0 A                 
&gt;  7                      0                              0 F                 
&gt;  8                      0                              2 A                 
&gt;  9                      0                              0 A                 
&gt; 10                      0                              0 A                 
&gt;    assigned_room_type booking_changes deposit_type days_in_waiting_list
&gt;    &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;                       &lt;dbl&gt;
&gt;  1 D                                0 No_Deposit                      0
&gt;  2 A                                0 No_Deposit                      0
&gt;  3 A                                0 No_Deposit                      0
&gt;  4 F                                1 No_Deposit                      0
&gt;  5 A                                1 No_Deposit                      0
&gt;  6 A                                0 No_Deposit                      0
&gt;  7 F                                0 No_Deposit                      0
&gt;  8 D                                0 No_Deposit                      0
&gt;  9 A                                0 No_Deposit                      0
&gt; 10 A                                2 No_Deposit                      0
&gt;    customer_type   average_daily_rate required_car_parking_spaces
&gt;    &lt;chr&gt;                        &lt;dbl&gt; &lt;chr&gt;                      
&gt;  1 Transient                     75   none                       
&gt;  2 Transient-Party               75   none                       
&gt;  3 Transient                     67.6 none                       
&gt;  4 Transient                    124   none                       
&gt;  5 Transient-Party              103.  none                       
&gt;  6 Transient-Party               85   none                       
&gt;  7 Transient                    256   none                       
&gt;  8 Transient                     48   none                       
&gt;  9 Transient                     76   parking                    
&gt; 10 Transient-Party               60   none                       
&gt;    total_of_special_requests arrival_date .pred_class .pred_children .pred_none
&gt;                        &lt;dbl&gt; &lt;date&gt;       &lt;fct&gt;                &lt;dbl&gt;      &lt;dbl&gt;
&gt;  1                         1 2015-08-08   none                 0          1    
&gt;  2                         0 2015-07-18   none                 0          1    
&gt;  3                         1 2017-01-12   none                 0          1    
&gt;  4                         0 2016-05-08   none                 0          1    
&gt;  5                         0 2016-08-02   none                 0          1    
&gt;  6                         0 2016-05-16   none                 0          1    
&gt;  7                         3 2017-08-24   none                 0.167      0.833
&gt;  8                         0 2015-10-27   none                 0          1    
&gt;  9                         3 2017-04-09   none                 0.308      0.692
&gt; 10                         0 2016-05-26   none                 0          1    
&gt; # … with 1,490 more rows
```

---

# Ejemplo tidymodels: algoritmo knn

### **Evaluación**

En realidad el conjunto de test solo deberíamos usarlo al final del proceso, no como evaluación intermedia de los hiperparámetros, ya que dicho rol le corresponde a un **tercer conjunto de validación**, pero de momento vamos a simplificarlo en train-test.

Una de las formas más sencillas de **evaluar un método de clasificación es con una matriz de confusión**: una matriz que nos cruce las frecuencias de las etiquetas reales frente a las predichas.


```r
# Matriz de confusión: etiqueta real vs etiqueta predicha
conf_mat_test &lt;-
  prob_test %&gt;% conf_mat(truth = children, estimate = .pred_class)

# La guardamos en una tabla
conf_mat_test &lt;- as_tibble(conf_mat_test$table)
conf_mat_test 
```

```
&gt; # A tibble: 4 × 3
&gt;   Prediction Truth        n
&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;int&gt;
&gt; 1 children   children    62
&gt; 2 none       children    67
&gt; 3 children   none       168
&gt; 4 none       none      1203
```

---


# Ejemplo tidymodels: algoritmo knn

### **Evaluación**

Muchas de las **métricas las podemos obtener automáticamente** de la matriz de confusión.


```r
# Matriz de confusión + resumen: etiqueta real vs etiqueta predicha
metricas &lt;-
  prob_test %&gt;% conf_mat(truth = children, estimate = .pred_class) %&gt;%
  summary()
metricas
```

```
&gt; # A tibble: 13 × 3
&gt;    .metric              .estimator .estimate
&gt;    &lt;chr&gt;                &lt;chr&gt;          &lt;dbl&gt;
&gt;  1 accuracy             binary         0.843
&gt;  2 kap                  binary         0.264
&gt;  3 sens                 binary         0.481
&gt;  4 spec                 binary         0.877
&gt;  5 ppv                  binary         0.270
&gt;  6 npv                  binary         0.947
&gt;  7 mcc                  binary         0.279
&gt;  8 j_index              binary         0.358
&gt;  9 bal_accuracy         binary         0.679
&gt; 10 detection_prevalence binary         0.153
&gt; 11 precision            binary         0.270
&gt; 12 recall               binary         0.481
&gt; 13 f_meas               binary         0.345
```

---

# PCA con tidymodels

Ahora que hemos visto por encima la idea de `{tidymodels}` vamos a calcular las componentes principales del conjunto `iris` con dicha idea.



```r
iris_ful7 &lt;- iris %&gt;% select(-Species)
library(corrplot)
iris_full %&gt;% cor() %&gt;% 
  corrplot(tl.col = "black", method = "ellipse")
```

&lt;img src="index_files/figure-html/iris-cor-1.png" width="3%" /&gt;

---

# PCA con tidymodels

La receta tendrá los siguientes pasos:

* Indicar la **variable objetivo** (`Species`)
* Imputamos **datos ausentes**
* **Estandarizar/normalizar** los datos
* Eliminamos variables de **cero varianza**


```r
receta &lt;- 
  recipe(Species ~ ., data = iris) %&gt;%
  # Imputamos por la media las numéricas, por la moda las cuali
  step_impute_mean(all_numeric_predictors()) %&gt;%
  step_impute_mode(all_nominal_predictors()) %&gt;%
  # Estandarizamos
  step_normalize(all_numeric_predictors()) %&gt;%
  # Filtro cero varianza
  step_zv(all_numeric_predictors())
receta
```

```
&gt; Recipe
&gt; 
&gt; Inputs:
&gt; 
&gt;       role #variables
&gt;    outcome          1
&gt;  predictor          4
&gt; 
&gt; Operations:
&gt; 
&gt; Mean imputation for all_numeric_predictors()
&gt; Mode imputation for all_nominal_predictors()
&gt; Centering and scaling for all_numeric_predictors()
&gt; Zero variance filter on all_numeric_predictors()
```

---

# PCA con tidymodels

Para añadir el **análisis de componentes principales** basta con añadir `step_pca()`


```r
receta &lt;-
  receta %&gt;%
  step_pca(all_numeric_predictors(), num_comp = 4,
           prefix = "PC") 
```
 
Con el argumento `num_comp = 4` indícamos el número de componentes y con `prefix` el prefijo con el que llamaremos a las nuevas variables

---

# PCA con tidymodels


```r
data_pc &lt;- bake(receta %&gt;% prep(), new_data = NULL)
data_pc
```

```
&gt; # A tibble: 150 × 5
&gt;    Species   PC1     PC2     PC3      PC4
&gt;    &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
&gt;  1 setosa  -2.26 -0.478   0.127   0.0241 
&gt;  2 setosa  -2.07  0.672   0.234   0.103  
&gt;  3 setosa  -2.36  0.341  -0.0441  0.0283 
&gt;  4 setosa  -2.29  0.595  -0.0910 -0.0657 
&gt;  5 setosa  -2.38 -0.645  -0.0157 -0.0358 
&gt;  6 setosa  -2.07 -1.48   -0.0269  0.00659
&gt;  7 setosa  -2.44 -0.0475 -0.334  -0.0367 
&gt;  8 setosa  -2.23 -0.222   0.0884 -0.0245 
&gt;  9 setosa  -2.33  1.11   -0.145  -0.0268 
&gt; 10 setosa  -2.18  0.467   0.253  -0.0398 
&gt; # … with 140 more rows
```

---

# PCA con tidymodels

.pull-left[


```r
ggplot(data_pc %&gt;% select(-Species),
       aes(x = .panel_x, y = .panel_y,
           color = Species, fill = Species)) +
    geom_point(alpha = 0.4, size = 0.7) +
    ggforce::geom_autodensity(alpha = 0.3) +
    ggforce::facet_matrix(layer.diag = 2) + 
    scale_color_brewer(palette = "Dark2") + 
    scale_fill_brewer(palette = "Dark2")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-93-1.png" width="100%" /&gt;

]


---
 
# PCA con tidymodels

.pull-left[


```r
library(learntidymodels)
receta %&gt;% prep() %&gt;% 
  plot_top_loadings(component_number &lt;= 4, n = 4) + 
  scale_fill_brewer(palette = "Paired")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-95-1.png" width="100%" /&gt;

]

---

class: inverse center middle

# BLOQUE II. Análisis clúster

&amp;nbsp;


### [¿Qué es el análisis clúster?](#intro-cluster)

### [Métricas](#metricas)

### [Algoritmos jerárquicos](#jerarquicos)

### [Algoritmos no jerárquicos](#no-jerarquicos)

### [Determinación del número de grupos](#n-grupos)


---

name: intro-cluster
class: center, middle

# ¿Qué es el análisis clúster?

---

# Introducción: ¿análisis clúster?

El **análisis clúster** forma parte de los **algoritmos de agrupación o clasificación** con **aprendizaje no supervisado**:

* **Clasificación supervisada**: los individuos se clasifican en un grupo a partir de la
información de un conjunto de variables observadas de unos inviduos **cuyo grupo conocemos**, los **datos están etiquetados** (sabemos que es acierto y error). Es el caso por ejemplo del **análisis discriminante**.


&lt;img src="./img/supervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;


---

# Introducción: ¿análisis clúster?

El **análisis clúster** forma parte de los **algoritmos de agrupación o clasificación** con **aprendizaje no supervisado**:


* **Clasificación/agrupación no supervisada**: los individuos también se clasifican en un grupo a partir de la información de un conjunto de variables observadas PERO en esta ocasión **no sabemos a qué grupo pertenece cada individuo a priori**, no tenemos conocimiento de qué es acierto y qué es error. Es este el caso del **análisis clúster**.


&lt;img src="./img/unsupervised_classification.png" width="80%" style="display: block; margin: auto 0 auto auto;" /&gt;

---

# Introducción: ¿análisis clúster?

### **Objetivo**

El análisis clúster tiene como principal objetivo **encontrar grupos** dentro de los individuos, de forma que los individuos de cada grupo sean **lo más parecidos entre sí** (homogeneidad interna) y **lo más diferentes a los individuos de otros grupos** (heterogeneidad entre grupos)


&amp;nbsp;

### **Notación**

* `\(n\)` tamaño muestral (número de individuos --&gt; filas).

* `\(\boldsymbol{X}_i = \left(\boldsymbol{X}_{1, i}, \ldots, \boldsymbol{X}_{i, p} \right)\)` conjunto de `\(p\)` variables (--&gt; columnas) medidas para cada individuo `\(i=1,\ldots,n\)`.

* Nuestros datos estarán en forma de tabla o matriz `\(\boldsymbol{X}\)` de `\(n\)` filas y `\(p\)` columnas (con `\(p \ll n\)`)
 
---
 
# Introducción: ¿análisis clúster?
 
Los algoritmos los dividiremos en dos grandes grupos:


* **Algoritmos jerárquicos**: algoritmos que tienen como objetivo construir una jerarquía de grupos. Existen principalmente dos estrategias:
  - **Aglomerativa**: cada individuo empieza siendo su propio grupo, mientras se van uniendo de forma secuencial ascendiendo en la jerarquía, hasta acabar con un solo grupo que incluya todas las observaciones.
  - **Divisiva**: se construye una jerarquía descendiente, empezando con un único grupo hasta acabar con un grupo por individuo

Los métodos jerárquicos suelen ser muy **explicativos** y fáciles de visualizar (por ejemplo, con un **dendograma**) pero **muy costoso computacionalmente** (ya que siempre se construye la jerarquía entera, para decidir luego dónde cortar)

&amp;nbsp;

* **Algoritmos no jerárquicos**: dado un número `\(K\)` de grupos fijado a priori, se pretenden agrupar los datos de forma que obtengamos finalmente `\(K\)` agrupaciones de los mismos.

---

name: metricas
class: center, middle

# Métricas


---

# Métricas

En los algoritmos usados será clave el concepto de **métrica**. Los datos serán agrupados en base a los conceptos de «lejos» y «cerca», o mejor dicho, en base a «parecido» y «diferente»

**¿Qué es ser parecido? ¿Y diferente?**

&amp;nbsp;

### **Métrica entre observaciones**

Para medir distancias entre los individuos tenemos principalmente dos alternativas:

* **Distancias geométricas**: distancias que miden la distancia entre dos individuos como si fuesen dos puntos en un espacio geométrico. Son distancias determinísticas.

* **Distancias probabilísticas**: distancias que miden la distancia entre individuos teniendo en cuenta la distribución de las variables y su dependencia.

---

# Métricas determinísticas


* **Distancia euclídea bidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{(x_{i, 1} - x_{j,1})^2 + (x_{i, 2} - x_{j, 2})^2}\)`
   

* **Distancia euclídea multidimensional**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} (x_{i,k} - x_{j,k})^2}\)`

* **Distancia Manhattan**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|\)`

* **Distancia de Minkowski**: `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \left(\displaystyle \sum_{k=1}^{p} \left| x_{i,k} - x_{j,k} \right|^l\right)^{1/l}\)` (si `\(l=1\)` es Manhattan, si `\(l=2\)` es Euclídea)
   
Cuando usemos este tipo métricas es **muy importante** **reescalar por rango**: transformamos para crear nuevas observaciones `\(\widetilde{x}_{i, k} = \frac{x_{i, k} - min(\boldsymbol{x}_i)}{max(\boldsymbol{x}_i) - min(\boldsymbol{x}_i)}\)` de forma que todas las variables estén entre 0 y 1 (y así todas tengan el mismo peso dentro de las métricas).

---

# Métricas determinísticas

&lt;img src="./img/minkowski.png" width="65%" style="display: block; margin: auto;" /&gt;

&lt;img src="./img/minkowski_1.png" width="65%" style="display: block; margin: auto;" /&gt;


---

# Métricas probabilísticas

* **Distancia de Mahalanobis** multidimensional **(variables independientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{\sigma_i} \right)^2}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\frac{x_{i, k} - x_{j,k}}{S_i} \right)^2}\)`

* **Distancia de Mahalanobis** multidimensional **(variables dependientes)**:  `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} \Sigma^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)` que se puede aproximar por `\(d(\boldsymbol{x}_i, \boldsymbol{x}_j) = \sqrt{\displaystyle \sum_{k=1}^{p} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)^{T} S^{-1} \left(\boldsymbol{x}_i - \boldsymbol{x}_j \right)}\)`, donde `\(\Sigma\)` es la matriz de covarianzas, con `\(S\)` matriz de (cuasi)covarianzas.
  
Cuando usemos este tipo métricas es **muy importante** **estandarizar** para tener variables de media `\(0\)` y varianza `\(1\)`.

---

# Métricas

### **Métrica entre variables**

Además de medir la distancia entre individuos podemos plantearnos medir la **distancia entre las propias variables**, normalmente basadas en la correlación de Pearson o sus derivados.

* **Correlación de Pearson**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| r_{1,2} \right|\)` donde `\(r_{1,2}\)` se define como la correlción entre las variables `\(\boldsymbol{X}_1\)` y `\(\boldsymbol{X}_2\)`

* **Correlación de Spearman**: definida como `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \rho_{1,2} \right| = 1 - \left| \frac{6 \sum D^{2}}{n (n^{2}-1)} \right|\)`, donde `\(D\)` es la diferencia entre los correspondientes estadísticos de orden.


* **Correlación de Kendall**: definida como  `\(d(\boldsymbol{X}_1, \boldsymbol{X}_2) = 1 - \left| \tau_{1,2} \right| =  1- \left| \frac{n_c - n_d}{\frac{1}{2} n (n-1)} \right|\)` donde `\(n_c\)` es el número de pares concordantes (si el orden de clasificación de `\((x_{i},x_{j})\)` y `\((y_{i},y_{j})\)` coinciden, tal que `\(x_{i}&gt;x_{j}\)` y `\(y_{i}&gt;y_{j}\)`, donde `\(i&lt;j\)`) y `\(n_d\)` es el número de pares discordantes

---

name: jerarquicos
class: center, middle

# Visualización previa

---

# Visualización previa

Vamos a empezar a trabajar con un conjunto familiar, el conjunto de `iris` que ya conocemos haciendo una selección previa de 35 observaciones


```r
iris_sample &lt;- iris %&gt;% slice_sample(n = 35)
iris_sample 
```

```
&gt;    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
&gt; 1           7.7         2.8          6.7         2.0  virginica
&gt; 2           5.1         3.8          1.5         0.3     setosa
&gt; 3           6.7         2.5          5.8         1.8  virginica
&gt; 4           5.5         2.4          3.7         1.0 versicolor
&gt; 5           5.7         2.8          4.5         1.3 versicolor
&gt; 6           4.8         3.4          1.9         0.2     setosa
&gt; 7           6.5         3.2          5.1         2.0  virginica
&gt; 8           5.8         2.7          3.9         1.2 versicolor
&gt; 9           5.6         2.9          3.6         1.3 versicolor
&gt; 10          6.4         2.8          5.6         2.1  virginica
&gt; 11          5.0         3.5          1.6         0.6     setosa
&gt; 12          5.1         3.3          1.7         0.5     setosa
&gt; 13          5.4         3.4          1.5         0.4     setosa
&gt; 14          6.0         2.2          5.0         1.5  virginica
&gt; 15          5.5         2.4          3.8         1.1 versicolor
&gt; 16          6.2         2.8          4.8         1.8  virginica
&gt; 17          5.5         4.2          1.4         0.2     setosa
&gt; 18          5.0         3.5          1.3         0.3     setosa
&gt; 19          4.3         3.0          1.1         0.1     setosa
&gt; 20          6.4         3.1          5.5         1.8  virginica
&gt; 21          5.6         2.8          4.9         2.0  virginica
&gt; 22          6.2         3.4          5.4         2.3  virginica
&gt; 23          6.8         2.8          4.8         1.4 versicolor
&gt; 24          5.1         3.5          1.4         0.3     setosa
&gt; 25          6.2         2.2          4.5         1.5 versicolor
&gt; 26          5.4         3.9          1.7         0.4     setosa
&gt; 27          7.9         3.8          6.4         2.0  virginica
&gt; 28          5.4         3.4          1.7         0.2     setosa
&gt; 29          7.2         3.0          5.8         1.6  virginica
&gt; 30          5.1         2.5          3.0         1.1 versicolor
&gt; 31          5.4         3.7          1.5         0.2     setosa
&gt; 32          6.9         3.1          5.1         2.3  virginica
&gt; 33          4.9         3.6          1.4         0.1     setosa
&gt; 34          6.5         3.0          5.5         1.8  virginica
&gt; 35          5.5         2.6          4.4         1.2 versicolor
```

---

# Visualización previa


Una primera visualización la podemos realizar con `heatmaply()` del paquete homónimo que nos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
library(heatmaply)
heatmaply(iris_sample,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

Es importante recordar que el **clustering** es un método de **clasificación NO SUPERVISADA**: no sabemos a priori el grupo correcto de cada individuo.

---

# Visualización previa

<div id="htmlwidget-9c89e686d13f5932f4c8" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9c89e686d13f5932f4c8">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[3.125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,3.125,4,null,4,4],"y":[27.9402934845001,27.9402934845001,null,27.9402934845001,16.2234398325386,null,16.2234398325386,16.2234398325386,null,16.2234398325386,12.8487353463288,null,12.8487353463288,12.8487353463288,null,12.8487353463288,0,null,12.8487353463288,12.8487353463288,null,12.8487353463288,0,null,16.2234398325386,16.2234398325386,null,16.2234398325386,0,null,27.9402934845001,27.9402934845001,null,27.9402934845001,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[6.82422156732913,6.82422156732913,null,6.82422156732913,2.26495033058123,null,2.26495033058123,2.26495033058123,null,2.26495033058123,1.06301458127346,null,1.06301458127346,1.06301458127346,null,1.06301458127346,0,null,1.06301458127346,1.06301458127346,null,1.06301458127346,0,null,2.26495033058123,2.26495033058123,null,2.26495033058123,1.37477270848675,null,1.37477270848675,1.37477270848675,null,1.37477270848675,1.12249721603218,null,1.12249721603218,1.12249721603218,null,1.12249721603218,0,null,1.12249721603218,1.12249721603218,null,1.12249721603218,0.734846922834953,null,0.734846922834953,0.734846922834953,null,0.734846922834953,0,null,0.734846922834953,0.734846922834953,null,0.734846922834953,0,null,1.37477270848675,1.37477270848675,null,1.37477270848675,0.818535277187245,null,0.818535277187245,0.818535277187245,null,0.818535277187245,0.509901951359279,null,0.509901951359279,0.509901951359279,null,0.509901951359279,0,null,0.509901951359279,0.509901951359279,null,0.509901951359279,0,null,0.818535277187245,0.818535277187245,null,0.818535277187245,0.714142842854285,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0,null,0.714142842854285,0.714142842854285,null,0.714142842854285,0.435889894354067,null,0.435889894354067,0.435889894354067,null,0.435889894354067,0,null,0.435889894354067,0.435889894354067,null,0.435889894354067,0.141421356237309,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,6.82422156732913,6.82422156732913,null,6.82422156732913,4.54972526643093,null,4.54972526643093,4.54972526643093,null,4.54972526643093,1.72626765016321,null,1.72626765016321,1.72626765016321,null,1.72626765016321,0,null,1.72626765016321,1.72626765016321,null,1.72626765016321,1.17473401244707,null,1.17473401244707,1.17473401244707,null,1.17473401244707,0,null,1.17473401244707,1.17473401244707,null,1.17473401244707,0.830662386291808,null,0.830662386291808,0.830662386291808,null,0.830662386291808,0.547722557505166,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.282842712474619,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.282842712474619,0.282842712474619,null,0.282842712474619,0,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.387298334620742,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0,null,0.387298334620742,0.387298334620742,null,0.387298334620742,0.331662479035541,null,0.331662479035541,0.331662479035541,null,0.331662479035541,0,null,0.331662479035541,0.331662479035541,null,0.331662479035541,0,null,0.830662386291808,0.830662386291808,null,0.830662386291808,0.648074069840786,null,0.648074069840786,0.648074069840786,null,0.648074069840786,0.3,null,0.3,0.3,null,0.3,0,null,0.3,0.3,null,0.3,0.141421356237309,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,0.648074069840786,0.648074069840786,null,0.648074069840786,0.547722557505166,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0,null,0.547722557505166,0.547722557505166,null,0.547722557505166,0.264575131106459,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,0.264575131106459,0.264575131106459,null,0.264575131106459,0,null,4.54972526643093,4.54972526643093,null,4.54972526643093,2.2494443758404,null,2.2494443758404,2.2494443758404,null,2.2494443758404,1.16189500386223,null,1.16189500386223,1.16189500386223,null,1.16189500386223,0,null,1.16189500386223,1.16189500386223,null,1.16189500386223,0.6,null,0.6,0.6,null,0.6,0.141421356237309,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,0.141421356237309,0.141421356237309,null,0.141421356237309,0,null,0.6,0.6,null,0.6,0.424264068711928,null,0.424264068711928,0.424264068711928,null,0.424264068711928,0,null,0.424264068711928,0.424264068711928,null,0.424264068711928,0,null,2.2494443758404,2.2494443758404,null,2.2494443758404,1.06301458127347,null,1.06301458127347,1.06301458127347,null,1.06301458127347,0.640312423743285,null,0.640312423743285,0.640312423743285,null,0.640312423743285,0,null,0.640312423743285,0.640312423743285,null,0.640312423743285,0,null,1.06301458127347,1.06301458127347,null,1.06301458127347,0.92736184954957,null,0.92736184954957,0.92736184954957,null,0.92736184954957,0.316227766016838,null,0.316227766016838,0.316227766016838,null,0.316227766016838,0,null,0.316227766016838,0.316227766016838,null,0.316227766016838,0,null,0.92736184954957,0.92736184954957,null,0.92736184954957,0.53851648071345,null,0.53851648071345,0.53851648071345,null,0.53851648071345,0,null,0.53851648071345,0.53851648071345,null,0.53851648071345,0],"y":[12.55078125,3.609375,null,3.609375,3.609375,null,3.609375,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,3.609375,5.71875,null,5.71875,5.71875,null,5.71875,3.75,null,3.75,3.75,null,3.75,3,null,3,3,null,3.75,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,5.71875,7.6875,null,7.6875,7.6875,null,7.6875,6.5,null,6.5,6.5,null,6.5,6,null,6,6,null,6.5,7,null,7,7,null,7.6875,8.875,null,8.875,8.875,null,8.875,8,null,8,8,null,8.875,9.75,null,9.75,9.75,null,9.75,9,null,9,9,null,9.75,10.5,null,10.5,10.5,null,10.5,10,null,10,10,null,10.5,11,null,11,11,null,12.55078125,21.4921875,null,21.4921875,21.4921875,null,21.4921875,13.859375,null,13.859375,13.859375,null,13.859375,12,null,12,12,null,13.859375,15.71875,null,15.71875,15.71875,null,15.71875,13,null,13,13,null,15.71875,18.4375,null,18.4375,18.4375,null,18.4375,15.625,null,15.625,15.625,null,15.625,14.5,null,14.5,14.5,null,14.5,14,null,14,14,null,14.5,15,null,15,15,null,15.625,16.75,null,16.75,16.75,null,16.75,16,null,16,16,null,16.75,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,18.4375,21.25,null,21.25,21.25,null,21.25,19.75,null,19.75,19.75,null,19.75,19,null,19,19,null,19.75,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,21.25,22.75,null,22.75,22.75,null,22.75,22,null,22,22,null,22.75,23.5,null,23.5,23.5,null,23.5,23,null,23,23,null,23.5,24,null,24,24,null,21.4921875,29.125,null,29.125,29.125,null,29.125,26.25,null,26.25,26.25,null,26.25,25,null,25,25,null,26.25,27.5,null,27.5,27.5,null,27.5,26.5,null,26.5,26.5,null,26.5,26,null,26,26,null,26.5,27,null,27,27,null,27.5,28.5,null,28.5,28.5,null,28.5,28,null,28,28,null,28.5,29,null,29,29,null,29.125,32,null,32,32,null,32,30.5,null,30.5,30.5,null,30.5,30,null,30,30,null,30.5,31,null,31,31,null,32,33.5,null,33.5,33.5,null,33.5,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33,null,33.5,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[3],[3],[2],[3],[3],[3],[3],[3],[3],[3],[3],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[2],[3],[3],[2],[2],[2],[3]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 3"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 20"],["value: virginica<br>variable: Species<br>row: 34"],["value: setosa<br>variable: Species<br>row: 19"],["value: setosa<br>variable: Species<br>row: 17"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 21"],["value: virginica<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333333","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[2.8,6.7,2,7.7],[3.8,6.4,2,7.9],[2.8,4.8,1.4,6.8],[2.5,5.8,1.8,6.7],[3,5.8,1.6,7.2],[3.2,5.1,2,6.5],[3.1,5.1,2.3,6.9],[3.4,5.4,2.3,6.2],[2.8,5.6,2.1,6.4],[3.1,5.5,1.8,6.4],[3,5.5,1.8,6.5],[3,1.1,0.1,4.3],[4.2,1.4,0.2,5.5],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.9,1.7,0.4,5.4],[3.8,1.5,0.3,5.1],[3.7,1.5,0.2,5.4],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[3.5,1.4,0.3,5.1],[3.4,1.9,0.2,4.8],[3.3,1.7,0.5,5.1],[3.5,1.6,0.6,5],[2.5,3,1.1,5.1],[2.4,3.7,1,5.5],[2.4,3.8,1.1,5.5],[2.9,3.6,1.3,5.6],[2.7,3.9,1.2,5.8],[2.8,4.9,2,5.6],[2.8,4.8,1.8,6.2],[2.6,4.4,1.2,5.5],[2.8,4.5,1.3,5.7],[2.2,4.5,1.5,6.2],[2.2,5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 1<br>column: Sepal.Width<br>value: 2.8","row: 1<br>column: Petal.Length<br>value: 6.7","row: 1<br>column: Petal.Width<br>value: 2","row: 1<br>column: Sepal.Length<br>value: 7.7"],["row: 27<br>column: Sepal.Width<br>value: 3.8","row: 27<br>column: Petal.Length<br>value: 6.4","row: 27<br>column: Petal.Width<br>value: 2","row: 27<br>column: Sepal.Length<br>value: 7.9"],["row: 23<br>column: Sepal.Width<br>value: 2.8","row: 23<br>column: Petal.Length<br>value: 4.8","row: 23<br>column: Petal.Width<br>value: 1.4","row: 23<br>column: Sepal.Length<br>value: 6.8"],["row: 3<br>column: Sepal.Width<br>value: 2.5","row: 3<br>column: Petal.Length<br>value: 5.8","row: 3<br>column: Petal.Width<br>value: 1.8","row: 3<br>column: Sepal.Length<br>value: 6.7"],["row: 29<br>column: Sepal.Width<br>value: 3","row: 29<br>column: Petal.Length<br>value: 5.8","row: 29<br>column: Petal.Width<br>value: 1.6","row: 29<br>column: Sepal.Length<br>value: 7.2"],["row: 7<br>column: Sepal.Width<br>value: 3.2","row: 7<br>column: Petal.Length<br>value: 5.1","row: 7<br>column: Petal.Width<br>value: 2","row: 7<br>column: Sepal.Length<br>value: 6.5"],["row: 32<br>column: Sepal.Width<br>value: 3.1","row: 32<br>column: Petal.Length<br>value: 5.1","row: 32<br>column: Petal.Width<br>value: 2.3","row: 32<br>column: Sepal.Length<br>value: 6.9"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 5.4","row: 22<br>column: Petal.Width<br>value: 2.3","row: 22<br>column: Sepal.Length<br>value: 6.2"],["row: 10<br>column: Sepal.Width<br>value: 2.8","row: 10<br>column: Petal.Length<br>value: 5.6","row: 10<br>column: Petal.Width<br>value: 2.1","row: 10<br>column: Sepal.Length<br>value: 6.4"],["row: 20<br>column: Sepal.Width<br>value: 3.1","row: 20<br>column: Petal.Length<br>value: 5.5","row: 20<br>column: Petal.Width<br>value: 1.8","row: 20<br>column: Sepal.Length<br>value: 6.4"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 5.5","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6.5"],["row: 19<br>column: Sepal.Width<br>value: 3","row: 19<br>column: Petal.Length<br>value: 1.1","row: 19<br>column: Petal.Width<br>value: 0.1","row: 19<br>column: Sepal.Length<br>value: 4.3"],["row: 17<br>column: Sepal.Width<br>value: 4.2","row: 17<br>column: Petal.Length<br>value: 1.4","row: 17<br>column: Petal.Width<br>value: 0.2","row: 17<br>column: Sepal.Length<br>value: 5.5"],["row: 13<br>column: Sepal.Width<br>value: 3.4","row: 13<br>column: Petal.Length<br>value: 1.5","row: 13<br>column: Petal.Width<br>value: 0.4","row: 13<br>column: Sepal.Length<br>value: 5.4"],["row: 28<br>column: Sepal.Width<br>value: 3.4","row: 28<br>column: Petal.Length<br>value: 1.7","row: 28<br>column: Petal.Width<br>value: 0.2","row: 28<br>column: Sepal.Length<br>value: 5.4"],["row: 26<br>column: Sepal.Width<br>value: 3.9","row: 26<br>column: Petal.Length<br>value: 1.7","row: 26<br>column: Petal.Width<br>value: 0.4","row: 26<br>column: Sepal.Length<br>value: 5.4"],["row: 2<br>column: Sepal.Width<br>value: 3.8","row: 2<br>column: Petal.Length<br>value: 1.5","row: 2<br>column: Petal.Width<br>value: 0.3","row: 2<br>column: Sepal.Length<br>value: 5.1"],["row: 31<br>column: Sepal.Width<br>value: 3.7","row: 31<br>column: Petal.Length<br>value: 1.5","row: 31<br>column: Petal.Width<br>value: 0.2","row: 31<br>column: Sepal.Length<br>value: 5.4"],["row: 33<br>column: Sepal.Width<br>value: 3.6","row: 33<br>column: Petal.Length<br>value: 1.4","row: 33<br>column: Petal.Width<br>value: 0.1","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 18<br>column: Sepal.Width<br>value: 3.5","row: 18<br>column: Petal.Length<br>value: 1.3","row: 18<br>column: Petal.Width<br>value: 0.3","row: 18<br>column: Sepal.Length<br>value: 5"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.4","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5.1"],["row: 6<br>column: Sepal.Width<br>value: 3.4","row: 6<br>column: Petal.Length<br>value: 1.9","row: 6<br>column: Petal.Width<br>value: 0.2","row: 6<br>column: Sepal.Length<br>value: 4.8"],["row: 12<br>column: Sepal.Width<br>value: 3.3","row: 12<br>column: Petal.Length<br>value: 1.7","row: 12<br>column: Petal.Width<br>value: 0.5","row: 12<br>column: Sepal.Length<br>value: 5.1"],["row: 11<br>column: Sepal.Width<br>value: 3.5","row: 11<br>column: Petal.Length<br>value: 1.6","row: 11<br>column: Petal.Width<br>value: 0.6","row: 11<br>column: Sepal.Length<br>value: 5"],["row: 30<br>column: Sepal.Width<br>value: 2.5","row: 30<br>column: Petal.Length<br>value: 3","row: 30<br>column: Petal.Width<br>value: 1.1","row: 30<br>column: Sepal.Length<br>value: 5.1"],["row: 4<br>column: Sepal.Width<br>value: 2.4","row: 4<br>column: Petal.Length<br>value: 3.7","row: 4<br>column: Petal.Width<br>value: 1","row: 4<br>column: Sepal.Length<br>value: 5.5"],["row: 15<br>column: Sepal.Width<br>value: 2.4","row: 15<br>column: Petal.Length<br>value: 3.8","row: 15<br>column: Petal.Width<br>value: 1.1","row: 15<br>column: Sepal.Length<br>value: 5.5"],["row: 9<br>column: Sepal.Width<br>value: 2.9","row: 9<br>column: Petal.Length<br>value: 3.6","row: 9<br>column: Petal.Width<br>value: 1.3","row: 9<br>column: Sepal.Length<br>value: 5.6"],["row: 8<br>column: Sepal.Width<br>value: 2.7","row: 8<br>column: Petal.Length<br>value: 3.9","row: 8<br>column: Petal.Width<br>value: 1.2","row: 8<br>column: Sepal.Length<br>value: 5.8"],["row: 21<br>column: Sepal.Width<br>value: 2.8","row: 21<br>column: Petal.Length<br>value: 4.9","row: 21<br>column: Petal.Width<br>value: 2","row: 21<br>column: Sepal.Length<br>value: 5.6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4.8","row: 16<br>column: Petal.Width<br>value: 1.8","row: 16<br>column: Sepal.Length<br>value: 6.2"],["row: 35<br>column: Sepal.Width<br>value: 2.6","row: 35<br>column: Petal.Length<br>value: 4.4","row: 35<br>column: Petal.Width<br>value: 1.2","row: 35<br>column: Sepal.Length<br>value: 5.5"],["row: 5<br>column: Sepal.Width<br>value: 2.8","row: 5<br>column: Petal.Length<br>value: 4.5","row: 5<br>column: Petal.Width<br>value: 1.3","row: 5<br>column: Sepal.Length<br>value: 5.7"],["row: 25<br>column: Sepal.Width<br>value: 2.2","row: 25<br>column: Petal.Length<br>value: 4.5","row: 25<br>column: Petal.Width<br>value: 1.5","row: 25<br>column: Sepal.Length<br>value: 6.2"],["row: 14<br>column: Sepal.Width<br>value: 2.2","row: 14<br>column: Petal.Length<br>value: 5","row: 14<br>column: Petal.Width<br>value: 1.5","row: 14<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,6.82422156732913],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Petal.Length","Petal.Width","Sepal.Length"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["1","27","23","3","29","7","32","22","10","20","34","19","17","13","28","26","2","31","33","18","24","6","12","11","30","4","15","9","8","21","16","35","5","25","14"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,27.9402934845001],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"2682628d323c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"2682377aad4f":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"2682570839fd":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"268220d29a41":{"z":[[3],[3],[2],[3],[3],[3],[3],[3],[3],[3],[3],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[2],[3],[3],[2],[2],[2],[3]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 27"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 3"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 20"],["value: virginica<br>variable: Species<br>row: 34"],["value: setosa<br>variable: Species<br>row: 19"],["value: setosa<br>variable: Species<br>row: 17"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 9"],["value: versicolor<br>variable: Species<br>row: 8"],["value: virginica<br>variable: Species<br>row: 21"],["value: virginica<br>variable: Species<br>row: 16"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"26825d173dae":{"z":[[2.8,6.7,2,7.7],[3.8,6.4,2,7.9],[2.8,4.8,1.4,6.8],[2.5,5.8,1.8,6.7],[3,5.8,1.6,7.2],[3.2,5.1,2,6.5],[3.1,5.1,2.3,6.9],[3.4,5.4,2.3,6.2],[2.8,5.6,2.1,6.4],[3.1,5.5,1.8,6.4],[3,5.5,1.8,6.5],[3,1.1,0.1,4.3],[4.2,1.4,0.2,5.5],[3.4,1.5,0.4,5.4],[3.4,1.7,0.2,5.4],[3.9,1.7,0.4,5.4],[3.8,1.5,0.3,5.1],[3.7,1.5,0.2,5.4],[3.6,1.4,0.1,4.9],[3.5,1.3,0.3,5],[3.5,1.4,0.3,5.1],[3.4,1.9,0.2,4.8],[3.3,1.7,0.5,5.1],[3.5,1.6,0.6,5],[2.5,3,1.1,5.1],[2.4,3.7,1,5.5],[2.4,3.8,1.1,5.5],[2.9,3.6,1.3,5.6],[2.7,3.9,1.2,5.8],[2.8,4.9,2,5.6],[2.8,4.8,1.8,6.2],[2.6,4.4,1.2,5.5],[2.8,4.5,1.3,5.7],[2.2,4.5,1.5,6.2],[2.2,5,1.5,6]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 1<br>column: Sepal.Width<br>value: 2.8","row: 1<br>column: Petal.Length<br>value: 6.7","row: 1<br>column: Petal.Width<br>value: 2","row: 1<br>column: Sepal.Length<br>value: 7.7"],["row: 27<br>column: Sepal.Width<br>value: 3.8","row: 27<br>column: Petal.Length<br>value: 6.4","row: 27<br>column: Petal.Width<br>value: 2","row: 27<br>column: Sepal.Length<br>value: 7.9"],["row: 23<br>column: Sepal.Width<br>value: 2.8","row: 23<br>column: Petal.Length<br>value: 4.8","row: 23<br>column: Petal.Width<br>value: 1.4","row: 23<br>column: Sepal.Length<br>value: 6.8"],["row: 3<br>column: Sepal.Width<br>value: 2.5","row: 3<br>column: Petal.Length<br>value: 5.8","row: 3<br>column: Petal.Width<br>value: 1.8","row: 3<br>column: Sepal.Length<br>value: 6.7"],["row: 29<br>column: Sepal.Width<br>value: 3","row: 29<br>column: Petal.Length<br>value: 5.8","row: 29<br>column: Petal.Width<br>value: 1.6","row: 29<br>column: Sepal.Length<br>value: 7.2"],["row: 7<br>column: Sepal.Width<br>value: 3.2","row: 7<br>column: Petal.Length<br>value: 5.1","row: 7<br>column: Petal.Width<br>value: 2","row: 7<br>column: Sepal.Length<br>value: 6.5"],["row: 32<br>column: Sepal.Width<br>value: 3.1","row: 32<br>column: Petal.Length<br>value: 5.1","row: 32<br>column: Petal.Width<br>value: 2.3","row: 32<br>column: Sepal.Length<br>value: 6.9"],["row: 22<br>column: Sepal.Width<br>value: 3.4","row: 22<br>column: Petal.Length<br>value: 5.4","row: 22<br>column: Petal.Width<br>value: 2.3","row: 22<br>column: Sepal.Length<br>value: 6.2"],["row: 10<br>column: Sepal.Width<br>value: 2.8","row: 10<br>column: Petal.Length<br>value: 5.6","row: 10<br>column: Petal.Width<br>value: 2.1","row: 10<br>column: Sepal.Length<br>value: 6.4"],["row: 20<br>column: Sepal.Width<br>value: 3.1","row: 20<br>column: Petal.Length<br>value: 5.5","row: 20<br>column: Petal.Width<br>value: 1.8","row: 20<br>column: Sepal.Length<br>value: 6.4"],["row: 34<br>column: Sepal.Width<br>value: 3","row: 34<br>column: Petal.Length<br>value: 5.5","row: 34<br>column: Petal.Width<br>value: 1.8","row: 34<br>column: Sepal.Length<br>value: 6.5"],["row: 19<br>column: Sepal.Width<br>value: 3","row: 19<br>column: Petal.Length<br>value: 1.1","row: 19<br>column: Petal.Width<br>value: 0.1","row: 19<br>column: Sepal.Length<br>value: 4.3"],["row: 17<br>column: Sepal.Width<br>value: 4.2","row: 17<br>column: Petal.Length<br>value: 1.4","row: 17<br>column: Petal.Width<br>value: 0.2","row: 17<br>column: Sepal.Length<br>value: 5.5"],["row: 13<br>column: Sepal.Width<br>value: 3.4","row: 13<br>column: Petal.Length<br>value: 1.5","row: 13<br>column: Petal.Width<br>value: 0.4","row: 13<br>column: Sepal.Length<br>value: 5.4"],["row: 28<br>column: Sepal.Width<br>value: 3.4","row: 28<br>column: Petal.Length<br>value: 1.7","row: 28<br>column: Petal.Width<br>value: 0.2","row: 28<br>column: Sepal.Length<br>value: 5.4"],["row: 26<br>column: Sepal.Width<br>value: 3.9","row: 26<br>column: Petal.Length<br>value: 1.7","row: 26<br>column: Petal.Width<br>value: 0.4","row: 26<br>column: Sepal.Length<br>value: 5.4"],["row: 2<br>column: Sepal.Width<br>value: 3.8","row: 2<br>column: Petal.Length<br>value: 1.5","row: 2<br>column: Petal.Width<br>value: 0.3","row: 2<br>column: Sepal.Length<br>value: 5.1"],["row: 31<br>column: Sepal.Width<br>value: 3.7","row: 31<br>column: Petal.Length<br>value: 1.5","row: 31<br>column: Petal.Width<br>value: 0.2","row: 31<br>column: Sepal.Length<br>value: 5.4"],["row: 33<br>column: Sepal.Width<br>value: 3.6","row: 33<br>column: Petal.Length<br>value: 1.4","row: 33<br>column: Petal.Width<br>value: 0.1","row: 33<br>column: Sepal.Length<br>value: 4.9"],["row: 18<br>column: Sepal.Width<br>value: 3.5","row: 18<br>column: Petal.Length<br>value: 1.3","row: 18<br>column: Petal.Width<br>value: 0.3","row: 18<br>column: Sepal.Length<br>value: 5"],["row: 24<br>column: Sepal.Width<br>value: 3.5","row: 24<br>column: Petal.Length<br>value: 1.4","row: 24<br>column: Petal.Width<br>value: 0.3","row: 24<br>column: Sepal.Length<br>value: 5.1"],["row: 6<br>column: Sepal.Width<br>value: 3.4","row: 6<br>column: Petal.Length<br>value: 1.9","row: 6<br>column: Petal.Width<br>value: 0.2","row: 6<br>column: Sepal.Length<br>value: 4.8"],["row: 12<br>column: Sepal.Width<br>value: 3.3","row: 12<br>column: Petal.Length<br>value: 1.7","row: 12<br>column: Petal.Width<br>value: 0.5","row: 12<br>column: Sepal.Length<br>value: 5.1"],["row: 11<br>column: Sepal.Width<br>value: 3.5","row: 11<br>column: Petal.Length<br>value: 1.6","row: 11<br>column: Petal.Width<br>value: 0.6","row: 11<br>column: Sepal.Length<br>value: 5"],["row: 30<br>column: Sepal.Width<br>value: 2.5","row: 30<br>column: Petal.Length<br>value: 3","row: 30<br>column: Petal.Width<br>value: 1.1","row: 30<br>column: Sepal.Length<br>value: 5.1"],["row: 4<br>column: Sepal.Width<br>value: 2.4","row: 4<br>column: Petal.Length<br>value: 3.7","row: 4<br>column: Petal.Width<br>value: 1","row: 4<br>column: Sepal.Length<br>value: 5.5"],["row: 15<br>column: Sepal.Width<br>value: 2.4","row: 15<br>column: Petal.Length<br>value: 3.8","row: 15<br>column: Petal.Width<br>value: 1.1","row: 15<br>column: Sepal.Length<br>value: 5.5"],["row: 9<br>column: Sepal.Width<br>value: 2.9","row: 9<br>column: Petal.Length<br>value: 3.6","row: 9<br>column: Petal.Width<br>value: 1.3","row: 9<br>column: Sepal.Length<br>value: 5.6"],["row: 8<br>column: Sepal.Width<br>value: 2.7","row: 8<br>column: Petal.Length<br>value: 3.9","row: 8<br>column: Petal.Width<br>value: 1.2","row: 8<br>column: Sepal.Length<br>value: 5.8"],["row: 21<br>column: Sepal.Width<br>value: 2.8","row: 21<br>column: Petal.Length<br>value: 4.9","row: 21<br>column: Petal.Width<br>value: 2","row: 21<br>column: Sepal.Length<br>value: 5.6"],["row: 16<br>column: Sepal.Width<br>value: 2.8","row: 16<br>column: Petal.Length<br>value: 4.8","row: 16<br>column: Petal.Width<br>value: 1.8","row: 16<br>column: Sepal.Length<br>value: 6.2"],["row: 35<br>column: Sepal.Width<br>value: 2.6","row: 35<br>column: Petal.Length<br>value: 4.4","row: 35<br>column: Petal.Width<br>value: 1.2","row: 35<br>column: Sepal.Length<br>value: 5.5"],["row: 5<br>column: Sepal.Width<br>value: 2.8","row: 5<br>column: Petal.Length<br>value: 4.5","row: 5<br>column: Petal.Width<br>value: 1.3","row: 5<br>column: Sepal.Length<br>value: 5.7"],["row: 25<br>column: Sepal.Width<br>value: 2.2","row: 25<br>column: Petal.Length<br>value: 4.5","row: 25<br>column: Petal.Width<br>value: 1.5","row: 25<br>column: Sepal.Length<br>value: 6.2"],["row: 14<br>column: Sepal.Width<br>value: 2.2","row: 14<br>column: Petal.Length<br>value: 5","row: 14<br>column: Petal.Width<br>value: 1.5","row: 14<br>column: Sepal.Length<br>value: 6"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---


# Visualización previa


Podemos mejorar la representación **estandarizando** las variables.


```r
heatmaply(iris_sample %&gt;%  mutate(across(where(is.numeric), ~scale(.))),
          seriate = "mean", row_dend_left = TRUE, plot_method = "plotly")
```

---


# Visualización previa

<div id="htmlwidget-265e144c418a004f321f" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-265e144c418a004f321f">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[10.2091627919783,10.2091627919783,null,10.2091627919783,0,null,10.2091627919783,10.2091627919783,null,10.2091627919783,3.6408835660283,null,3.6408835660283,3.6408835660283,null,3.6408835660283,0,null,3.6408835660283,3.6408835660283,null,3.6408835660283,1.80204943391697,null,1.80204943391697,1.80204943391697,null,1.80204943391697,0,null,1.80204943391697,1.80204943391697,null,1.80204943391697,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[6.02783922999824,6.02783922999824,null,6.02783922999824,2.78841160698492,null,2.78841160698492,2.78841160698492,null,2.78841160698492,1.60855984757349,null,1.60855984757349,1.60855984757349,null,1.60855984757349,0.855307835278113,null,0.855307835278113,0.855307835278113,null,0.855307835278113,0.515198829112034,null,0.515198829112034,0.515198829112034,null,0.515198829112034,0.412683733835268,null,0.412683733835268,0.412683733835268,null,0.412683733835268,0.13212532287257,null,0.13212532287257,0.13212532287257,null,0.13212532287257,0,null,0.13212532287257,0.13212532287257,null,0.13212532287257,0,null,0.412683733835268,0.412683733835268,null,0.412683733835268,0,null,0.515198829112034,0.515198829112034,null,0.515198829112034,0,null,0.855307835278113,0.855307835278113,null,0.855307835278113,0.752671445517315,null,0.752671445517315,0.752671445517315,null,0.752671445517315,0.439071698850558,null,0.439071698850558,0.439071698850558,null,0.439071698850558,0,null,0.439071698850558,0.439071698850558,null,0.439071698850558,0,null,0.752671445517315,0.752671445517315,null,0.752671445517315,0.292312729024265,null,0.292312729024265,0.292312729024265,null,0.292312729024265,0,null,0.292312729024265,0.292312729024265,null,0.292312729024265,0,null,1.60855984757349,1.60855984757349,null,1.60855984757349,0,null,2.78841160698492,2.78841160698492,null,2.78841160698492,0.99932858892792,null,0.99932858892792,0.99932858892792,null,0.99932858892792,0.492380763213116,null,0.492380763213116,0.492380763213116,null,0.492380763213116,0.432960156556397,null,0.432960156556397,0.432960156556397,null,0.432960156556397,0,null,0.432960156556397,0.432960156556397,null,0.432960156556397,0,null,0.492380763213116,0.492380763213116,null,0.492380763213116,0,null,0.99932858892792,0.99932858892792,null,0.99932858892792,0,null,6.02783922999824,6.02783922999824,null,6.02783922999824,4.78857079695404,null,4.78857079695404,4.78857079695404,null,4.78857079695404,1.81433692249223,null,1.81433692249223,1.81433692249223,null,1.81433692249223,0.681067830534425,null,0.681067830534425,0.681067830534425,null,0.681067830534425,0.146156364512133,null,0.146156364512133,0.146156364512133,null,0.146156364512133,0,null,0.146156364512133,0.146156364512133,null,0.146156364512133,0,null,0.681067830534425,0.681067830534425,null,0.681067830534425,0,null,1.81433692249223,1.81433692249223,null,1.81433692249223,1.67947902955883,null,1.67947902955883,1.67947902955883,null,1.67947902955883,1.25422697257231,null,1.25422697257231,1.25422697257231,null,1.25422697257231,0.761393123713376,null,0.761393123713376,0.761393123713376,null,0.761393123713376,0.494765110057698,null,0.494765110057698,0.494765110057698,null,0.494765110057698,0,null,0.494765110057698,0.494765110057698,null,0.494765110057698,0.425419554151583,null,0.425419554151583,0.425419554151583,null,0.425419554151583,0,null,0.425419554151583,0.425419554151583,null,0.425419554151583,0,null,0.761393123713376,0.761393123713376,null,0.761393123713376,0,null,1.25422697257231,1.25422697257231,null,1.25422697257231,0,null,1.67947902955883,1.67947902955883,null,1.67947902955883,0.365230811905647,null,0.365230811905647,0.365230811905647,null,0.365230811905647,0,null,0.365230811905647,0.365230811905647,null,0.365230811905647,0,null,4.78857079695404,4.78857079695404,null,4.78857079695404,2.99054431308462,null,2.99054431308462,2.99054431308462,null,2.99054431308462,0,null,2.99054431308462,2.99054431308462,null,2.99054431308462,2.31003947340531,null,2.31003947340531,2.31003947340531,null,2.31003947340531,1.7092724108302,null,1.7092724108302,1.7092724108302,null,1.7092724108302,0,null,1.7092724108302,1.7092724108302,null,1.7092724108302,1.18966144276756,null,1.18966144276756,1.18966144276756,null,1.18966144276756,0,null,1.18966144276756,1.18966144276756,null,1.18966144276756,0.874016792580219,null,0.874016792580219,0.874016792580219,null,0.874016792580219,0,null,0.874016792580219,0.874016792580219,null,0.874016792580219,0,null,2.31003947340531,2.31003947340531,null,2.31003947340531,1.40721954894757,null,1.40721954894757,1.40721954894757,null,1.40721954894757,1.04285841557088,null,1.04285841557088,1.04285841557088,null,1.04285841557088,0,null,1.04285841557088,1.04285841557088,null,1.04285841557088,0,null,1.40721954894757,1.40721954894757,null,1.40721954894757,0.926510297647558,null,0.926510297647558,0.926510297647558,null,0.926510297647558,0.645334051430348,null,0.645334051430348,0.645334051430348,null,0.645334051430348,0,null,0.645334051430348,0.645334051430348,null,0.645334051430348,0,null,0.926510297647558,0.926510297647558,null,0.926510297647558,0.527978933647716,null,0.527978933647716,0.527978933647716,null,0.527978933647716,0,null,0.527978933647716,0.527978933647716,null,0.527978933647716,0.231685585480783,null,0.231685585480783,0.231685585480783,null,0.231685585480783,0,null,0.231685585480783,0.231685585480783,null,0.231685585480783,0],"y":[15.875,9.515625,null,9.515625,9.515625,null,9.515625,6.90625,null,6.90625,6.90625,null,6.90625,4.8125,null,4.8125,4.8125,null,4.8125,3.125,null,3.125,3.125,null,3.125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,3.125,4,null,4,4,null,4.8125,6.5,null,6.5,6.5,null,6.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,6.90625,9,null,9,9,null,9.515625,12.125,null,12.125,12.125,null,12.125,11.25,null,11.25,11.25,null,11.25,10.5,null,10.5,10.5,null,10.5,10,null,10,10,null,10.5,11,null,11,11,null,11.25,12,null,12,12,null,12.125,13,null,13,13,null,15.875,22.234375,null,22.234375,22.234375,null,22.234375,18.234375,null,18.234375,18.234375,null,18.234375,15.25,null,15.25,15.25,null,15.25,14.5,null,14.5,14.5,null,14.5,14,null,14,14,null,14.5,15,null,15,15,null,15.25,16,null,16,16,null,18.234375,21.21875,null,21.21875,21.21875,null,21.21875,19.9375,null,19.9375,19.9375,null,19.9375,18.875,null,18.875,18.875,null,18.875,17.75,null,17.75,17.75,null,17.75,17,null,17,17,null,17.75,18.5,null,18.5,18.5,null,18.5,18,null,18,18,null,18.5,19,null,19,19,null,18.875,20,null,20,20,null,19.9375,21,null,21,21,null,21.21875,22.5,null,22.5,22.5,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,22.234375,26.234375,null,26.234375,26.234375,null,26.234375,24,null,24,24,null,26.234375,28.46875,null,28.46875,28.46875,null,28.46875,25.875,null,25.875,25.875,null,25.875,25,null,25,25,null,25.875,26.75,null,26.75,26.75,null,26.75,26,null,26,26,null,26.75,27.5,null,27.5,27.5,null,27.5,27,null,27,27,null,27.5,28,null,28,28,null,28.46875,31.0625,null,31.0625,31.0625,null,31.0625,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,31.0625,32.625,null,32.625,32.625,null,32.625,31.5,null,31.5,31.5,null,31.5,31,null,31,31,null,31.5,32,null,32,32,null,32.625,33.75,null,33.75,33.75,null,33.75,33,null,33,33,null,33.75,34.5,null,34.5,34.5,null,34.5,34,null,34,34,null,34.5,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[2],[2],[2],[3],[2],[3],[3],[3],[3],[2],[3],[3],[3],[3],[3],[3],[3],[3]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 19"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 17"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 21"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"],["value: virginica<br>variable: Species<br>row: 27"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 16"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 20"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333334","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[0.820746123365793,-1.00562391265171,-1.13740998183668,-1.28897849593253],[0.820746123365793,-0.885498189297411,-1.13740998183668,-1.23396112110614],[1.01885725659202,-1.12574963600601,-1.40822188227398,-1.23396112110614],[0.622634990139567,-1.24587535936031,-1.27281593205533,-0.958874246974196],[0.424523856913341,-0.885498189297411,-0.866598081399372,-1.06890899662697],[0.820746123365793,-1.00562391265171,-0.73119213118072,-1.12392637145336],[0.622634990139567,-0.52512101923451,-1.27281593205533,-1.06890899662697],[0.622634990139567,-0.52512101923451,-1.00200403161802,-1.17894374627975],[-0.169809542765337,-1.84650397613181,-1.40822188227398,-1.3990132455853],[1.41507952304447,-0.885498189297411,-1.13740998183668,-1.17894374627975],[1.21696838981824,-0.52512101923451,-1.27281593205533,-1.17894374627975],[1.6131906562707,-0.52512101923451,-1.00200403161802,-1.06890899662697],[2.20752405594937,-0.404995295880211,-1.27281593205533,-1.23396112110614],[-1.35847634212269,-0.404995295880211,-0.189568330306113,0.0314384999007934],[-1.35847634212269,-0.404995295880211,-0.0541623800874605,0.0864558747271815],[-1.16036520889647,-0.885498189297411,-0.0541623800874605,-0.353683123883925],[-0.96225407567024,-0.404995295880211,0.0812435701311912,0.416560123685511],[-0.764142942444014,-0.0446181258173116,0.0812435701311912,0.14147324955357],[-0.566031809217789,-0.164743849171611,0.216649520349843,0.4715774985119],[-0.367920675991563,-0.284869572525912,0.216649520349843,-0.0235788749255949],[-0.566031809217789,-0.284869572525912,1.16449117188041,0.691646997817453],[-1.75469860857514,0.435884767599888,0.487461420787147,0.4715774985119],[-1.75469860857514,0.195633320891288,0.487461420787147,0.746664372643841],[1.41507952304447,2.47802206462299,1.16449117188041,1.51690762021328],[-0.566031809217789,2.23777061791439,1.16449117188041,1.68195974469244],[-1.16036520889647,1.03651338437139,0.893679271443103,1.18680337125495],[-0.566031809217789,1.15663910772569,0.352055470568495,0.636629622991064],[-0.169809542765337,1.63714200114289,0.622867371005799,1.18680337125495],[0.622634990139567,0.435884767599888,1.57070902253636,0.966733871949394],[0.0283015904608893,1.27676483107999,1.57070902253636,0.801681747470229],[-0.566031809217789,0.435884767599888,0.893679271443103,0.636629622991064],[-0.566031809217789,0.676136214308488,1.29989712209906,1.07676862160217],[0.226412723687115,0.796261937662788,1.16449117188041,0.801681747470229],[-0.169809542765337,0.796261937662788,0.893679271443103,1.02175124677578],[0.0283015904608893,0.676136214308488,0.893679271443103,1.02175124677578]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 18<br>column: Sepal.Width<br>value: 0.820746123365793","row: 18<br>column: Sepal.Length<br>value: -1.00562391265171","row: 18<br>column: Petal.Width<br>value: -1.13740998183668","row: 18<br>column: Petal.Length<br>value: -1.28897849593253"],["row: 24<br>column: Sepal.Width<br>value: 0.820746123365793","row: 24<br>column: Sepal.Length<br>value: -0.885498189297411","row: 24<br>column: Petal.Width<br>value: -1.13740998183668","row: 24<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 33<br>column: Sepal.Width<br>value: 1.01885725659202","row: 33<br>column: Sepal.Length<br>value: -1.12574963600601","row: 33<br>column: Petal.Width<br>value: -1.40822188227398","row: 33<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 6<br>column: Sepal.Width<br>value: 0.622634990139567","row: 6<br>column: Sepal.Length<br>value: -1.24587535936031","row: 6<br>column: Petal.Width<br>value: -1.27281593205533","row: 6<br>column: Petal.Length<br>value: -0.958874246974196"],["row: 12<br>column: Sepal.Width<br>value: 0.424523856913341","row: 12<br>column: Sepal.Length<br>value: -0.885498189297411","row: 12<br>column: Petal.Width<br>value: -0.866598081399372","row: 12<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 11<br>column: Sepal.Width<br>value: 0.820746123365793","row: 11<br>column: Sepal.Length<br>value: -1.00562391265171","row: 11<br>column: Petal.Width<br>value: -0.73119213118072","row: 11<br>column: Petal.Length<br>value: -1.12392637145336"],["row: 28<br>column: Sepal.Width<br>value: 0.622634990139567","row: 28<br>column: Sepal.Length<br>value: -0.52512101923451","row: 28<br>column: Petal.Width<br>value: -1.27281593205533","row: 28<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 13<br>column: Sepal.Width<br>value: 0.622634990139567","row: 13<br>column: Sepal.Length<br>value: -0.52512101923451","row: 13<br>column: Petal.Width<br>value: -1.00200403161802","row: 13<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 19<br>column: Sepal.Width<br>value: -0.169809542765337","row: 19<br>column: Sepal.Length<br>value: -1.84650397613181","row: 19<br>column: Petal.Width<br>value: -1.40822188227398","row: 19<br>column: Petal.Length<br>value: -1.3990132455853"],["row: 2<br>column: Sepal.Width<br>value: 1.41507952304447","row: 2<br>column: Sepal.Length<br>value: -0.885498189297411","row: 2<br>column: Petal.Width<br>value: -1.13740998183668","row: 2<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 31<br>column: Sepal.Width<br>value: 1.21696838981824","row: 31<br>column: Sepal.Length<br>value: -0.52512101923451","row: 31<br>column: Petal.Width<br>value: -1.27281593205533","row: 31<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 26<br>column: Sepal.Width<br>value: 1.6131906562707","row: 26<br>column: Sepal.Length<br>value: -0.52512101923451","row: 26<br>column: Petal.Width<br>value: -1.00200403161802","row: 26<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 17<br>column: Sepal.Width<br>value: 2.20752405594937","row: 17<br>column: Sepal.Length<br>value: -0.404995295880211","row: 17<br>column: Petal.Width<br>value: -1.27281593205533","row: 17<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 4<br>column: Sepal.Width<br>value: -1.35847634212269","row: 4<br>column: Sepal.Length<br>value: -0.404995295880211","row: 4<br>column: Petal.Width<br>value: -0.189568330306113","row: 4<br>column: Petal.Length<br>value: 0.0314384999007934"],["row: 15<br>column: Sepal.Width<br>value: -1.35847634212269","row: 15<br>column: Sepal.Length<br>value: -0.404995295880211","row: 15<br>column: Petal.Width<br>value: -0.0541623800874605","row: 15<br>column: Petal.Length<br>value: 0.0864558747271815"],["row: 30<br>column: Sepal.Width<br>value: -1.16036520889647","row: 30<br>column: Sepal.Length<br>value: -0.885498189297411","row: 30<br>column: Petal.Width<br>value: -0.0541623800874605","row: 30<br>column: Petal.Length<br>value: -0.353683123883925"],["row: 35<br>column: Sepal.Width<br>value: -0.96225407567024","row: 35<br>column: Sepal.Length<br>value: -0.404995295880211","row: 35<br>column: Petal.Width<br>value: 0.0812435701311912","row: 35<br>column: Petal.Length<br>value: 0.416560123685511"],["row: 8<br>column: Sepal.Width<br>value: -0.764142942444014","row: 8<br>column: Sepal.Length<br>value: -0.0446181258173116","row: 8<br>column: Petal.Width<br>value: 0.0812435701311912","row: 8<br>column: Petal.Length<br>value: 0.14147324955357"],["row: 5<br>column: Sepal.Width<br>value: -0.566031809217789","row: 5<br>column: Sepal.Length<br>value: -0.164743849171611","row: 5<br>column: Petal.Width<br>value: 0.216649520349843","row: 5<br>column: Petal.Length<br>value: 0.4715774985119"],["row: 9<br>column: Sepal.Width<br>value: -0.367920675991563","row: 9<br>column: Sepal.Length<br>value: -0.284869572525912","row: 9<br>column: Petal.Width<br>value: 0.216649520349843","row: 9<br>column: Petal.Length<br>value: -0.0235788749255949"],["row: 21<br>column: Sepal.Width<br>value: -0.566031809217789","row: 21<br>column: Sepal.Length<br>value: -0.284869572525912","row: 21<br>column: Petal.Width<br>value: 1.16449117188041","row: 21<br>column: Petal.Length<br>value: 0.691646997817453"],["row: 25<br>column: Sepal.Width<br>value: -1.75469860857514","row: 25<br>column: Sepal.Length<br>value: 0.435884767599888","row: 25<br>column: Petal.Width<br>value: 0.487461420787147","row: 25<br>column: Petal.Length<br>value: 0.4715774985119"],["row: 14<br>column: Sepal.Width<br>value: -1.75469860857514","row: 14<br>column: Sepal.Length<br>value: 0.195633320891288","row: 14<br>column: Petal.Width<br>value: 0.487461420787147","row: 14<br>column: Petal.Length<br>value: 0.746664372643841"],["row: 27<br>column: Sepal.Width<br>value: 1.41507952304447","row: 27<br>column: Sepal.Length<br>value: 2.47802206462299","row: 27<br>column: Petal.Width<br>value: 1.16449117188041","row: 27<br>column: Petal.Length<br>value: 1.51690762021328"],["row: 1<br>column: Sepal.Width<br>value: -0.566031809217789","row: 1<br>column: Sepal.Length<br>value: 2.23777061791439","row: 1<br>column: Petal.Width<br>value: 1.16449117188041","row: 1<br>column: Petal.Length<br>value: 1.68195974469244"],["row: 3<br>column: Sepal.Width<br>value: -1.16036520889647","row: 3<br>column: Sepal.Length<br>value: 1.03651338437139","row: 3<br>column: Petal.Width<br>value: 0.893679271443103","row: 3<br>column: Petal.Length<br>value: 1.18680337125495"],["row: 23<br>column: Sepal.Width<br>value: -0.566031809217789","row: 23<br>column: Sepal.Length<br>value: 1.15663910772569","row: 23<br>column: Petal.Width<br>value: 0.352055470568495","row: 23<br>column: Petal.Length<br>value: 0.636629622991064"],["row: 29<br>column: Sepal.Width<br>value: -0.169809542765337","row: 29<br>column: Sepal.Length<br>value: 1.63714200114289","row: 29<br>column: Petal.Width<br>value: 0.622867371005799","row: 29<br>column: Petal.Length<br>value: 1.18680337125495"],["row: 22<br>column: Sepal.Width<br>value: 0.622634990139567","row: 22<br>column: Sepal.Length<br>value: 0.435884767599888","row: 22<br>column: Petal.Width<br>value: 1.57070902253636","row: 22<br>column: Petal.Length<br>value: 0.966733871949394"],["row: 32<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 32<br>column: Sepal.Length<br>value: 1.27676483107999","row: 32<br>column: Petal.Width<br>value: 1.57070902253636","row: 32<br>column: Petal.Length<br>value: 0.801681747470229"],["row: 16<br>column: Sepal.Width<br>value: -0.566031809217789","row: 16<br>column: Sepal.Length<br>value: 0.435884767599888","row: 16<br>column: Petal.Width<br>value: 0.893679271443103","row: 16<br>column: Petal.Length<br>value: 0.636629622991064"],["row: 10<br>column: Sepal.Width<br>value: -0.566031809217789","row: 10<br>column: Sepal.Length<br>value: 0.676136214308488","row: 10<br>column: Petal.Width<br>value: 1.29989712209906","row: 10<br>column: Petal.Length<br>value: 1.07676862160217"],["row: 7<br>column: Sepal.Width<br>value: 0.226412723687115","row: 7<br>column: Sepal.Length<br>value: 0.796261937662788","row: 7<br>column: Petal.Width<br>value: 1.16449117188041","row: 7<br>column: Petal.Length<br>value: 0.801681747470229"],["row: 34<br>column: Sepal.Width<br>value: -0.169809542765337","row: 34<br>column: Sepal.Length<br>value: 0.796261937662788","row: 34<br>column: Petal.Width<br>value: 0.893679271443103","row: 34<br>column: Petal.Length<br>value: 1.02175124677578"],["row: 20<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 20<br>column: Sepal.Length<br>value: 0.676136214308488","row: 20<br>column: Petal.Width<br>value: 0.893679271443103","row: 20<br>column: Petal.Length<br>value: 1.02175124677578"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,6.02783922999824],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Sepal.Length","Petal.Width","Petal.Length"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["18","24","33","6","12","11","28","13","19","2","31","26","17","4","15","30","35","8","5","9","21","25","14","27","1","3","23","29","22","32","16","10","7","34","20"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,10.2091627919783],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"268247ce98f8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"2682e1280ee":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"268260ce9079":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"2682511343e5":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[2],[2],[2],[3],[2],[3],[3],[3],[3],[2],[3],[3],[3],[3],[3],[3],[3],[3]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 19"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 17"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 21"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"],["value: virginica<br>variable: Species<br>row: 27"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 16"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 20"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"2682196f2996":{"z":[[0.820746123365793,-1.00562391265171,-1.13740998183668,-1.28897849593253],[0.820746123365793,-0.885498189297411,-1.13740998183668,-1.23396112110614],[1.01885725659202,-1.12574963600601,-1.40822188227398,-1.23396112110614],[0.622634990139567,-1.24587535936031,-1.27281593205533,-0.958874246974196],[0.424523856913341,-0.885498189297411,-0.866598081399372,-1.06890899662697],[0.820746123365793,-1.00562391265171,-0.73119213118072,-1.12392637145336],[0.622634990139567,-0.52512101923451,-1.27281593205533,-1.06890899662697],[0.622634990139567,-0.52512101923451,-1.00200403161802,-1.17894374627975],[-0.169809542765337,-1.84650397613181,-1.40822188227398,-1.3990132455853],[1.41507952304447,-0.885498189297411,-1.13740998183668,-1.17894374627975],[1.21696838981824,-0.52512101923451,-1.27281593205533,-1.17894374627975],[1.6131906562707,-0.52512101923451,-1.00200403161802,-1.06890899662697],[2.20752405594937,-0.404995295880211,-1.27281593205533,-1.23396112110614],[-1.35847634212269,-0.404995295880211,-0.189568330306113,0.0314384999007934],[-1.35847634212269,-0.404995295880211,-0.0541623800874605,0.0864558747271815],[-1.16036520889647,-0.885498189297411,-0.0541623800874605,-0.353683123883925],[-0.96225407567024,-0.404995295880211,0.0812435701311912,0.416560123685511],[-0.764142942444014,-0.0446181258173116,0.0812435701311912,0.14147324955357],[-0.566031809217789,-0.164743849171611,0.216649520349843,0.4715774985119],[-0.367920675991563,-0.284869572525912,0.216649520349843,-0.0235788749255949],[-0.566031809217789,-0.284869572525912,1.16449117188041,0.691646997817453],[-1.75469860857514,0.435884767599888,0.487461420787147,0.4715774985119],[-1.75469860857514,0.195633320891288,0.487461420787147,0.746664372643841],[1.41507952304447,2.47802206462299,1.16449117188041,1.51690762021328],[-0.566031809217789,2.23777061791439,1.16449117188041,1.68195974469244],[-1.16036520889647,1.03651338437139,0.893679271443103,1.18680337125495],[-0.566031809217789,1.15663910772569,0.352055470568495,0.636629622991064],[-0.169809542765337,1.63714200114289,0.622867371005799,1.18680337125495],[0.622634990139567,0.435884767599888,1.57070902253636,0.966733871949394],[0.0283015904608893,1.27676483107999,1.57070902253636,0.801681747470229],[-0.566031809217789,0.435884767599888,0.893679271443103,0.636629622991064],[-0.566031809217789,0.676136214308488,1.29989712209906,1.07676862160217],[0.226412723687115,0.796261937662788,1.16449117188041,0.801681747470229],[-0.169809542765337,0.796261937662788,0.893679271443103,1.02175124677578],[0.0283015904608893,0.676136214308488,0.893679271443103,1.02175124677578]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 18<br>column: Sepal.Width<br>value: 0.820746123365793","row: 18<br>column: Sepal.Length<br>value: -1.00562391265171","row: 18<br>column: Petal.Width<br>value: -1.13740998183668","row: 18<br>column: Petal.Length<br>value: -1.28897849593253"],["row: 24<br>column: Sepal.Width<br>value: 0.820746123365793","row: 24<br>column: Sepal.Length<br>value: -0.885498189297411","row: 24<br>column: Petal.Width<br>value: -1.13740998183668","row: 24<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 33<br>column: Sepal.Width<br>value: 1.01885725659202","row: 33<br>column: Sepal.Length<br>value: -1.12574963600601","row: 33<br>column: Petal.Width<br>value: -1.40822188227398","row: 33<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 6<br>column: Sepal.Width<br>value: 0.622634990139567","row: 6<br>column: Sepal.Length<br>value: -1.24587535936031","row: 6<br>column: Petal.Width<br>value: -1.27281593205533","row: 6<br>column: Petal.Length<br>value: -0.958874246974196"],["row: 12<br>column: Sepal.Width<br>value: 0.424523856913341","row: 12<br>column: Sepal.Length<br>value: -0.885498189297411","row: 12<br>column: Petal.Width<br>value: -0.866598081399372","row: 12<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 11<br>column: Sepal.Width<br>value: 0.820746123365793","row: 11<br>column: Sepal.Length<br>value: -1.00562391265171","row: 11<br>column: Petal.Width<br>value: -0.73119213118072","row: 11<br>column: Petal.Length<br>value: -1.12392637145336"],["row: 28<br>column: Sepal.Width<br>value: 0.622634990139567","row: 28<br>column: Sepal.Length<br>value: -0.52512101923451","row: 28<br>column: Petal.Width<br>value: -1.27281593205533","row: 28<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 13<br>column: Sepal.Width<br>value: 0.622634990139567","row: 13<br>column: Sepal.Length<br>value: -0.52512101923451","row: 13<br>column: Petal.Width<br>value: -1.00200403161802","row: 13<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 19<br>column: Sepal.Width<br>value: -0.169809542765337","row: 19<br>column: Sepal.Length<br>value: -1.84650397613181","row: 19<br>column: Petal.Width<br>value: -1.40822188227398","row: 19<br>column: Petal.Length<br>value: -1.3990132455853"],["row: 2<br>column: Sepal.Width<br>value: 1.41507952304447","row: 2<br>column: Sepal.Length<br>value: -0.885498189297411","row: 2<br>column: Petal.Width<br>value: -1.13740998183668","row: 2<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 31<br>column: Sepal.Width<br>value: 1.21696838981824","row: 31<br>column: Sepal.Length<br>value: -0.52512101923451","row: 31<br>column: Petal.Width<br>value: -1.27281593205533","row: 31<br>column: Petal.Length<br>value: -1.17894374627975"],["row: 26<br>column: Sepal.Width<br>value: 1.6131906562707","row: 26<br>column: Sepal.Length<br>value: -0.52512101923451","row: 26<br>column: Petal.Width<br>value: -1.00200403161802","row: 26<br>column: Petal.Length<br>value: -1.06890899662697"],["row: 17<br>column: Sepal.Width<br>value: 2.20752405594937","row: 17<br>column: Sepal.Length<br>value: -0.404995295880211","row: 17<br>column: Petal.Width<br>value: -1.27281593205533","row: 17<br>column: Petal.Length<br>value: -1.23396112110614"],["row: 4<br>column: Sepal.Width<br>value: -1.35847634212269","row: 4<br>column: Sepal.Length<br>value: -0.404995295880211","row: 4<br>column: Petal.Width<br>value: -0.189568330306113","row: 4<br>column: Petal.Length<br>value: 0.0314384999007934"],["row: 15<br>column: Sepal.Width<br>value: -1.35847634212269","row: 15<br>column: Sepal.Length<br>value: -0.404995295880211","row: 15<br>column: Petal.Width<br>value: -0.0541623800874605","row: 15<br>column: Petal.Length<br>value: 0.0864558747271815"],["row: 30<br>column: Sepal.Width<br>value: -1.16036520889647","row: 30<br>column: Sepal.Length<br>value: -0.885498189297411","row: 30<br>column: Petal.Width<br>value: -0.0541623800874605","row: 30<br>column: Petal.Length<br>value: -0.353683123883925"],["row: 35<br>column: Sepal.Width<br>value: -0.96225407567024","row: 35<br>column: Sepal.Length<br>value: -0.404995295880211","row: 35<br>column: Petal.Width<br>value: 0.0812435701311912","row: 35<br>column: Petal.Length<br>value: 0.416560123685511"],["row: 8<br>column: Sepal.Width<br>value: -0.764142942444014","row: 8<br>column: Sepal.Length<br>value: -0.0446181258173116","row: 8<br>column: Petal.Width<br>value: 0.0812435701311912","row: 8<br>column: Petal.Length<br>value: 0.14147324955357"],["row: 5<br>column: Sepal.Width<br>value: -0.566031809217789","row: 5<br>column: Sepal.Length<br>value: -0.164743849171611","row: 5<br>column: Petal.Width<br>value: 0.216649520349843","row: 5<br>column: Petal.Length<br>value: 0.4715774985119"],["row: 9<br>column: Sepal.Width<br>value: -0.367920675991563","row: 9<br>column: Sepal.Length<br>value: -0.284869572525912","row: 9<br>column: Petal.Width<br>value: 0.216649520349843","row: 9<br>column: Petal.Length<br>value: -0.0235788749255949"],["row: 21<br>column: Sepal.Width<br>value: -0.566031809217789","row: 21<br>column: Sepal.Length<br>value: -0.284869572525912","row: 21<br>column: Petal.Width<br>value: 1.16449117188041","row: 21<br>column: Petal.Length<br>value: 0.691646997817453"],["row: 25<br>column: Sepal.Width<br>value: -1.75469860857514","row: 25<br>column: Sepal.Length<br>value: 0.435884767599888","row: 25<br>column: Petal.Width<br>value: 0.487461420787147","row: 25<br>column: Petal.Length<br>value: 0.4715774985119"],["row: 14<br>column: Sepal.Width<br>value: -1.75469860857514","row: 14<br>column: Sepal.Length<br>value: 0.195633320891288","row: 14<br>column: Petal.Width<br>value: 0.487461420787147","row: 14<br>column: Petal.Length<br>value: 0.746664372643841"],["row: 27<br>column: Sepal.Width<br>value: 1.41507952304447","row: 27<br>column: Sepal.Length<br>value: 2.47802206462299","row: 27<br>column: Petal.Width<br>value: 1.16449117188041","row: 27<br>column: Petal.Length<br>value: 1.51690762021328"],["row: 1<br>column: Sepal.Width<br>value: -0.566031809217789","row: 1<br>column: Sepal.Length<br>value: 2.23777061791439","row: 1<br>column: Petal.Width<br>value: 1.16449117188041","row: 1<br>column: Petal.Length<br>value: 1.68195974469244"],["row: 3<br>column: Sepal.Width<br>value: -1.16036520889647","row: 3<br>column: Sepal.Length<br>value: 1.03651338437139","row: 3<br>column: Petal.Width<br>value: 0.893679271443103","row: 3<br>column: Petal.Length<br>value: 1.18680337125495"],["row: 23<br>column: Sepal.Width<br>value: -0.566031809217789","row: 23<br>column: Sepal.Length<br>value: 1.15663910772569","row: 23<br>column: Petal.Width<br>value: 0.352055470568495","row: 23<br>column: Petal.Length<br>value: 0.636629622991064"],["row: 29<br>column: Sepal.Width<br>value: -0.169809542765337","row: 29<br>column: Sepal.Length<br>value: 1.63714200114289","row: 29<br>column: Petal.Width<br>value: 0.622867371005799","row: 29<br>column: Petal.Length<br>value: 1.18680337125495"],["row: 22<br>column: Sepal.Width<br>value: 0.622634990139567","row: 22<br>column: Sepal.Length<br>value: 0.435884767599888","row: 22<br>column: Petal.Width<br>value: 1.57070902253636","row: 22<br>column: Petal.Length<br>value: 0.966733871949394"],["row: 32<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 32<br>column: Sepal.Length<br>value: 1.27676483107999","row: 32<br>column: Petal.Width<br>value: 1.57070902253636","row: 32<br>column: Petal.Length<br>value: 0.801681747470229"],["row: 16<br>column: Sepal.Width<br>value: -0.566031809217789","row: 16<br>column: Sepal.Length<br>value: 0.435884767599888","row: 16<br>column: Petal.Width<br>value: 0.893679271443103","row: 16<br>column: Petal.Length<br>value: 0.636629622991064"],["row: 10<br>column: Sepal.Width<br>value: -0.566031809217789","row: 10<br>column: Sepal.Length<br>value: 0.676136214308488","row: 10<br>column: Petal.Width<br>value: 1.29989712209906","row: 10<br>column: Petal.Length<br>value: 1.07676862160217"],["row: 7<br>column: Sepal.Width<br>value: 0.226412723687115","row: 7<br>column: Sepal.Length<br>value: 0.796261937662788","row: 7<br>column: Petal.Width<br>value: 1.16449117188041","row: 7<br>column: Petal.Length<br>value: 0.801681747470229"],["row: 34<br>column: Sepal.Width<br>value: -0.169809542765337","row: 34<br>column: Sepal.Length<br>value: 0.796261937662788","row: 34<br>column: Petal.Width<br>value: 0.893679271443103","row: 34<br>column: Petal.Length<br>value: 1.02175124677578"],["row: 20<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 20<br>column: Sepal.Length<br>value: 0.676136214308488","row: 20<br>column: Petal.Width<br>value: 0.893679271443103","row: 20<br>column: Petal.Length<br>value: 1.02175124677578"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>


---

# Visualización previa

Con `seriate = ...` podemos cambiar el método de ordenación para una mejor visualización


```r
heatmaply(iris_sample %&gt;% 
            mutate(across(where(is.numeric), ~scale(.))),
          seriate = "OLO",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

---

# Visualización previa

<div id="htmlwidget-bb21b5d4aa8be1e1b818" style="width:100%;height:840px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-bb21b5d4aa8be1e1b818">{"x":{"data":[{"type":"scatter","mode":"markers","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"scatter","mode":"markers","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4],"y":[10.2091627919783,10.2091627919783,null,10.2091627919783,0,null,10.2091627919783,10.2091627919783,null,10.2091627919783,3.6408835660283,null,3.6408835660283,3.6408835660283,null,3.6408835660283,0,null,3.6408835660283,3.6408835660283,null,3.6408835660283,1.80204943391697,null,1.80204943391697,1.80204943391697,null,1.80204943391697,0,null,1.80204943391697,1.80204943391697,null,1.80204943391697,0],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y",null,"y","y"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x3","yaxis":"y","frame":null},{"x":[6.02783922999824,6.02783922999824,null,6.02783922999824,2.78841160698492,null,2.78841160698492,2.78841160698492,null,2.78841160698492,0.99932858892792,null,0.99932858892792,0.99932858892792,null,0.99932858892792,0,null,0.99932858892792,0.99932858892792,null,0.99932858892792,0.492380763213116,null,0.492380763213116,0.492380763213116,null,0.492380763213116,0,null,0.492380763213116,0.492380763213116,null,0.492380763213116,0.432960156556397,null,0.432960156556397,0.432960156556397,null,0.432960156556397,0,null,0.432960156556397,0.432960156556397,null,0.432960156556397,0,null,2.78841160698492,2.78841160698492,null,2.78841160698492,1.60855984757349,null,1.60855984757349,1.60855984757349,null,1.60855984757349,0.855307835278113,null,0.855307835278113,0.855307835278113,null,0.855307835278113,0.752671445517315,null,0.752671445517315,0.752671445517315,null,0.752671445517315,0.292312729024265,null,0.292312729024265,0.292312729024265,null,0.292312729024265,0,null,0.292312729024265,0.292312729024265,null,0.292312729024265,0,null,0.752671445517315,0.752671445517315,null,0.752671445517315,0.439071698850558,null,0.439071698850558,0.439071698850558,null,0.439071698850558,0,null,0.439071698850558,0.439071698850558,null,0.439071698850558,0,null,0.855307835278113,0.855307835278113,null,0.855307835278113,0.515198829112034,null,0.515198829112034,0.515198829112034,null,0.515198829112034,0.412683733835268,null,0.412683733835268,0.412683733835268,null,0.412683733835268,0.13212532287257,null,0.13212532287257,0.13212532287257,null,0.13212532287257,0,null,0.13212532287257,0.13212532287257,null,0.13212532287257,0,null,0.412683733835268,0.412683733835268,null,0.412683733835268,0,null,0.515198829112034,0.515198829112034,null,0.515198829112034,0,null,1.60855984757349,1.60855984757349,null,1.60855984757349,0,null,6.02783922999824,6.02783922999824,null,6.02783922999824,4.78857079695404,null,4.78857079695404,4.78857079695404,null,4.78857079695404,1.81433692249223,null,1.81433692249223,1.81433692249223,null,1.81433692249223,0.681067830534425,null,0.681067830534425,0.681067830534425,null,0.681067830534425,0,null,0.681067830534425,0.681067830534425,null,0.681067830534425,0.146156364512133,null,0.146156364512133,0.146156364512133,null,0.146156364512133,0,null,0.146156364512133,0.146156364512133,null,0.146156364512133,0,null,1.81433692249223,1.81433692249223,null,1.81433692249223,1.67947902955883,null,1.67947902955883,1.67947902955883,null,1.67947902955883,0.365230811905647,null,0.365230811905647,0.365230811905647,null,0.365230811905647,0,null,0.365230811905647,0.365230811905647,null,0.365230811905647,0,null,1.67947902955883,1.67947902955883,null,1.67947902955883,1.25422697257231,null,1.25422697257231,1.25422697257231,null,1.25422697257231,0.761393123713376,null,0.761393123713376,0.761393123713376,null,0.761393123713376,0.494765110057698,null,0.494765110057698,0.494765110057698,null,0.494765110057698,0,null,0.494765110057698,0.494765110057698,null,0.494765110057698,0.425419554151583,null,0.425419554151583,0.425419554151583,null,0.425419554151583,0,null,0.425419554151583,0.425419554151583,null,0.425419554151583,0,null,0.761393123713376,0.761393123713376,null,0.761393123713376,0,null,1.25422697257231,1.25422697257231,null,1.25422697257231,0,null,4.78857079695404,4.78857079695404,null,4.78857079695404,2.99054431308462,null,2.99054431308462,2.99054431308462,null,2.99054431308462,2.31003947340531,null,2.31003947340531,2.31003947340531,null,2.31003947340531,1.40721954894757,null,1.40721954894757,1.40721954894757,null,1.40721954894757,0.926510297647558,null,0.926510297647558,0.926510297647558,null,0.926510297647558,0.645334051430348,null,0.645334051430348,0.645334051430348,null,0.645334051430348,0,null,0.645334051430348,0.645334051430348,null,0.645334051430348,0,null,0.926510297647558,0.926510297647558,null,0.926510297647558,0.527978933647716,null,0.527978933647716,0.527978933647716,null,0.527978933647716,0.231685585480783,null,0.231685585480783,0.231685585480783,null,0.231685585480783,0,null,0.231685585480783,0.231685585480783,null,0.231685585480783,0,null,0.527978933647716,0.527978933647716,null,0.527978933647716,0,null,1.40721954894757,1.40721954894757,null,1.40721954894757,1.04285841557088,null,1.04285841557088,1.04285841557088,null,1.04285841557088,0,null,1.04285841557088,1.04285841557088,null,1.04285841557088,0,null,2.31003947340531,2.31003947340531,null,2.31003947340531,1.7092724108302,null,1.7092724108302,1.7092724108302,null,1.7092724108302,1.18966144276756,null,1.18966144276756,1.18966144276756,null,1.18966144276756,0,null,1.18966144276756,1.18966144276756,null,1.18966144276756,0.874016792580219,null,0.874016792580219,0.874016792580219,null,0.874016792580219,0,null,0.874016792580219,0.874016792580219,null,0.874016792580219,0,null,1.7092724108302,1.7092724108302,null,1.7092724108302,0,null,2.99054431308462,2.99054431308462,null,2.99054431308462,0],"y":[15.6640625,6.390625,null,6.390625,6.390625,null,6.390625,1.875,null,1.875,1.875,null,1.875,1,null,1,1,null,1.875,2.75,null,2.75,2.75,null,2.75,2,null,2,2,null,2.75,3.5,null,3.5,3.5,null,3.5,3,null,3,3,null,3.5,4,null,4,4,null,6.390625,10.90625,null,10.90625,10.90625,null,10.90625,8.8125,null,8.8125,8.8125,null,8.8125,6.5,null,6.5,6.5,null,6.5,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.5,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.8125,11.125,null,11.125,11.125,null,11.125,10.25,null,10.25,10.25,null,10.25,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10,null,10.25,11,null,11,11,null,11.125,12,null,12,12,null,10.90625,13,null,13,13,null,15.6640625,24.9375,null,24.9375,24.9375,null,24.9375,17.234375,null,17.234375,17.234375,null,17.234375,14.75,null,14.75,14.75,null,14.75,14,null,14,14,null,14.75,15.5,null,15.5,15.5,null,15.5,15,null,15,15,null,15.5,16,null,16,16,null,17.234375,19.71875,null,19.71875,19.71875,null,19.71875,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,19.71875,21.9375,null,21.9375,21.9375,null,21.9375,20.875,null,20.875,20.875,null,20.875,19.75,null,19.75,19.75,null,19.75,19,null,19,19,null,19.75,20.5,null,20.5,20.5,null,20.5,20,null,20,20,null,20.5,21,null,21,21,null,20.875,22,null,22,22,null,21.9375,23,null,23,23,null,24.9375,32.640625,null,32.640625,32.640625,null,32.640625,30.28125,null,30.28125,30.28125,null,30.28125,27.6875,null,27.6875,27.6875,null,27.6875,25.875,null,25.875,25.875,null,25.875,24.5,null,24.5,24.5,null,24.5,24,null,24,24,null,24.5,25,null,25,25,null,25.875,27.25,null,27.25,27.25,null,27.25,26.5,null,26.5,26.5,null,26.5,26,null,26,26,null,26.5,27,null,27,27,null,27.25,28,null,28,28,null,27.6875,29.5,null,29.5,29.5,null,29.5,29,null,29,29,null,29.5,30,null,30,30,null,30.28125,32.875,null,32.875,32.875,null,32.875,31.75,null,31.75,31.75,null,31.75,31,null,31,31,null,31.75,32.5,null,32.5,32.5,null,32.5,32,null,32,32,null,32.5,33,null,33,33,null,32.875,34,null,34,34,null,32.640625,35,null,35,35],"type":"scatter","mode":"lines","showlegend":false,"hoverinfo":["x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x",null,"x","x"],"name":"1","marker":{"color":"rgba(0,0,0,1)","line":{"color":"rgba(0,0,0,1)"}},"textfont":{"color":"rgba(0,0,0,1)"},"error_y":{"color":"rgba(0,0,0,1)"},"error_x":{"color":"rgba(0,0,0,1)"},"line":{"color":"rgba(0,0,0,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"colorbar":{"title":"Species","ticklen":2,"tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"showscale":true,"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[3],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[3],[3],[2],[3],[3],[3]],"x":[1],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 17"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 21"],["value: virginica<br>variable: Species<br>row: 16"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 20"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 27"]],"hoverinfo":"text","showlegend":false,"type":"heatmap","xaxis":"x2","yaxis":"y2","frame":null},{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"right","x":-0.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(71,17,100,1)"],["0.0833333333333334","rgba(72,31,112,1)"],["0.125","rgba(71,45,123,1)"],["0.166666666666667","rgba(68,58,131,1)"],["0.208333333333333","rgba(64,70,136,1)"],["0.25","rgba(59,82,139,1)"],["0.291666666666667","rgba(54,93,141,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(44,114,142,1)"],["0.416666666666667","rgba(40,124,142,1)"],["0.458333333333333","rgba(36,134,142,1)"],["0.5","rgba(33,144,141,1)"],["0.541666666666667","rgba(31,154,138,1)"],["0.583333333333333","rgba(32,164,134,1)"],["0.625","rgba(39,173,129,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(71,193,110,1)"],["0.75","rgba(93,200,99,1)"],["0.791666666666667","rgba(117,208,84,1)"],["0.833333333333333","rgba(143,214,68,1)"],["0.875","rgba(170,220,50,1)"],["0.916666666666667","rgba(199,224,32,1)"],["0.958333333333333","rgba(227,228,24,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[2.20752405594937,-0.404995295880211,-1.23396112110614,-1.27281593205533],[1.6131906562707,-0.52512101923451,-1.06890899662697,-1.00200403161802],[1.41507952304447,-0.885498189297411,-1.17894374627975,-1.13740998183668],[1.21696838981824,-0.52512101923451,-1.17894374627975,-1.27281593205533],[0.622634990139567,-0.52512101923451,-1.06890899662697,-1.27281593205533],[0.622634990139567,-0.52512101923451,-1.17894374627975,-1.00200403161802],[0.424523856913341,-0.885498189297411,-1.06890899662697,-0.866598081399372],[0.820746123365793,-1.00562391265171,-1.12392637145336,-0.73119213118072],[0.820746123365793,-0.885498189297411,-1.23396112110614,-1.13740998183668],[0.820746123365793,-1.00562391265171,-1.28897849593253,-1.13740998183668],[1.01885725659202,-1.12574963600601,-1.23396112110614,-1.40822188227398],[0.622634990139567,-1.24587535936031,-0.958874246974196,-1.27281593205533],[-0.169809542765337,-1.84650397613181,-1.3990132455853,-1.40822188227398],[-1.16036520889647,-0.885498189297411,-0.353683123883925,-0.0541623800874605],[-1.35847634212269,-0.404995295880211,0.0314384999007934,-0.189568330306113],[-1.35847634212269,-0.404995295880211,0.0864558747271815,-0.0541623800874605],[-1.75469860857514,0.435884767599888,0.4715774985119,0.487461420787147],[-1.75469860857514,0.195633320891288,0.746664372643841,0.487461420787147],[-0.96225407567024,-0.404995295880211,0.416560123685511,0.0812435701311912],[-0.566031809217789,-0.164743849171611,0.4715774985119,0.216649520349843],[-0.764142942444014,-0.0446181258173116,0.14147324955357,0.0812435701311912],[-0.367920675991563,-0.284869572525912,-0.0235788749255949,0.216649520349843],[-0.566031809217789,-0.284869572525912,0.691646997817453,1.16449117188041],[-0.566031809217789,0.435884767599888,0.636629622991064,0.893679271443103],[-0.566031809217789,0.676136214308488,1.07676862160217,1.29989712209906],[-0.169809542765337,0.796261937662788,1.02175124677578,0.893679271443103],[0.0283015904608893,0.676136214308488,1.02175124677578,0.893679271443103],[0.226412723687115,0.796261937662788,0.801681747470229,1.16449117188041],[0.622634990139567,0.435884767599888,0.966733871949394,1.57070902253636],[0.0283015904608893,1.27676483107999,0.801681747470229,1.57070902253636],[-1.16036520889647,1.03651338437139,1.18680337125495,0.893679271443103],[-0.566031809217789,1.15663910772569,0.636629622991064,0.352055470568495],[-0.169809542765337,1.63714200114289,1.18680337125495,0.622867371005799],[-0.566031809217789,2.23777061791439,1.68195974469244,1.16449117188041],[1.41507952304447,2.47802206462299,1.51690762021328,1.16449117188041]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 17<br>column: Sepal.Width<br>value: 2.20752405594937","row: 17<br>column: Sepal.Length<br>value: -0.404995295880211","row: 17<br>column: Petal.Length<br>value: -1.23396112110614","row: 17<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 26<br>column: Sepal.Width<br>value: 1.6131906562707","row: 26<br>column: Sepal.Length<br>value: -0.52512101923451","row: 26<br>column: Petal.Length<br>value: -1.06890899662697","row: 26<br>column: Petal.Width<br>value: -1.00200403161802"],["row: 2<br>column: Sepal.Width<br>value: 1.41507952304447","row: 2<br>column: Sepal.Length<br>value: -0.885498189297411","row: 2<br>column: Petal.Length<br>value: -1.17894374627975","row: 2<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 31<br>column: Sepal.Width<br>value: 1.21696838981824","row: 31<br>column: Sepal.Length<br>value: -0.52512101923451","row: 31<br>column: Petal.Length<br>value: -1.17894374627975","row: 31<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 28<br>column: Sepal.Width<br>value: 0.622634990139567","row: 28<br>column: Sepal.Length<br>value: -0.52512101923451","row: 28<br>column: Petal.Length<br>value: -1.06890899662697","row: 28<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 13<br>column: Sepal.Width<br>value: 0.622634990139567","row: 13<br>column: Sepal.Length<br>value: -0.52512101923451","row: 13<br>column: Petal.Length<br>value: -1.17894374627975","row: 13<br>column: Petal.Width<br>value: -1.00200403161802"],["row: 12<br>column: Sepal.Width<br>value: 0.424523856913341","row: 12<br>column: Sepal.Length<br>value: -0.885498189297411","row: 12<br>column: Petal.Length<br>value: -1.06890899662697","row: 12<br>column: Petal.Width<br>value: -0.866598081399372"],["row: 11<br>column: Sepal.Width<br>value: 0.820746123365793","row: 11<br>column: Sepal.Length<br>value: -1.00562391265171","row: 11<br>column: Petal.Length<br>value: -1.12392637145336","row: 11<br>column: Petal.Width<br>value: -0.73119213118072"],["row: 24<br>column: Sepal.Width<br>value: 0.820746123365793","row: 24<br>column: Sepal.Length<br>value: -0.885498189297411","row: 24<br>column: Petal.Length<br>value: -1.23396112110614","row: 24<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 18<br>column: Sepal.Width<br>value: 0.820746123365793","row: 18<br>column: Sepal.Length<br>value: -1.00562391265171","row: 18<br>column: Petal.Length<br>value: -1.28897849593253","row: 18<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 33<br>column: Sepal.Width<br>value: 1.01885725659202","row: 33<br>column: Sepal.Length<br>value: -1.12574963600601","row: 33<br>column: Petal.Length<br>value: -1.23396112110614","row: 33<br>column: Petal.Width<br>value: -1.40822188227398"],["row: 6<br>column: Sepal.Width<br>value: 0.622634990139567","row: 6<br>column: Sepal.Length<br>value: -1.24587535936031","row: 6<br>column: Petal.Length<br>value: -0.958874246974196","row: 6<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 19<br>column: Sepal.Width<br>value: -0.169809542765337","row: 19<br>column: Sepal.Length<br>value: -1.84650397613181","row: 19<br>column: Petal.Length<br>value: -1.3990132455853","row: 19<br>column: Petal.Width<br>value: -1.40822188227398"],["row: 30<br>column: Sepal.Width<br>value: -1.16036520889647","row: 30<br>column: Sepal.Length<br>value: -0.885498189297411","row: 30<br>column: Petal.Length<br>value: -0.353683123883925","row: 30<br>column: Petal.Width<br>value: -0.0541623800874605"],["row: 4<br>column: Sepal.Width<br>value: -1.35847634212269","row: 4<br>column: Sepal.Length<br>value: -0.404995295880211","row: 4<br>column: Petal.Length<br>value: 0.0314384999007934","row: 4<br>column: Petal.Width<br>value: -0.189568330306113"],["row: 15<br>column: Sepal.Width<br>value: -1.35847634212269","row: 15<br>column: Sepal.Length<br>value: -0.404995295880211","row: 15<br>column: Petal.Length<br>value: 0.0864558747271815","row: 15<br>column: Petal.Width<br>value: -0.0541623800874605"],["row: 25<br>column: Sepal.Width<br>value: -1.75469860857514","row: 25<br>column: Sepal.Length<br>value: 0.435884767599888","row: 25<br>column: Petal.Length<br>value: 0.4715774985119","row: 25<br>column: Petal.Width<br>value: 0.487461420787147"],["row: 14<br>column: Sepal.Width<br>value: -1.75469860857514","row: 14<br>column: Sepal.Length<br>value: 0.195633320891288","row: 14<br>column: Petal.Length<br>value: 0.746664372643841","row: 14<br>column: Petal.Width<br>value: 0.487461420787147"],["row: 35<br>column: Sepal.Width<br>value: -0.96225407567024","row: 35<br>column: Sepal.Length<br>value: -0.404995295880211","row: 35<br>column: Petal.Length<br>value: 0.416560123685511","row: 35<br>column: Petal.Width<br>value: 0.0812435701311912"],["row: 5<br>column: Sepal.Width<br>value: -0.566031809217789","row: 5<br>column: Sepal.Length<br>value: -0.164743849171611","row: 5<br>column: Petal.Length<br>value: 0.4715774985119","row: 5<br>column: Petal.Width<br>value: 0.216649520349843"],["row: 8<br>column: Sepal.Width<br>value: -0.764142942444014","row: 8<br>column: Sepal.Length<br>value: -0.0446181258173116","row: 8<br>column: Petal.Length<br>value: 0.14147324955357","row: 8<br>column: Petal.Width<br>value: 0.0812435701311912"],["row: 9<br>column: Sepal.Width<br>value: -0.367920675991563","row: 9<br>column: Sepal.Length<br>value: -0.284869572525912","row: 9<br>column: Petal.Length<br>value: -0.0235788749255949","row: 9<br>column: Petal.Width<br>value: 0.216649520349843"],["row: 21<br>column: Sepal.Width<br>value: -0.566031809217789","row: 21<br>column: Sepal.Length<br>value: -0.284869572525912","row: 21<br>column: Petal.Length<br>value: 0.691646997817453","row: 21<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 16<br>column: Sepal.Width<br>value: -0.566031809217789","row: 16<br>column: Sepal.Length<br>value: 0.435884767599888","row: 16<br>column: Petal.Length<br>value: 0.636629622991064","row: 16<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 10<br>column: Sepal.Width<br>value: -0.566031809217789","row: 10<br>column: Sepal.Length<br>value: 0.676136214308488","row: 10<br>column: Petal.Length<br>value: 1.07676862160217","row: 10<br>column: Petal.Width<br>value: 1.29989712209906"],["row: 34<br>column: Sepal.Width<br>value: -0.169809542765337","row: 34<br>column: Sepal.Length<br>value: 0.796261937662788","row: 34<br>column: Petal.Length<br>value: 1.02175124677578","row: 34<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 20<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 20<br>column: Sepal.Length<br>value: 0.676136214308488","row: 20<br>column: Petal.Length<br>value: 1.02175124677578","row: 20<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 7<br>column: Sepal.Width<br>value: 0.226412723687115","row: 7<br>column: Sepal.Length<br>value: 0.796261937662788","row: 7<br>column: Petal.Length<br>value: 0.801681747470229","row: 7<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 22<br>column: Sepal.Width<br>value: 0.622634990139567","row: 22<br>column: Sepal.Length<br>value: 0.435884767599888","row: 22<br>column: Petal.Length<br>value: 0.966733871949394","row: 22<br>column: Petal.Width<br>value: 1.57070902253636"],["row: 32<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 32<br>column: Sepal.Length<br>value: 1.27676483107999","row: 32<br>column: Petal.Length<br>value: 0.801681747470229","row: 32<br>column: Petal.Width<br>value: 1.57070902253636"],["row: 3<br>column: Sepal.Width<br>value: -1.16036520889647","row: 3<br>column: Sepal.Length<br>value: 1.03651338437139","row: 3<br>column: Petal.Length<br>value: 1.18680337125495","row: 3<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 23<br>column: Sepal.Width<br>value: -0.566031809217789","row: 23<br>column: Sepal.Length<br>value: 1.15663910772569","row: 23<br>column: Petal.Length<br>value: 0.636629622991064","row: 23<br>column: Petal.Width<br>value: 0.352055470568495"],["row: 29<br>column: Sepal.Width<br>value: -0.169809542765337","row: 29<br>column: Sepal.Length<br>value: 1.63714200114289","row: 29<br>column: Petal.Length<br>value: 1.18680337125495","row: 29<br>column: Petal.Width<br>value: 0.622867371005799"],["row: 1<br>column: Sepal.Width<br>value: -0.566031809217789","row: 1<br>column: Sepal.Length<br>value: 2.23777061791439","row: 1<br>column: Petal.Length<br>value: 1.68195974469244","row: 1<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 27<br>column: Sepal.Width<br>value: 1.41507952304447","row: 27<br>column: Sepal.Length<br>value: 2.47802206462299","row: 27<br>column: Petal.Length<br>value: 1.51690762021328","row: 27<br>column: Petal.Width<br>value: 1.16449117188041"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x3","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,0.2],"automargin":true,"showticklabels":false,"showgrid":false,"zeroline":false,"anchor":"y2","title":"","range":[0,6.02783922999824],"linecolor":"#ffffff","autorange":"reversed"},"xaxis2":{"domain":[0.2,0.3],"automargin":true,"showticklabels":true,"showgrid":false,"zeroline":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1],"ticktext":["Species"],"linecolor":"#ffffff","range":[0.5,1.5],"title":[]},"xaxis3":{"domain":[0.3,1],"automargin":true,"title":"","range":[0.5,4.5],"linecolor":"#ffffff","showgrid":false,"anchor":"y2","tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4],"ticktext":["Sepal.Width","Sepal.Length","Petal.Length","Petal.Width"],"showticklabels":true},"yaxis2":{"domain":[0,0.8],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"ticktext":["17","26","2","31","28","13","12","11","24","18","33","6","19","30","4","15","25","14","35","5","8","9","21","16","10","34","20","7","22","32","3","23","29","1","27"],"linecolor":"#ffffff","range":[0,35.5],"showticklabels":true,"title":"","anchor":"x3","showgrid":false,"side":"right"},"yaxis":{"domain":[0.8,1],"automargin":true,"title":"","range":[0,10.2091627919783],"linecolor":"#ffffff","showgrid":false,"anchor":"x","showticklabels":false,"zeroline":false},"annotations":[],"shapes":[],"images":[],"margin":{"b":72,"l":null,"t":0,"r":12},"hovermode":"closest","showlegend":true,"scene":{"zaxis":{"title":[]}},"title":"","legend":{"y":1,"yanchor":"top"}},"attrs":{"26825d85f7ec":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]},"26824d33bba1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"y","inherit":true},"26827f636e9f":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"xend":{},"yend":{},"type":"scatter","mode":"lines","color":{},"showlegend":false,"colors":"1","hoverinfo":"x","inherit":true},"26826d56cc68":{"z":[[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[1],[2],[2],[2],[2],[3],[2],[2],[2],[2],[3],[3],[3],[3],[3],[3],[3],[3],[3],[2],[3],[3],[3]],"x":1,"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["value: setosa<br>variable: Species<br>row: 17"],["value: setosa<br>variable: Species<br>row: 26"],["value: setosa<br>variable: Species<br>row: 2"],["value: setosa<br>variable: Species<br>row: 31"],["value: setosa<br>variable: Species<br>row: 28"],["value: setosa<br>variable: Species<br>row: 13"],["value: setosa<br>variable: Species<br>row: 12"],["value: setosa<br>variable: Species<br>row: 11"],["value: setosa<br>variable: Species<br>row: 24"],["value: setosa<br>variable: Species<br>row: 18"],["value: setosa<br>variable: Species<br>row: 33"],["value: setosa<br>variable: Species<br>row: 6"],["value: setosa<br>variable: Species<br>row: 19"],["value: versicolor<br>variable: Species<br>row: 30"],["value: versicolor<br>variable: Species<br>row: 4"],["value: versicolor<br>variable: Species<br>row: 15"],["value: versicolor<br>variable: Species<br>row: 25"],["value: virginica<br>variable: Species<br>row: 14"],["value: versicolor<br>variable: Species<br>row: 35"],["value: versicolor<br>variable: Species<br>row: 5"],["value: versicolor<br>variable: Species<br>row: 8"],["value: versicolor<br>variable: Species<br>row: 9"],["value: virginica<br>variable: Species<br>row: 21"],["value: virginica<br>variable: Species<br>row: 16"],["value: virginica<br>variable: Species<br>row: 10"],["value: virginica<br>variable: Species<br>row: 34"],["value: virginica<br>variable: Species<br>row: 20"],["value: virginica<br>variable: Species<br>row: 7"],["value: virginica<br>variable: Species<br>row: 22"],["value: virginica<br>variable: Species<br>row: 32"],["value: virginica<br>variable: Species<br>row: 3"],["value: versicolor<br>variable: Species<br>row: 23"],["value: virginica<br>variable: Species<br>row: 29"],["value: virginica<br>variable: Species<br>row: 1"],["value: virginica<br>variable: Species<br>row: 27"]],"hoverinfo":"text","showlegend":false,"colorscale":[[0,"#A6CEE3"],[0.00334448160535117,"#A6CEE3"],[0.00668896321070234,"#A6CEE3"],[0.0100334448160535,"#A6CEE3"],[0.0133779264214047,"#A6CEE3"],[0.0167224080267559,"#A6CEE3"],[0.020066889632107,"#A6CEE3"],[0.0234113712374582,"#A6CEE3"],[0.0267558528428094,"#A6CEE3"],[0.0301003344481605,"#A6CEE3"],[0.0334448160535117,"#A6CEE3"],[0.0367892976588629,"#A6CEE3"],[0.040133779264214,"#A6CEE3"],[0.0434782608695652,"#A6CEE3"],[0.0468227424749164,"#A6CEE3"],[0.0501672240802676,"#A6CEE3"],[0.0535117056856187,"#A6CEE3"],[0.0568561872909699,"#A6CEE3"],[0.0602006688963211,"#A6CEE3"],[0.0635451505016722,"#A6CEE3"],[0.0668896321070234,"#A6CEE3"],[0.0702341137123746,"#A6CEE3"],[0.0735785953177257,"#A6CEE3"],[0.0769230769230769,"#A6CEE3"],[0.0802675585284281,"#A6CEE3"],[0.0836120401337793,"#A6CEE3"],[0.0869565217391304,"#A6CEE3"],[0.0903010033444816,"#A6CEE3"],[0.0936454849498328,"#A6CEE3"],[0.096989966555184,"#A6CEE3"],[0.100334448160535,"#A6CEE3"],[0.103678929765886,"#A6CEE3"],[0.107023411371237,"#A6CEE3"],[0.110367892976589,"#A6CEE3"],[0.11371237458194,"#A6CEE3"],[0.117056856187291,"#A6CEE3"],[0.120401337792642,"#A6CEE3"],[0.123745819397993,"#A6CEE3"],[0.127090301003344,"#A6CEE3"],[0.130434782608696,"#A6CEE3"],[0.133779264214047,"#A6CEE3"],[0.137123745819398,"#A6CEE3"],[0.140468227424749,"#A6CEE3"],[0.1438127090301,"#A6CEE3"],[0.147157190635451,"#A6CEE3"],[0.150501672240803,"#A6CEE3"],[0.153846153846154,"#A6CEE3"],[0.157190635451505,"#A6CEE3"],[0.160535117056856,"#A6CEE3"],[0.163879598662207,"#A6CEE3"],[0.167224080267559,"#A6CEE3"],[0.17056856187291,"#A6CEE3"],[0.173913043478261,"#A6CEE3"],[0.177257525083612,"#A6CEE3"],[0.180602006688963,"#A6CEE3"],[0.183946488294314,"#A6CEE3"],[0.187290969899666,"#A6CEE3"],[0.190635451505017,"#A6CEE3"],[0.193979933110368,"#A6CEE3"],[0.197324414715719,"#A6CEE3"],[0.20066889632107,"#A6CEE3"],[0.204013377926421,"#A6CEE3"],[0.207357859531773,"#A6CEE3"],[0.210702341137124,"#A6CEE3"],[0.214046822742475,"#A6CEE3"],[0.217391304347826,"#A6CEE3"],[0.220735785953177,"#A6CEE3"],[0.224080267558528,"#A6CEE3"],[0.22742474916388,"#A6CEE3"],[0.230769230769231,"#A6CEE3"],[0.234113712374582,"#A6CEE3"],[0.237458193979933,"#A6CEE3"],[0.240802675585284,"#A6CEE3"],[0.244147157190635,"#A6CEE3"],[0.247491638795987,"#A6CEE3"],[0.250836120401338,"#A6CEE3"],[0.254180602006689,"#A6CEE3"],[0.25752508361204,"#A6CEE3"],[0.260869565217391,"#A6CEE3"],[0.264214046822742,"#A6CEE3"],[0.267558528428094,"#A6CEE3"],[0.270903010033445,"#A6CEE3"],[0.274247491638796,"#A6CEE3"],[0.277591973244147,"#A6CEE3"],[0.280936454849498,"#A6CEE3"],[0.284280936454849,"#A6CEE3"],[0.287625418060201,"#A6CEE3"],[0.290969899665552,"#A6CEE3"],[0.294314381270903,"#A6CEE3"],[0.297658862876254,"#A6CEE3"],[0.301003344481605,"#A6CEE3"],[0.304347826086957,"#A6CEE3"],[0.307692307692308,"#A6CEE3"],[0.311036789297659,"#A6CEE3"],[0.31438127090301,"#A6CEE3"],[0.317725752508361,"#A6CEE3"],[0.321070234113712,"#A6CEE3"],[0.324414715719064,"#A6CEE3"],[0.327759197324415,"#A6CEE3"],[0.331103678929766,"#A6CEE3"],[0.334448160535117,"#1F78B4"],[0.337792642140468,"#1F78B4"],[0.341137123745819,"#1F78B4"],[0.344481605351171,"#1F78B4"],[0.347826086956522,"#1F78B4"],[0.351170568561873,"#1F78B4"],[0.354515050167224,"#1F78B4"],[0.357859531772575,"#1F78B4"],[0.361204013377926,"#1F78B4"],[0.364548494983278,"#1F78B4"],[0.367892976588629,"#1F78B4"],[0.37123745819398,"#1F78B4"],[0.374581939799331,"#1F78B4"],[0.377926421404682,"#1F78B4"],[0.381270903010033,"#1F78B4"],[0.384615384615385,"#1F78B4"],[0.387959866220736,"#1F78B4"],[0.391304347826087,"#1F78B4"],[0.394648829431438,"#1F78B4"],[0.397993311036789,"#1F78B4"],[0.40133779264214,"#1F78B4"],[0.404682274247492,"#1F78B4"],[0.408026755852843,"#1F78B4"],[0.411371237458194,"#1F78B4"],[0.414715719063545,"#1F78B4"],[0.418060200668896,"#1F78B4"],[0.421404682274247,"#1F78B4"],[0.424749163879599,"#1F78B4"],[0.42809364548495,"#1F78B4"],[0.431438127090301,"#1F78B4"],[0.434782608695652,"#1F78B4"],[0.438127090301003,"#1F78B4"],[0.441471571906354,"#1F78B4"],[0.444816053511706,"#1F78B4"],[0.448160535117057,"#1F78B4"],[0.451505016722408,"#1F78B4"],[0.454849498327759,"#1F78B4"],[0.45819397993311,"#1F78B4"],[0.461538461538462,"#1F78B4"],[0.464882943143813,"#1F78B4"],[0.468227424749164,"#1F78B4"],[0.471571906354515,"#1F78B4"],[0.474916387959866,"#1F78B4"],[0.478260869565217,"#1F78B4"],[0.481605351170569,"#1F78B4"],[0.48494983277592,"#1F78B4"],[0.488294314381271,"#1F78B4"],[0.491638795986622,"#1F78B4"],[0.494983277591973,"#1F78B4"],[0.498327759197324,"#1F78B4"],[0.501672240802676,"#1F78B4"],[0.505016722408027,"#1F78B4"],[0.508361204013378,"#1F78B4"],[0.511705685618729,"#1F78B4"],[0.51505016722408,"#1F78B4"],[0.518394648829431,"#1F78B4"],[0.521739130434783,"#1F78B4"],[0.525083612040134,"#1F78B4"],[0.528428093645485,"#1F78B4"],[0.531772575250836,"#1F78B4"],[0.535117056856187,"#1F78B4"],[0.538461538461538,"#1F78B4"],[0.54180602006689,"#1F78B4"],[0.545150501672241,"#1F78B4"],[0.548494983277592,"#1F78B4"],[0.551839464882943,"#1F78B4"],[0.555183946488294,"#1F78B4"],[0.558528428093645,"#1F78B4"],[0.561872909698997,"#1F78B4"],[0.565217391304348,"#1F78B4"],[0.568561872909699,"#1F78B4"],[0.57190635451505,"#1F78B4"],[0.575250836120401,"#1F78B4"],[0.578595317725752,"#1F78B4"],[0.581939799331104,"#1F78B4"],[0.585284280936455,"#1F78B4"],[0.588628762541806,"#1F78B4"],[0.591973244147157,"#1F78B4"],[0.595317725752508,"#1F78B4"],[0.598662207357859,"#1F78B4"],[0.602006688963211,"#1F78B4"],[0.605351170568562,"#1F78B4"],[0.608695652173913,"#1F78B4"],[0.612040133779264,"#1F78B4"],[0.615384615384615,"#1F78B4"],[0.618729096989967,"#1F78B4"],[0.622073578595318,"#1F78B4"],[0.625418060200669,"#1F78B4"],[0.62876254180602,"#1F78B4"],[0.632107023411371,"#1F78B4"],[0.635451505016722,"#1F78B4"],[0.638795986622074,"#1F78B4"],[0.642140468227425,"#1F78B4"],[0.645484949832776,"#1F78B4"],[0.648829431438127,"#1F78B4"],[0.652173913043478,"#1F78B4"],[0.655518394648829,"#1F78B4"],[0.658862876254181,"#1F78B4"],[0.662207357859532,"#1F78B4"],[0.665551839464883,"#1F78B4"],[0.668896321070234,"#B2DF8A"],[0.672240802675585,"#B2DF8A"],[0.675585284280936,"#B2DF8A"],[0.678929765886288,"#B2DF8A"],[0.682274247491639,"#B2DF8A"],[0.68561872909699,"#B2DF8A"],[0.688963210702341,"#B2DF8A"],[0.692307692307692,"#B2DF8A"],[0.695652173913043,"#B2DF8A"],[0.698996655518395,"#B2DF8A"],[0.702341137123746,"#B2DF8A"],[0.705685618729097,"#B2DF8A"],[0.709030100334448,"#B2DF8A"],[0.712374581939799,"#B2DF8A"],[0.71571906354515,"#B2DF8A"],[0.719063545150502,"#B2DF8A"],[0.722408026755853,"#B2DF8A"],[0.725752508361204,"#B2DF8A"],[0.729096989966555,"#B2DF8A"],[0.732441471571906,"#B2DF8A"],[0.735785953177257,"#B2DF8A"],[0.739130434782609,"#B2DF8A"],[0.74247491638796,"#B2DF8A"],[0.745819397993311,"#B2DF8A"],[0.749163879598662,"#B2DF8A"],[0.752508361204013,"#B2DF8A"],[0.755852842809364,"#B2DF8A"],[0.759197324414716,"#B2DF8A"],[0.762541806020067,"#B2DF8A"],[0.765886287625418,"#B2DF8A"],[0.769230769230769,"#B2DF8A"],[0.77257525083612,"#B2DF8A"],[0.775919732441472,"#B2DF8A"],[0.779264214046823,"#B2DF8A"],[0.782608695652174,"#B2DF8A"],[0.785953177257525,"#B2DF8A"],[0.789297658862876,"#B2DF8A"],[0.792642140468227,"#B2DF8A"],[0.795986622073579,"#B2DF8A"],[0.79933110367893,"#B2DF8A"],[0.802675585284281,"#B2DF8A"],[0.806020066889632,"#B2DF8A"],[0.809364548494983,"#B2DF8A"],[0.812709030100334,"#B2DF8A"],[0.816053511705686,"#B2DF8A"],[0.819397993311037,"#B2DF8A"],[0.822742474916388,"#B2DF8A"],[0.826086956521739,"#B2DF8A"],[0.82943143812709,"#B2DF8A"],[0.832775919732441,"#B2DF8A"],[0.836120401337793,"#B2DF8A"],[0.839464882943144,"#B2DF8A"],[0.842809364548495,"#B2DF8A"],[0.846153846153846,"#B2DF8A"],[0.849498327759197,"#B2DF8A"],[0.852842809364548,"#B2DF8A"],[0.8561872909699,"#B2DF8A"],[0.859531772575251,"#B2DF8A"],[0.862876254180602,"#B2DF8A"],[0.866220735785953,"#B2DF8A"],[0.869565217391304,"#B2DF8A"],[0.872909698996655,"#B2DF8A"],[0.876254180602007,"#B2DF8A"],[0.879598662207358,"#B2DF8A"],[0.882943143812709,"#B2DF8A"],[0.88628762541806,"#B2DF8A"],[0.889632107023411,"#B2DF8A"],[0.892976588628763,"#B2DF8A"],[0.896321070234114,"#B2DF8A"],[0.899665551839465,"#B2DF8A"],[0.903010033444816,"#B2DF8A"],[0.906354515050167,"#B2DF8A"],[0.909698996655518,"#B2DF8A"],[0.91304347826087,"#B2DF8A"],[0.916387959866221,"#B2DF8A"],[0.919732441471572,"#B2DF8A"],[0.923076923076923,"#B2DF8A"],[0.926421404682274,"#B2DF8A"],[0.929765886287625,"#B2DF8A"],[0.933110367892977,"#B2DF8A"],[0.936454849498328,"#B2DF8A"],[0.939799331103679,"#B2DF8A"],[0.94314381270903,"#B2DF8A"],[0.946488294314381,"#B2DF8A"],[0.949832775919732,"#B2DF8A"],[0.953177257525084,"#B2DF8A"],[0.956521739130435,"#B2DF8A"],[0.959866220735786,"#B2DF8A"],[0.963210702341137,"#B2DF8A"],[0.966555183946488,"#B2DF8A"],[0.969899665551839,"#B2DF8A"],[0.973244147157191,"#B2DF8A"],[0.976588628762542,"#B2DF8A"],[0.979933110367893,"#B2DF8A"],[0.983277591973244,"#B2DF8A"],[0.986622073578595,"#B2DF8A"],[0.989966555183946,"#B2DF8A"],[0.993311036789298,"#B2DF8A"],[0.996655518394649,"#B2DF8A"],[1,"#B2DF8A"]],"colorbar":{"title":"Species","tickmode":"array","tickvals":[1.33333333333333,2,2.66666666666667],"ticktext":["setosa","versicolor","virginica"],"len":0.3},"colors":["#A6CEE3","#1F78B4","#B2DF8A"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"},"268258f3ca0f":{"z":[[2.20752405594937,-0.404995295880211,-1.23396112110614,-1.27281593205533],[1.6131906562707,-0.52512101923451,-1.06890899662697,-1.00200403161802],[1.41507952304447,-0.885498189297411,-1.17894374627975,-1.13740998183668],[1.21696838981824,-0.52512101923451,-1.17894374627975,-1.27281593205533],[0.622634990139567,-0.52512101923451,-1.06890899662697,-1.27281593205533],[0.622634990139567,-0.52512101923451,-1.17894374627975,-1.00200403161802],[0.424523856913341,-0.885498189297411,-1.06890899662697,-0.866598081399372],[0.820746123365793,-1.00562391265171,-1.12392637145336,-0.73119213118072],[0.820746123365793,-0.885498189297411,-1.23396112110614,-1.13740998183668],[0.820746123365793,-1.00562391265171,-1.28897849593253,-1.13740998183668],[1.01885725659202,-1.12574963600601,-1.23396112110614,-1.40822188227398],[0.622634990139567,-1.24587535936031,-0.958874246974196,-1.27281593205533],[-0.169809542765337,-1.84650397613181,-1.3990132455853,-1.40822188227398],[-1.16036520889647,-0.885498189297411,-0.353683123883925,-0.0541623800874605],[-1.35847634212269,-0.404995295880211,0.0314384999007934,-0.189568330306113],[-1.35847634212269,-0.404995295880211,0.0864558747271815,-0.0541623800874605],[-1.75469860857514,0.435884767599888,0.4715774985119,0.487461420787147],[-1.75469860857514,0.195633320891288,0.746664372643841,0.487461420787147],[-0.96225407567024,-0.404995295880211,0.416560123685511,0.0812435701311912],[-0.566031809217789,-0.164743849171611,0.4715774985119,0.216649520349843],[-0.764142942444014,-0.0446181258173116,0.14147324955357,0.0812435701311912],[-0.367920675991563,-0.284869572525912,-0.0235788749255949,0.216649520349843],[-0.566031809217789,-0.284869572525912,0.691646997817453,1.16449117188041],[-0.566031809217789,0.435884767599888,0.636629622991064,0.893679271443103],[-0.566031809217789,0.676136214308488,1.07676862160217,1.29989712209906],[-0.169809542765337,0.796261937662788,1.02175124677578,0.893679271443103],[0.0283015904608893,0.676136214308488,1.02175124677578,0.893679271443103],[0.226412723687115,0.796261937662788,0.801681747470229,1.16449117188041],[0.622634990139567,0.435884767599888,0.966733871949394,1.57070902253636],[0.0283015904608893,1.27676483107999,0.801681747470229,1.57070902253636],[-1.16036520889647,1.03651338437139,1.18680337125495,0.893679271443103],[-0.566031809217789,1.15663910772569,0.636629622991064,0.352055470568495],[-0.169809542765337,1.63714200114289,1.18680337125495,0.622867371005799],[-0.566031809217789,2.23777061791439,1.68195974469244,1.16449117188041],[1.41507952304447,2.47802206462299,1.51690762021328,1.16449117188041]],"x":[1,2,3,4],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35],"text":[["row: 17<br>column: Sepal.Width<br>value: 2.20752405594937","row: 17<br>column: Sepal.Length<br>value: -0.404995295880211","row: 17<br>column: Petal.Length<br>value: -1.23396112110614","row: 17<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 26<br>column: Sepal.Width<br>value: 1.6131906562707","row: 26<br>column: Sepal.Length<br>value: -0.52512101923451","row: 26<br>column: Petal.Length<br>value: -1.06890899662697","row: 26<br>column: Petal.Width<br>value: -1.00200403161802"],["row: 2<br>column: Sepal.Width<br>value: 1.41507952304447","row: 2<br>column: Sepal.Length<br>value: -0.885498189297411","row: 2<br>column: Petal.Length<br>value: -1.17894374627975","row: 2<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 31<br>column: Sepal.Width<br>value: 1.21696838981824","row: 31<br>column: Sepal.Length<br>value: -0.52512101923451","row: 31<br>column: Petal.Length<br>value: -1.17894374627975","row: 31<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 28<br>column: Sepal.Width<br>value: 0.622634990139567","row: 28<br>column: Sepal.Length<br>value: -0.52512101923451","row: 28<br>column: Petal.Length<br>value: -1.06890899662697","row: 28<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 13<br>column: Sepal.Width<br>value: 0.622634990139567","row: 13<br>column: Sepal.Length<br>value: -0.52512101923451","row: 13<br>column: Petal.Length<br>value: -1.17894374627975","row: 13<br>column: Petal.Width<br>value: -1.00200403161802"],["row: 12<br>column: Sepal.Width<br>value: 0.424523856913341","row: 12<br>column: Sepal.Length<br>value: -0.885498189297411","row: 12<br>column: Petal.Length<br>value: -1.06890899662697","row: 12<br>column: Petal.Width<br>value: -0.866598081399372"],["row: 11<br>column: Sepal.Width<br>value: 0.820746123365793","row: 11<br>column: Sepal.Length<br>value: -1.00562391265171","row: 11<br>column: Petal.Length<br>value: -1.12392637145336","row: 11<br>column: Petal.Width<br>value: -0.73119213118072"],["row: 24<br>column: Sepal.Width<br>value: 0.820746123365793","row: 24<br>column: Sepal.Length<br>value: -0.885498189297411","row: 24<br>column: Petal.Length<br>value: -1.23396112110614","row: 24<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 18<br>column: Sepal.Width<br>value: 0.820746123365793","row: 18<br>column: Sepal.Length<br>value: -1.00562391265171","row: 18<br>column: Petal.Length<br>value: -1.28897849593253","row: 18<br>column: Petal.Width<br>value: -1.13740998183668"],["row: 33<br>column: Sepal.Width<br>value: 1.01885725659202","row: 33<br>column: Sepal.Length<br>value: -1.12574963600601","row: 33<br>column: Petal.Length<br>value: -1.23396112110614","row: 33<br>column: Petal.Width<br>value: -1.40822188227398"],["row: 6<br>column: Sepal.Width<br>value: 0.622634990139567","row: 6<br>column: Sepal.Length<br>value: -1.24587535936031","row: 6<br>column: Petal.Length<br>value: -0.958874246974196","row: 6<br>column: Petal.Width<br>value: -1.27281593205533"],["row: 19<br>column: Sepal.Width<br>value: -0.169809542765337","row: 19<br>column: Sepal.Length<br>value: -1.84650397613181","row: 19<br>column: Petal.Length<br>value: -1.3990132455853","row: 19<br>column: Petal.Width<br>value: -1.40822188227398"],["row: 30<br>column: Sepal.Width<br>value: -1.16036520889647","row: 30<br>column: Sepal.Length<br>value: -0.885498189297411","row: 30<br>column: Petal.Length<br>value: -0.353683123883925","row: 30<br>column: Petal.Width<br>value: -0.0541623800874605"],["row: 4<br>column: Sepal.Width<br>value: -1.35847634212269","row: 4<br>column: Sepal.Length<br>value: -0.404995295880211","row: 4<br>column: Petal.Length<br>value: 0.0314384999007934","row: 4<br>column: Petal.Width<br>value: -0.189568330306113"],["row: 15<br>column: Sepal.Width<br>value: -1.35847634212269","row: 15<br>column: Sepal.Length<br>value: -0.404995295880211","row: 15<br>column: Petal.Length<br>value: 0.0864558747271815","row: 15<br>column: Petal.Width<br>value: -0.0541623800874605"],["row: 25<br>column: Sepal.Width<br>value: -1.75469860857514","row: 25<br>column: Sepal.Length<br>value: 0.435884767599888","row: 25<br>column: Petal.Length<br>value: 0.4715774985119","row: 25<br>column: Petal.Width<br>value: 0.487461420787147"],["row: 14<br>column: Sepal.Width<br>value: -1.75469860857514","row: 14<br>column: Sepal.Length<br>value: 0.195633320891288","row: 14<br>column: Petal.Length<br>value: 0.746664372643841","row: 14<br>column: Petal.Width<br>value: 0.487461420787147"],["row: 35<br>column: Sepal.Width<br>value: -0.96225407567024","row: 35<br>column: Sepal.Length<br>value: -0.404995295880211","row: 35<br>column: Petal.Length<br>value: 0.416560123685511","row: 35<br>column: Petal.Width<br>value: 0.0812435701311912"],["row: 5<br>column: Sepal.Width<br>value: -0.566031809217789","row: 5<br>column: Sepal.Length<br>value: -0.164743849171611","row: 5<br>column: Petal.Length<br>value: 0.4715774985119","row: 5<br>column: Petal.Width<br>value: 0.216649520349843"],["row: 8<br>column: Sepal.Width<br>value: -0.764142942444014","row: 8<br>column: Sepal.Length<br>value: -0.0446181258173116","row: 8<br>column: Petal.Length<br>value: 0.14147324955357","row: 8<br>column: Petal.Width<br>value: 0.0812435701311912"],["row: 9<br>column: Sepal.Width<br>value: -0.367920675991563","row: 9<br>column: Sepal.Length<br>value: -0.284869572525912","row: 9<br>column: Petal.Length<br>value: -0.0235788749255949","row: 9<br>column: Petal.Width<br>value: 0.216649520349843"],["row: 21<br>column: Sepal.Width<br>value: -0.566031809217789","row: 21<br>column: Sepal.Length<br>value: -0.284869572525912","row: 21<br>column: Petal.Length<br>value: 0.691646997817453","row: 21<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 16<br>column: Sepal.Width<br>value: -0.566031809217789","row: 16<br>column: Sepal.Length<br>value: 0.435884767599888","row: 16<br>column: Petal.Length<br>value: 0.636629622991064","row: 16<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 10<br>column: Sepal.Width<br>value: -0.566031809217789","row: 10<br>column: Sepal.Length<br>value: 0.676136214308488","row: 10<br>column: Petal.Length<br>value: 1.07676862160217","row: 10<br>column: Petal.Width<br>value: 1.29989712209906"],["row: 34<br>column: Sepal.Width<br>value: -0.169809542765337","row: 34<br>column: Sepal.Length<br>value: 0.796261937662788","row: 34<br>column: Petal.Length<br>value: 1.02175124677578","row: 34<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 20<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 20<br>column: Sepal.Length<br>value: 0.676136214308488","row: 20<br>column: Petal.Length<br>value: 1.02175124677578","row: 20<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 7<br>column: Sepal.Width<br>value: 0.226412723687115","row: 7<br>column: Sepal.Length<br>value: 0.796261937662788","row: 7<br>column: Petal.Length<br>value: 0.801681747470229","row: 7<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 22<br>column: Sepal.Width<br>value: 0.622634990139567","row: 22<br>column: Sepal.Length<br>value: 0.435884767599888","row: 22<br>column: Petal.Length<br>value: 0.966733871949394","row: 22<br>column: Petal.Width<br>value: 1.57070902253636"],["row: 32<br>column: Sepal.Width<br>value: 0.0283015904608893","row: 32<br>column: Sepal.Length<br>value: 1.27676483107999","row: 32<br>column: Petal.Length<br>value: 0.801681747470229","row: 32<br>column: Petal.Width<br>value: 1.57070902253636"],["row: 3<br>column: Sepal.Width<br>value: -1.16036520889647","row: 3<br>column: Sepal.Length<br>value: 1.03651338437139","row: 3<br>column: Petal.Length<br>value: 1.18680337125495","row: 3<br>column: Petal.Width<br>value: 0.893679271443103"],["row: 23<br>column: Sepal.Width<br>value: -0.566031809217789","row: 23<br>column: Sepal.Length<br>value: 1.15663910772569","row: 23<br>column: Petal.Length<br>value: 0.636629622991064","row: 23<br>column: Petal.Width<br>value: 0.352055470568495"],["row: 29<br>column: Sepal.Width<br>value: -0.169809542765337","row: 29<br>column: Sepal.Length<br>value: 1.63714200114289","row: 29<br>column: Petal.Length<br>value: 1.18680337125495","row: 29<br>column: Petal.Width<br>value: 0.622867371005799"],["row: 1<br>column: Sepal.Width<br>value: -0.566031809217789","row: 1<br>column: Sepal.Length<br>value: 2.23777061791439","row: 1<br>column: Petal.Length<br>value: 1.68195974469244","row: 1<br>column: Petal.Width<br>value: 1.16449117188041"],["row: 27<br>column: Sepal.Width<br>value: 1.41507952304447","row: 27<br>column: Sepal.Length<br>value: 2.47802206462299","row: 27<br>column: Petal.Length<br>value: 1.51690762021328","row: 27<br>column: Petal.Width<br>value: 1.16449117188041"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":["#440154FF","#440256FF","#450457FF","#450559FF","#46075AFF","#46085CFF","#460A5DFF","#460B5EFF","#470D60FF","#470E61FF","#471063FF","#471164FF","#471365FF","#481467FF","#481668FF","#481769FF","#48186AFF","#481A6CFF","#481B6DFF","#481C6EFF","#481D6FFF","#481F70FF","#482071FF","#482173FF","#482374FF","#482475FF","#482576FF","#482677FF","#482878FF","#482979FF","#472A7AFF","#472C7AFF","#472D7BFF","#472E7CFF","#472F7DFF","#46307EFF","#46327EFF","#46337FFF","#463480FF","#453581FF","#453781FF","#453882FF","#443983FF","#443A83FF","#443B84FF","#433D84FF","#433E85FF","#423F85FF","#424086FF","#424186FF","#414287FF","#414487FF","#404588FF","#404688FF","#3F4788FF","#3F4889FF","#3E4989FF","#3E4A89FF","#3E4C8AFF","#3D4D8AFF","#3D4E8AFF","#3C4F8AFF","#3C508BFF","#3B518BFF","#3B528BFF","#3A538BFF","#3A548CFF","#39558CFF","#39568CFF","#38588CFF","#38598CFF","#375A8CFF","#375B8DFF","#365C8DFF","#365D8DFF","#355E8DFF","#355F8DFF","#34608DFF","#34618DFF","#33628DFF","#33638DFF","#32648EFF","#32658EFF","#31668EFF","#31678EFF","#31688EFF","#30698EFF","#306A8EFF","#2F6B8EFF","#2F6C8EFF","#2E6D8EFF","#2E6E8EFF","#2E6F8EFF","#2D708EFF","#2D718EFF","#2C718EFF","#2C728EFF","#2C738EFF","#2B748EFF","#2B758EFF","#2A768EFF","#2A778EFF","#2A788EFF","#29798EFF","#297A8EFF","#297B8EFF","#287C8EFF","#287D8EFF","#277E8EFF","#277F8EFF","#27808EFF","#26818EFF","#26828EFF","#26828EFF","#25838EFF","#25848EFF","#25858EFF","#24868EFF","#24878EFF","#23888EFF","#23898EFF","#238A8DFF","#228B8DFF","#228C8DFF","#228D8DFF","#218E8DFF","#218F8DFF","#21908DFF","#21918CFF","#20928CFF","#20928CFF","#20938CFF","#1F948CFF","#1F958BFF","#1F968BFF","#1F978BFF","#1F988BFF","#1F998AFF","#1F9A8AFF","#1E9B8AFF","#1E9C89FF","#1E9D89FF","#1F9E89FF","#1F9F88FF","#1FA088FF","#1FA188FF","#1FA187FF","#1FA287FF","#20A386FF","#20A486FF","#21A585FF","#21A685FF","#22A785FF","#22A884FF","#23A983FF","#24AA83FF","#25AB82FF","#25AC82FF","#26AD81FF","#27AD81FF","#28AE80FF","#29AF7FFF","#2AB07FFF","#2CB17EFF","#2DB27DFF","#2EB37CFF","#2FB47CFF","#31B57BFF","#32B67AFF","#34B679FF","#35B779FF","#37B878FF","#38B977FF","#3ABA76FF","#3BBB75FF","#3DBC74FF","#3FBC73FF","#40BD72FF","#42BE71FF","#44BF70FF","#46C06FFF","#48C16EFF","#4AC16DFF","#4CC26CFF","#4EC36BFF","#50C46AFF","#52C569FF","#54C568FF","#56C667FF","#58C765FF","#5AC864FF","#5CC863FF","#5EC962FF","#60CA60FF","#63CB5FFF","#65CB5EFF","#67CC5CFF","#69CD5BFF","#6CCD5AFF","#6ECE58FF","#70CF57FF","#73D056FF","#75D054FF","#77D153FF","#7AD151FF","#7CD250FF","#7FD34EFF","#81D34DFF","#84D44BFF","#86D549FF","#89D548FF","#8BD646FF","#8ED645FF","#90D743FF","#93D741FF","#95D840FF","#98D83EFF","#9BD93CFF","#9DD93BFF","#A0DA39FF","#A2DA37FF","#A5DB36FF","#A8DB34FF","#AADC32FF","#ADDC30FF","#B0DD2FFF","#B2DD2DFF","#B5DE2BFF","#B8DE29FF","#BADE28FF","#BDDF26FF","#C0DF25FF","#C2DF23FF","#C5E021FF","#C8E020FF","#CAE11FFF","#CDE11DFF","#D0E11CFF","#D2E21BFF","#D5E21AFF","#D8E219FF","#DAE319FF","#DDE318FF","#DFE318FF","#E2E418FF","#E5E419FF","#E7E419FF","#EAE51AFF","#ECE51BFF","#EFE51CFF","#F1E51DFF","#F4E61EFF","#F6E620FF","#F8E621FF","#FBE723FF","#FDE725FF"],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>

---

# Visualización previa

Otra forma de ver las relaciones entre individuos es calcular su **matriz de distancias** con `dist()`, indicándole en `method = ...` el tipo de métrica.



```r
d &lt;- dist(iris_sample %&gt;%
            select(-Species) %&gt;% 
            mutate(across(where(is.numeric), ~scale(.))),
          method = "euclidean")
d
```

```
&gt;            1         2         3         4         5         6         7
&gt; 2  5.2118258                                                            
&gt; 3  1.4542249 4.4776252                                                  
&gt; 4  3.4885352 3.2073235 2.1506949                                        
&gt; 5  2.8522806 3.0003311 1.6631802 1.0219708                              
&gt; 6  5.1442383 0.9080779 4.2054752 2.6050002 2.6165767                    
&gt; 7  1.8656916 3.6691787 1.4840928 2.5261916 1.5996478 3.6561373          
&gt; 8  2.9656484 2.9469828 1.7545952 0.7540230 0.4254196 2.5318795 1.8159241
&gt; 9  3.1953446 2.5900173 2.0730209 1.0787356 0.5466791 2.2356246 1.7611179
&gt; 10 1.6802658 4.1703967 0.8125420 2.2600965 1.4989199 3.9836857 0.8581411
&gt; 11 4.8897212 0.7319168 4.0093398 2.5957638 2.4646032 0.6461945 3.3017581
&gt; 12 4.7358854 1.0327862 3.7937866 2.2536873 2.2466000 0.5884219 3.2391354
&gt; 13 4.6824106 0.8810078 3.8481380 2.4625818 2.3983614 0.8007849 3.2433970
&gt; 14 2.6299050 4.1910038 1.1912375 1.2196984 1.3006969 3.7063595 2.1787503
&gt; 15 3.4121737 3.2708037 2.0558122 0.1461564 0.9525476 2.6850909 2.4395813
&gt; 16 2.1006777 3.6183539 1.0083046 1.6955027 0.9199816 3.3883005 0.9265103
&gt; 17 5.3962843 0.9381967 4.8963688 3.9358634 3.5885515 1.8151103 3.9309196
&gt; 18 5.1544140 0.6162548 4.2836837 2.7841821 2.7501394 0.4735740 3.6427509
&gt; 19 5.7401688 1.8860475 4.6128284 2.6499405 3.0206996 1.0958012 4.3131328
&gt; 20 1.8169063 3.6510597 1.2530134 2.2904460 1.3495821 3.5586429 0.4188650
&gt; 21 2.7100614 3.6171004 1.5549289 1.7063853 0.9804410 3.3167977 1.3449615
&gt; 22 2.3100395 3.7831022 2.0116273 2.9334681 1.9627380 3.8238617 0.6921842
&gt; 23 1.7092724 3.6891653 0.9816873 1.9303583 1.3385178 3.5172211 1.2021373
&gt; 24 5.0477029 0.5968744 4.1957544 2.7348736 2.6804811 0.5129593 3.5530466
&gt; 25 2.5657583 4.1422185 1.1792150 1.2313257 1.3590521 3.6911788 2.1498865
&gt; 26 4.9642281 0.4467238 4.3374149 3.2735380 2.9558581 1.2594182 3.4441279
&gt; 27 2.0024398 4.8866790 2.9821420 4.4771081 3.5916755 5.1541578 2.1800903
&gt; 28 4.7491308 0.8878527 3.9242492 2.5146416 2.4767734 0.7291052 3.3678807
&gt; 29 1.0277563 4.1917684 1.1896614 2.7528482 2.0199866 4.1397228 1.1426926
&gt; 30 3.9669886 2.9133136 2.6392482 0.6608967 1.2755835 2.2716369 2.7516276
&gt; 31 4.9937856 0.4329602 4.2872926 3.0472605 2.8725753 0.9597654 3.5483231
&gt; 32 1.4888474 4.2255556 1.4412971 2.9057394 2.0913215 4.2310917 0.6596545
&gt; 33 5.3802034 0.5395172 4.5368758 3.0426230 2.9974113 0.5151988 3.8839144
&gt; 34 1.6565487 3.7826674 1.0325519 2.2383236 1.3570500 3.6626318 0.5279789
&gt; 35 3.1489467 3.1485468 1.8358981 0.6153453 0.4858750 2.6351944 2.0439402
&gt;            8         9        10        11        12        13        14
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9  0.5101861                                                            
&gt; 10 1.7083995 1.8294726                                                  
&gt; 11 2.3867747 2.0103691 3.7040319                                        
&gt; 12 2.1174128 1.8041240 3.5661655 0.4390717                              
&gt; 13 2.2518798 1.9644098 3.6390844 0.5886400 0.4467238                    
&gt; 14 1.2530724 1.6794790 1.5533294 3.6138844 3.3237990 3.4781713          
&gt; 15 0.7102574 1.0397487 2.1473263 2.6520105 2.3248425 2.5374933 1.1166819
&gt; 16 1.0841414 1.2053959 0.6453341 3.1210359 2.9554512 3.0374961 1.2836550
&gt; 17 3.5617374 3.2141684 4.5628699 1.6091525 1.8979536 1.6132791 4.8043123
&gt; 18 2.6394534 2.3167065 4.0359256 0.4384691 0.5414720 0.5482458 3.8548649
&gt; 19 2.8621025 2.6476361 4.4703590 1.4907454 1.2957968 1.6085598 3.8574273
&gt; 20 1.6069836 1.6222233 0.7219917 3.2711504 3.1725590 3.1988943 1.9106696
&gt; 21 1.2542270 1.2038272 1.0441195 3.0549242 2.9269158 3.1086107 1.4509335
&gt; 22 2.2480210 2.0772298 1.2474359 3.4331916 3.4452299 3.4851567 2.6327347
&gt; 23 1.3419336 1.6035602 1.1502214 3.2971984 3.0895799 3.0612138 1.5384743
&gt; 24 2.5682463 2.2521514 3.9549707 0.4376651 0.5075169 0.4364418 3.7900983
&gt; 25 1.2190428 1.6616735 1.5801764 3.5695395 3.2713360 3.3938142 0.3652308
&gt; 26 2.9190835 2.5613189 4.0118214 0.9670664 1.2494540 0.9966485 4.1685704
&gt; 27 3.7653644 3.7528872 2.7172876 4.8017331 4.8068951 4.6484570 4.0383704
&gt; 28 2.3350671 2.0856998 3.7521637 0.7526714 0.5780421 0.2923127 3.5448674
&gt; 29 2.1371993 2.3159047 1.2453920 3.8908047 3.7448219 3.6797169 2.1913187
&gt; 30 1.0618785 1.0821418 2.5829447 2.2340269 1.9192377 2.2109772 1.7395972
&gt; 31 2.7807667 2.4744635 4.0409404 0.8271991 0.9669336 0.6531242 4.0195565
&gt; 32 2.2424103 2.2605810 0.9289773 3.8527889 3.7778233 3.7605524 2.3504015
&gt; 33 2.9083091 2.5952774 4.2932559 0.7239856 0.8553078 0.8281224 4.1176641
&gt; 34 1.5796369 1.6610773 0.5826338 3.3870537 3.2635848 3.2879621 1.7644585
&gt; 35 0.4947651 0.7613931 1.8018960 2.5637853 2.2932637 2.4990721 1.1237014
&gt;           15        16        17        18        19        20        21
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9                                                                       
&gt; 10                                                                      
&gt; 11                                                                      
&gt; 12                                                                      
&gt; 13                                                                      
&gt; 14                                                                      
&gt; 15                                                                      
&gt; 16 1.5925271                                                            
&gt; 17 3.9931161 4.0733896                                                  
&gt; 18 2.8591975 3.4401149 1.5183114                                        
&gt; 19 2.7442616 3.8482309 2.7884116 1.3318133                              
&gt; 20 2.2057152 0.7478446 3.9622968 3.5945905 4.1906815                    
&gt; 21 1.5791679 0.7719150 4.1659903 3.4152988 3.6858387 1.2079206          
&gt; 22 2.8367196 1.4072195 4.0184133 3.8130489 4.5064460 0.9339963 1.4741443
&gt; 23 1.8799932 0.9015781 4.0336870 3.5390689 4.0519475 1.0128130 1.6556044
&gt; 24 2.8101281 3.3606010 1.4738965 0.1321253 1.4160911 3.5043162 3.3601523
&gt; 25 1.1426926 1.2669585 4.7343137 3.8013981 3.8488825 1.9247116 1.5617988
&gt; 26 3.3284391 3.4892721 0.6842833 0.9620898 2.2801589 3.4524437 3.5496465
&gt; 27 4.4199219 2.9905443 4.7378795 5.0656458 6.0278392 2.3427472 3.4984893
&gt; 28 2.5998494 3.1526218 1.5979818 0.5804278 1.5815577 3.2955747 3.2420168
&gt; 29 2.6930257 1.4057173 4.3904163 4.1465027 4.7903612 1.0311942 2.0951508
&gt; 30 0.6810678 1.9945948 3.7193503 2.4469236 2.1979365 2.5771795 1.8143369
&gt; 31 3.1198876 3.4774459 0.9993286 0.6467747 1.9328661 3.5203278 3.5603913
&gt; 32 2.8112676 1.2433515 4.4504835 4.1883213 4.8488291 0.9314261 1.7230945
&gt; 33 3.1222076 3.7078881 1.3966926 0.3606164 1.3998778 3.8229544 3.6804581
&gt; 34 2.1515411 0.6596836 4.1081229 3.7003768 4.2594673 0.2316856 1.2280657
&gt; 35 0.5331938 1.2540150 3.8216738 2.8167043 2.8671815 1.7822329 1.1918559
&gt;           22        23        24        25        26        27        28
&gt; 2                                                                       
&gt; 3                                                                       
&gt; 4                                                                       
&gt; 5                                                                       
&gt; 6                                                                       
&gt; 7                                                                       
&gt; 8                                                                       
&gt; 9                                                                       
&gt; 10                                                                      
&gt; 11                                                                      
&gt; 12                                                                      
&gt; 13                                                                      
&gt; 14                                                                      
&gt; 15                                                                      
&gt; 16                                                                      
&gt; 17                                                                      
&gt; 18                                                                      
&gt; 19                                                                      
&gt; 20                                                                      
&gt; 21                                                                      
&gt; 22                                                                      
&gt; 23 1.8778980                                                            
&gt; 24 3.7366118 3.4367273                                                  
&gt; 25 2.6590074 1.4064112 3.7320286                                        
&gt; 26 3.5591329 3.5099383 0.8963353 4.1058271                              
&gt; 27 2.2947761 2.6656699 4.9530322 3.9710077 4.5208700                    
&gt; 28 3.6267076 3.1289479 0.4633538 3.4708676 1.0269078 4.7195074          
&gt; 29 1.7371879 0.8740168 4.0377706 2.1177288 3.9475203 1.9029655 3.7396796
&gt; 30 3.0510409 2.3810269 2.4234514 1.7531961 3.0384923 4.7885708 2.3033944
&gt; 31 3.7371555 3.4559978 0.5551806 3.9467878 0.4923808 4.7187071 0.6044335
&gt; 32 1.0428584 1.3711386 4.0964741 2.2734474 3.9845487 2.0106549 3.8967639
&gt; 33 4.0389085 3.7840267 0.4126837 4.0784545 0.9519675 5.2278384 0.7505490
&gt; 34 1.1041903 0.8535448 3.6087504 1.7633630 3.5902114 2.3788042 3.3820974
&gt; 35 2.3958612 1.6484732 2.7603097 1.2260047 3.1666054 4.0432282 2.5624986
&gt;           29        30        31        32        33        34
&gt; 2                                                             
&gt; 3                                                             
&gt; 4                                                             
&gt; 5                                                             
&gt; 6                                                             
&gt; 7                                                             
&gt; 8                                                             
&gt; 9                                                             
&gt; 10                                                            
&gt; 11                                                            
&gt; 12                                                            
&gt; 13                                                            
&gt; 14                                                            
&gt; 15                                                            
&gt; 16                                                            
&gt; 17                                                            
&gt; 18                                                            
&gt; 19                                                            
&gt; 20                                                            
&gt; 21                                                            
&gt; 22                                                            
&gt; 23                                                            
&gt; 24                                                            
&gt; 25                                                            
&gt; 26                                                            
&gt; 27                                                            
&gt; 28                                                            
&gt; 29                                                            
&gt; 30 3.1900442                                                  
&gt; 31 3.9735260 2.8191769                                        
&gt; 32 1.1026523 3.1722839 4.0826747                              
&gt; 33 4.3625593 2.7230677 0.6491259 4.4464759                    
&gt; 34 0.8986994 2.5689961 3.6340014 0.8814368 3.9362475          
&gt; 35 2.3843079 0.9390104 3.0236651 2.4852251 3.0638239 1.7599134
```

---

# Visualización previa

.pull-left[

Con `fviz_dist()` podremos visualizar dicha matriz de distancias.


```r
fviz_dist(d, show_labels = TRUE)
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-105-1.png" width="100%" /&gt;

]


---

name: jerarquicos
class: center, middle

# Algoritmos jerárquicos

---

# Algoritmos jerárquicos: simple

.pull-left[

En nuestro caso empezaremos usando solo **algoritmos aglomerativos**, de forma que empezaremos con un clúster por individuo, e iremos **juntando clúster** en base a distintos enlaces

* **Enlace simple (single)** o del vecino más cercano: la distancia entre dos clústeres será definida como la **distancia mínima** entre pares de observaciones (cada una perteneciente a uno de los dos clústeres)

`$$d(C_k, C_l) = \min_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, cex = 1) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-107-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: simple

.pull-left[

Con `cutree()` podemos indicarle el corte del número de clústers que queremos


```r
single_clust &lt;-
  hclust(d, method = "single")

# Seleccionamos 3 clusters
groups &lt;- cutree(single_clust, k = 3)
```

Con `fviz_dend()` podemos visualizar el dendograma


```r
# k = 3
fviz_dend(single_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (simple)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-110-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: simple

.pull-left[

Con `fviz_cluster()` visualizaremos los clústers en base a las dos componentes que más varianza capturen


```r
# Estandarizamos datos
iris_scale &lt;-
  iris_sample %&gt;%
  select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-112-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: simple

.pull-left[

Así quedaría con todas las observaciones


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")
groups &lt;- cutree(single_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (single)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-114-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: complete

.pull-left[

* **Enlace completo (complete)** o del vecino más alejado (complete): la distancia entre dos clústeres será definida como la **distancia máxima** entre pares de observaciones (cada una perteneciente a uno de los dos clústeres)

`$$d(C_k, C_l) = \max_{x_i \in C_k, x_j \in C_l} d(x_i, x_j)$$`


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# k = 3
fviz_dend(complete_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-116-1.png" width="100%" /&gt;

]


---

# Algoritmos jerárquicos: complete

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
complete_clust &lt;-
  hclust(d, method = "complete")
groups &lt;- cutree(complete_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (complete)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-118-1.png" width="100%" /&gt;

]


---

# Algoritmos jerárquicos: average

.pull-left[

* **Enlace medio (average)**: la distancia entre dos clústeres será definida como la **distancia media** entre observaciones de distintos grupos

`$$d(C_k, C_l) = \frac{\sum_{x_i \in C_k} \sum_{x_j \in C_l} d(x_i, x_j)}{n_k n_l}$$`

siendo `\(n_k\)` el número de elementos del clúster `\(C_k\)`.


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# k = 3
fviz_dend(average_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-120-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: average

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (single)
average_clust &lt;-
  hclust(d, method = "average")
groups &lt;- cutree(average_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (average)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-122-1.png" width="100%" /&gt;

]


---

# Algoritmos jerárquicos: centroid

.pull-left[

* **Distancia entre centroides** (centroid): la distancia entre dos clústeres será definida como la distancia entre los centroides de cada grupo.

`$$d(C_k, C_l) = d(\overline{x}_k, \overline{x}_l)$$`

donde `\(\overline{x}_k = \frac{\sum_{x_k \in C_k} x_{k}}{n_k}\)`



```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")

# k = 3
fviz_dend(centroid_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (centroid)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-124-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: centroid

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")
groups &lt;- cutree(centroid_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (centroid)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-126-1.png" width="100%" /&gt;

]


---

# Algoritmos jerárquicos: Ward

.pull-left[


* **Método de Ward** (mínima varianza): de todas las posibles aglomeraciones, selecciona aquella que **minimiza la variabilidad interna**


`$$W = \sum_{k=1}^{G} W_k, \quad W_k = \sum_{\boldsymbol{X_i} \in C_k} \sum_{j=1}^{p} \left(x_{i,j} - \overline{x}_{j}^{k} \right)$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-ésima del centroide `\(k\)`.


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# k = 3
fviz_dend(ward_clust, k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-128-1.png" width="100%" /&gt;

]

---

# Algoritmos jerárquicos: Ward

.pull-left[


```r
# Estandarizamos
iris_scale &lt;-
  iris %&gt;% select(-Species) %&gt;% 
  mutate(across(where(is.numeric),
                ~scale(.)))

# Matriz de distancias
d &lt;-
  dist(iris_scale, method = "euclidean")

# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 3)

fviz_cluster(list(data = iris_scale,
                  cluster = groups),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (Ward)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-130-1.png" width="100%" /&gt;

]

---

# Ejemplo de jerárquico divisivo

.pull-left[

El paquete `{cluster}` nos permite implementar el **algoritmo de clustering jerárquico divisivo** más famoso, **DIANA (DIvisive ANAlysis Clustering)**. En cada iteración se seleccionará el **clúster con mayor diametro** (la mayor de las diferencias entre dos de sus observaciones) y se identificará la observación más alejada (en promedio) del resto de observaciones, siendo esta observación la que inicia el nuevo clúster. 



```r
library(cluster)
hc_diana &lt;- diana(x = d, diss = TRUE, stand = FALSE)

fviz_dend(hc_diana , k = 3,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB", "#E7B800"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (DIANA, divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-132-1.png" width="100%" /&gt;


]

---


name: no-jerarquicos
class: center, middle

# Algoritmos no jerárquicos

---

# Algoritmo k-means

Dentro de los no jerárquicos nos centraremos en el **algoritmo k-means** (o algoritmo de Lloyd), basado en encontrar los `\(k\)` mejores clústers, entiendo como mejor clúster aquel cuya **varianza interna sea lo más pequeña posible**

1. **Seleccionaremos `\(k\)` puntos iniciales** (tantos cómo número de clústers) aleatorios de nuestro espacio (no tienen porque ser observaciones)  que definiran los **centroides** de nuestros clústers `\(\left\lbrace C_1, C_2, \ldots, C_k \right\rbrace\)`

2. Asignaremos **cada observación a su clúster más cercano**, entendiendo como clúster más cercano aquel cuyo centroide tiene más cerca (diagrama de Voronoi)

3. Una vez formado el clúster, **recalcularemos los `\(k\)` centroides** (cómo las coordenadas medias de las observaciones agrupadas en dichos clústers)

4. Se **repiten los pasos 2. y 3.** hasta que no haya ningún cambio en los clúster, hasta que no hayan movido los centroides por encima de una tolerancia o hasta que se haya llegado a un número máximo de iteraciones

---

# Algoritmo k-means

En dicho algoritmo se deberán tomar dos decisiones:

* La métrica usada para medir la distancia entre los individuos (normalmente la Euclídea)

* **Selección inicial de los `\(k\)` centroides**:
  - Seleccionar las `\(k\)` primeras observaciones
  - Seleccionar la primera observación como primer centroide, y el centroide i-ésimo como aquella observación cuya distancia a los `\(i-1\)` centroides previos sea tan grande como una distancia predefinida.
  - Seleccionar `\(k\)` observaciones aleatorias.
  - Seleccionar `\(k\)` observaciones en base a conocimiento experto.

---

# Algoritmo k-means con R


Vamos a generar un **conjunto aleatorio bidimensional**.


```r
centers &lt;- tibble(cluster = factor(1:3), num_points =  c(100, 150, 50),
                  x = c(5, 0, -3), y = c(-1, 1, -2))
centers
```

```
&gt; # A tibble: 3 × 4
&gt;   cluster num_points     x     y
&gt;   &lt;fct&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
&gt; 1 1              100     5    -1
&gt; 2 2              150     0     1
&gt; 3 3               50    -3    -2
```

```r
set.seed(1234567)
labelled_points &lt;- centers %&gt;% mutate(x = map2(num_points, x, rnorm), y = map2(num_points, y, rnorm)) %&gt;% 
  select(-num_points) %&gt;%  unnest(cols = c(x, y))
labelled_points
```

```
&gt; # A tibble: 300 × 3
&gt;    cluster     x      y
&gt;    &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 1        5.16 -1.32 
&gt;  2 1        6.37 -0.642
&gt;  3 1        5.73 -0.975
&gt;  4 1        3.65  0.559
&gt;  5 1        4.99 -0.379
&gt;  6 1        5.32 -0.760
&gt;  7 1        3.22  0.148
&gt;  8 1        5.91 -2.79 
&gt;  9 1        4.08 -1.28 
&gt; 10 1        4.84 -1.63 
&gt; # … with 290 more rows
```

---

# Algoritmo k-means con R

.pull-left[


```r
ggplot(labelled_points,
       aes(x = x, y = y, color = cluster)) +
  geom_point(alpha = 0.5, size = 5) +
  labs(x = "Coordenada X",
       y = "Coordenada Y",
       title = "Datos simulados")
```
  
]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-135-1.png" width="100%" /&gt;
  
]

---

# Algoritmo k-means con R

Para realizar el clustering basta usar la función `kmeans()`, indicándole el **número de clústers** y el **número máximo de iteraciones**


```r
kclust &lt;- kmeans(labelled_points %&gt;% select(-cluster),
                 centers = 3, iter.max = 50)
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 101, 149, 50
&gt; 
&gt; Cluster means:
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [75] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
&gt; [112] 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt; [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1
&gt; [186] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 2 2 2
&gt; [223] 2 2 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 2 3 3 3 3 3 3
&gt; [260] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 2
&gt; [297] 3 3 3 3
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 172.8228 280.8962 107.8477
&gt;  (between_SS / total_SS =  83.5 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[

Los grupos están guardados en `kclust$cluster` y los centroides en `kclust$centers`


```r
kclust$centers
```

```
&gt;            x          y
&gt; 1  4.9032846 -0.9643320
&gt; 2 -0.0495747  0.9773762
&gt; 3 -2.8262464 -1.9751003
```


```r
fviz_cluster(list(data =
                    labelled_points %&gt;%
                    select(-cluster),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-139-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-140-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-141-1.png" width="100%" /&gt;

]

---

# Algoritmo k-means con R

Podemos también implementar el k-means para nuestro conjunto conocido `iris`



```r
kclust &lt;- kmeans(iris %&gt;% select(-Species),
                 centers = 3, iter.max = 50)
kclust$centers
```

```
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
```

```r
kclust
```

```
&gt; K-means clustering with 3 clusters of sizes 50, 62, 38
&gt; 
&gt; Cluster means:
&gt;   Sepal.Length Sepal.Width Petal.Length Petal.Width
&gt; 1     5.006000    3.428000     1.462000    0.246000
&gt; 2     5.901613    2.748387     4.393548    1.433871
&gt; 3     6.850000    3.073684     5.742105    2.071053
&gt; 
&gt; Clustering vector:
&gt;   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
&gt;  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
&gt;  [75] 2 2 2 3 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 2 3 3 3 3 2 3 3 3 3
&gt; [112] 3 3 2 2 3 3 3 3 2 3 2 3 2 3 3 2 2 3 3 3 3 3 2 3 3 3 3 2 3 3 3 2 3 3 3 2 3
&gt; [149] 3 2
&gt; 
&gt; Within cluster sum of squares by cluster:
&gt; [1] 15.15100 39.82097 23.87947
&gt;  (between_SS / total_SS =  88.4 %)
&gt; 
&gt; Available components:
&gt; 
&gt; [1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
&gt; [6] "betweenss"    "size"         "iter"         "ifault"
```

---

# Algoritmo k-means con R

.pull-left[


```r
fviz_cluster(list(data =
                    iris %&gt;%
                    select(-Species),
                  cluster = kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB", "#E7B800"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

Recordatorio: de la 1 a la 50 son setosa, de la 51 a la 100 son versicolor, y de la 101 a la 151 virginica. 

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-144-1.png" width="100%" /&gt;

]


---

name: n-grupos
class: center, middle

# Determinación del número de grupos

---

# Determinación del número de grupos

Hasta ahora **hemos hecho «trampas»** ya que el **número de clústers se lo hemos indicado a priori**, en un caso porque hemos simulado nosotros los datos, y en otro caso porque es un conjunto del que conocemos su etiqueta (aprendizaje supervisado).

Para decidir el **número de clúster óptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias métricas** a nuestra disposición

* **Variabilidad total**

`$$T = \sum_{j=1}^{p} \sum_{i=1}^{n} \left(x_{ij} - \overline{x}_j \right)^2$$`

donde `\(\overline{x}_j  = \frac{\sum_{i=1}^{n} x_{ij}}{n}\)`


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinación del número de grupos


* **Variabilidad del clúster `\(C_k\)`**

`$$W_k = \sum_{j=1}^{p} \sum_{\boldsymbol{X}_i \in C_k} \left(x_{ij} - \overline{x}_{j}^{k} \right)^2$$`

donde `\(\overline{x}_{j}^{k}\)` es la coordenada j-ésima del centroide `\(k\)`.


```r
kclust$withinss
```

```
&gt; [1] 15.15100 39.82097 23.87947
```

* **Variabilidad total intra-clústeres**

`$$W = \sum_{k=1}^{K} W_k$$`


```r
kclust$tot.withinss
```

```
&gt; [1] 78.85144
```

---

# Determinación del número de grupos


Para decidir el **número de clúster óptimo** (recuerda que estamos en aprendizaje NO supervisado, no sabemos a priori la etiqueta de los datos), tenemos **varias métricas** a nuestra disposición


* **Variabilidad total entre-clústeres**

`$$E = \sum_{k=1}^{K} \sum_{j=1}^{p} \left( \overline{x}_{j}^{k} - \overline{x}_j  \right)^2$$`

tal que `\(T = W + E\)`


```r
kclust$betweenss
```

```
&gt; [1] 602.5192
```


```r
kclust$betweenss + kclust$tot.withinss
```

```
&gt; [1] 681.3706
```


```r
kclust$totss
```

```
&gt; [1] 681.3706
```

---

# Determinación del número de grupos

.pull-left[

Para decidir el **número óptimo** se usan principalmente dos métodos:

* Basado en la **variabilidad total intra-clústeres (W)**:



```r
fviz_nbclust(iris_scale, kmeans,
             method = "wss") +
  geom_vline(xintercept = 3,
             linetype = 2) +
  theme_minimal() +
  labs(x = "nº clústeres (k)",
       y = "Variabilidad total intra-clústeres (W)",
       title = "Número óptimo basado en variabilidad total intra-clústeres")
```

Con el **«método del codo» (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el número de clústers.

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-152-1.png" width="100%" /&gt;


]

---

# Determinación del número de grupos

.pull-left[

Así sería para el conjunto de datos simulados

&lt;img src="index_files/figure-html/unnamed-chunk-153-1.png" width="100%" /&gt;

]

.pull-right[


```r
fviz_nbclust(labelled_points %&gt;% select(-cluster),
             kmeans, method = "wss") +
  geom_vline(xintercept = 3, linetype = 2) +
  theme_minimal() +
  labs(x = "nº clústeres (k)",
       y = "Variabilidad total intra-clústeres (W)",
       title = "Número óptimo basado en variabilidad total intra-clústeres")
```

Con el **«método del codo» (Elbow method)** cuando `\(W\)` ya no se reduce de forma significativa al aumentar el número de clústers.

]

---

# Determinación del número de grupos

.pull-left[

Para decidir el **número óptimo** se usan principalmente dos métodos:

* Basado en la **compacidad** (índice silhouette)

`$$S= \frac{\sum_{i=1}^{n} S(i)}{n}, \quad S(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}$$`

donde `\(a(i)\)` representa las **distancia media de la observación i-ésima** a las observaciones de su clúster, y y `\(b(i)\)` respecto a la de otros clústers.


```r
fviz_nbclust(iris_scale, kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "nº clústeres (k)",
       y = "Silhouette media",
       title = "Número óptimo basado en silhouette")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-156-1.png" width="100%" /&gt;

]

---

# Determinación del número de grupos

La función `silhouette()` del paquete `{cluster}` nos permite calcular dicho índice para la agrupación realizada (más adelante veremos como visualizarlo)


```r
kclust &lt;- kmeans(iris_scale,
                 centers = 3, iter.max = 50)
d &lt;- dist(iris_scale, method = "euclidean")
sil &lt;- silhouette(kclust$cluster, d)
sil
```

```
&gt;        cluster neighbor   sil_width
&gt;   [1,]       1        2  0.73419485
&gt;   [2,]       1        2  0.56827391
&gt;   [3,]       1        2  0.67754724
&gt;   [4,]       1        2  0.62050159
&gt;   [5,]       1        2  0.72847412
&gt;   [6,]       1        2  0.60988485
&gt;   [7,]       1        2  0.69838355
&gt;   [8,]       1        2  0.73081691
&gt;   [9,]       1        2  0.48821004
&gt;  [10,]       1        2  0.63154089
&gt;  [11,]       1        2  0.67418286
&gt;  [12,]       1        2  0.72179392
&gt;  [13,]       1        2  0.57847213
&gt;  [14,]       1        2  0.54944562
&gt;  [15,]       1        2  0.55294537
&gt;  [16,]       1        2  0.45806886
&gt;  [17,]       1        2  0.62112236
&gt;  [18,]       1        2  0.72875221
&gt;  [19,]       1        2  0.58590385
&gt;  [20,]       1        2  0.67746392
&gt;  [21,]       1        2  0.66042913
&gt;  [22,]       1        2  0.69021224
&gt;  [23,]       1        2  0.69653476
&gt;  [24,]       1        2  0.63737612
&gt;  [25,]       1        2  0.70132024
&gt;  [26,]       1        2  0.54494792
&gt;  [27,]       1        2  0.70471457
&gt;  [28,]       1        2  0.72151031
&gt;  [29,]       1        2  0.71451919
&gt;  [30,]       1        2  0.66776336
&gt;  [31,]       1        2  0.62562482
&gt;  [32,]       1        2  0.64783099
&gt;  [33,]       1        2  0.58967022
&gt;  [34,]       1        2  0.54088124
&gt;  [35,]       1        2  0.62843507
&gt;  [36,]       1        2  0.67614681
&gt;  [37,]       1        2  0.66543365
&gt;  [38,]       1        2  0.72441906
&gt;  [39,]       1        2  0.55262190
&gt;  [40,]       1        2  0.72470474
&gt;  [41,]       1        2  0.73333453
&gt;  [42,]       1        2  0.07766666
&gt;  [43,]       1        2  0.63725809
&gt;  [44,]       1        2  0.66371521
&gt;  [45,]       1        2  0.64863547
&gt;  [46,]       1        2  0.55934650
&gt;  [47,]       1        2  0.67881722
&gt;  [48,]       1        2  0.66606206
&gt;  [49,]       1        2  0.68912398
&gt;  [50,]       1        2  0.71077363
&gt;  [51,]       3        2  0.34169992
&gt;  [52,]       3        2  0.16627565
&gt;  [53,]       3        2  0.35854546
&gt;  [54,]       2        3  0.54373992
&gt;  [55,]       2        3  0.13270610
&gt;  [56,]       2        3  0.53878741
&gt;  [57,]       3        2  0.23206569
&gt;  [58,]       2        1  0.40978046
&gt;  [59,]       2        3  0.03768897
&gt;  [60,]       2        3  0.54390267
&gt;  [61,]       2        1  0.42467141
&gt;  [62,]       2        3  0.34088756
&gt;  [63,]       2        3  0.46946550
&gt;  [64,]       2        3  0.33187646
&gt;  [65,]       2        3  0.49517920
&gt;  [66,]       3        2  0.18906699
&gt;  [67,]       2        3  0.39249659
&gt;  [68,]       2        3  0.54918014
&gt;  [69,]       2        3  0.40350566
&gt;  [70,]       2        3  0.58259179
&gt;  [71,]       3        2  0.03645185
&gt;  [72,]       2        3  0.45853055
&gt;  [73,]       2        3  0.36638600
&gt;  [74,]       2        3  0.42610282
&gt;  [75,]       2        3  0.21912232
&gt;  [76,]       3        2  0.05112346
&gt;  [77,]       3        2  0.04063911
&gt;  [78,]       3        2  0.34222491
&gt;  [79,]       2        3  0.37447730
&gt;  [80,]       2        3  0.55591003
&gt;  [81,]       2        3  0.56667628
&gt;  [82,]       2        3  0.55697725
&gt;  [83,]       2        3  0.56859072
&gt;  [84,]       2        3  0.39023598
&gt;  [85,]       2        3  0.40497788
&gt;  [86,]       3        2  0.10973108
&gt;  [87,]       3        2  0.27953553
&gt;  [88,]       2        3  0.41829609
&gt;  [89,]       2        3  0.44045285
&gt;  [90,]       2        3  0.58629734
&gt;  [91,]       2        3  0.58416837
&gt;  [92,]       2        3  0.24125752
&gt;  [93,]       2        3  0.58008127
&gt;  [94,]       2        1  0.43896605
&gt;  [95,]       2        3  0.58397553
&gt;  [96,]       2        3  0.43067583
&gt;  [97,]       2        3  0.50035119
&gt;  [98,]       2        3  0.33948876
&gt;  [99,]       2        1  0.43311107
&gt; [100,]       2        3  0.55292391
&gt; [101,]       3        2  0.42463909
&gt; [102,]       2        3  0.34345454
&gt; [103,]       3        2  0.52207700
&gt; [104,]       3        2  0.15132973
&gt; [105,]       3        2  0.43894193
&gt; [106,]       3        2  0.47218801
&gt; [107,]       2        3  0.47007943
&gt; [108,]       3        2  0.44360797
&gt; [109,]       3        2  0.01675919
&gt; [110,]       3        2  0.46637587
&gt; [111,]       3        2  0.44615652
&gt; [112,]       3        2 -0.01058434
&gt; [113,]       3        2  0.50147349
&gt; [114,]       2        3  0.37966719
&gt; [115,]       2        3  0.05778708
&gt; [116,]       3        2  0.44552087
&gt; [117,]       3        2  0.35179075
&gt; [118,]       3        2  0.41131991
&gt; [119,]       3        2  0.33087257
&gt; [120,]       2        3  0.41625797
&gt; [121,]       3        2  0.54976242
&gt; [122,]       2        3  0.31780905
&gt; [123,]       3        2  0.40083606
&gt; [124,]       2        3  0.17744927
&gt; [125,]       3        2  0.52568825
&gt; [126,]       3        2  0.51433621
&gt; [127,]       2        3  0.17430033
&gt; [128,]       3        2 -0.02489394
&gt; [129,]       3        2  0.22253544
&gt; [130,]       3        2  0.43638496
&gt; [131,]       3        2  0.41286324
&gt; [132,]       3        2  0.39874279
&gt; [133,]       3        2  0.24284231
&gt; [134,]       2        3  0.19544119
&gt; [135,]       2        3  0.34505079
&gt; [136,]       3        2  0.46884592
&gt; [137,]       3        2  0.42243015
&gt; [138,]       3        2  0.36093602
&gt; [139,]       2        3  0.08594176
&gt; [140,]       3        2  0.53818328
&gt; [141,]       3        2  0.50861824
&gt; [142,]       3        2  0.51142970
&gt; [143,]       2        3  0.34345454
&gt; [144,]       3        2  0.54298088
&gt; [145,]       3        2  0.50444897
&gt; [146,]       3        2  0.46228025
&gt; [147,]       2        3  0.22992489
&gt; [148,]       3        2  0.38121152
&gt; [149,]       3        2  0.38714414
&gt; [150,]       2        3  0.09788140
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

---

# Poniendo en práctica: clustering de países

Para poner en práctica lo aprendido vamos a analizar los **datos de esperanza de vida de distintos países**, en hombres y mujeres, a distintas edades, que tenemos en el archivo `EsperanzaVida.xlsx`


```r
library(readxl)
esperanza &lt;-
  read_xlsx(path = "./DATOS/EsperanzaVida.xlsx")
glimpse(esperanza)
```

```
&gt; Rows: 26
&gt; Columns: 9
&gt; $ PAIS &lt;chr&gt; "Algeria", "Cameroon", "Madagascar", "Mauritius", "Reunion", "Sey…
&gt; $ m0   &lt;dbl&gt; 63, 34, 38, 59, 56, 62, 65, 56, 69, 65, 64, 56, 60, 61, 49, 59, 6…
&gt; $ m25  &lt;dbl&gt; 51, 29, 30, 42, 38, 44, 44, 46, 47, 48, 50, 44, 44, 45, 40, 42, 4…
&gt; $ m50  &lt;dbl&gt; 30, 13, 17, 20, 18, 24, 22, 24, 24, 26, 28, 25, 22, 22, 22, 22, 2…
&gt; $ m75  &lt;dbl&gt; 13, 5, 7, 6, 7, 7, 7, 11, 8, 9, 11, 10, 6, 8, 9, 6, 8, 8, 14, 9, …
&gt; $ w0   &lt;dbl&gt; 67, 38, 38, 64, 62, 69, 72, 63, 75, 68, 66, 61, 65, 65, 51, 61, 6…
&gt; $ w25  &lt;dbl&gt; 54, 32, 34, 46, 46, 50, 50, 54, 53, 50, 51, 48, 45, 49, 41, 43, 4…
&gt; $ w50  &lt;dbl&gt; 34, 17, 20, 25, 25, 28, 27, 33, 29, 27, 29, 27, 25, 27, 23, 22, 2…
&gt; $ w75  &lt;dbl&gt; 15, 6, 7, 8, 10, 14, 9, 19, 10, 10, 11, 12, 9, 10, 8, 7, 9, 8, 13…
```

---

# Clustering de países

### Visualización previa


.pull-left[

La función `heatmaply()` del paquete homónimo qos permite realizar agrupaciones tanto de variables (dendograma superior) como de individuos (dendograma en el lateral).


```r
# Convertimos a data.frame para
# tener row.names y eliminamos PAIS
esperanza_df &lt;-
  as.data.frame(esperanza) %&gt;%
  select(-PAIS)
row.names(esperanza_df) &lt;- esperanza %&gt;% pull(PAIS)

library(heatmaply)
heatmaply(esperanza_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_1.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]


---

# Clustering de países

### Visualización previa

.pull-left[

Dicha representación puede ser mejorada estandarizando los datos


```r
# Estandarizamos
esperanza_scale_df &lt;-
  esperanza_df %&gt;%
  mutate(across(where(is.numeric),
                ~scale(.)))

heatmaply(esperanza_scale_df,
          seriate = "mean",
          row_dend_left = TRUE,
          plot_method = "plotly")
```

]

.pull-right[



&lt;img src="./img/heatmap_paises_2.jpg" width="95%" style="display: block; margin: auto 0 auto auto;" /&gt;

]

---

# Clustering de países

### Matriz de distancias

.pull-left[

Con los datos estandarizados podemos visualizar su matriz de distancias


```r
# matriz de distancias
d &lt;- dist(esperanza_scale_df,
          method = "euclidean")

# Visualizamos
fviz_dist(d, show_labels = TRUE)
```

Podemos ya atisbar cuatro grupos de países: Madasgar-Camerún, Nicaragua-Algeria-Tunez, Groenlandia-...-Guatemala, y los demás.

]
.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-166-1.png" width="95%" /&gt;

]

---

# Clustering de países

### Clustering (single)

.pull-left[


```r
# Clustering (single)
single_clust &lt;-
  hclust(d, method = "single")

# Dendograma
library(factoextra)
fviz_dend(single_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # añade rectángulo
          rect = TRUE) +
  labs(title = "Dendograma (single)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-168-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Clustering (complete)

.pull-left[


```r
# Clustering (complete)
complete_clust &lt;-
  hclust(d, method = "complete")

# Dendograma
fviz_dend(complete_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          # Añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (complete)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-170-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Clustering (average)

.pull-left[


```r
# Clustering (average)
average_clust &lt;-
  hclust(d, method = "average")

# Dendograma
fviz_dend(average_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (average)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-172-1.png" width="100%" /&gt;

]

---


# Clustering de países

### Clustering (centroid)

.pull-left[


```r
# Clustering (centroid)
centroid_clust &lt;-
  hclust(d, method = "centroid")

# Dendograma
fviz_dend(centroid_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (centroid)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-174-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Clustering (Ward)

.pull-left[


```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")

# Dendograma
fviz_dend(ward_clust, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (Ward)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-176-1.png" width="100%" /&gt;

]

---


# Clustering de países

### Clustering divisivo

.pull-left[


```r
# Clustering divisivo
hc_diana &lt;-
  diana(x = d, diss = TRUE,
        stand = FALSE)

# Dendograma
fviz_dend(hc_diana, k = 4,
          cex = 0.5, 
          k_colors =
            c("#2E9FDF", "#00AFBB",
              "#E7B800", "#FC4E07"),
          # Diferentes colores a los clusters
          color_labels_by_k = TRUE, 
          #añade un rectángulo alrededor
          rect = TRUE) +
  labs(title = "Dendograma (divisivo)")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-178-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Clustering no jerárquico

.pull-left[


```r
# Clustering k-means
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4,
                 iter.max = 50)
kclust$totss

# Clustering
fviz_cluster(list(data =
                    esperanza_scale_df,
                  cluster =
                    kclust$cluster),
             palette =
               c("#2E9FDF", "#00AFBB",
                 "#E7B800", "#FC4E07"),
             ellipse.type = "convex", 
             repel = TRUE,
             show.clust.cent = FALSE) +
  labs(title = "Cluster (k-means)") +
  theme_minimal()
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-180-1.png" width="100%" /&gt;

]

---


# Clustering de países

### Comparativa de clusterings


.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-181-1.png" width="100%" /&gt;

]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-182-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Comparativa de clusterings

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-183-1.png" width="100%" /&gt;

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-184-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Comparativa de clusterings

.pull-left[

&lt;img src="index_files/figure-html/unnamed-chunk-185-1.png" width="100%" /&gt;

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-186-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Elección del número de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "wss") +
  theme_minimal() +
  labs(x = "nº clústeres (k)",
       y = "Variabilidad total intra-clústeres (W)",
       title = "Número óptimo basado en variabilidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-188-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Elección del número de clusters

.pull-left[


```r
fviz_nbclust(esperanza_scale_df, kmeans,
             method = "silhouette") +
  theme_minimal() +
  labs(x = "nº clústeres (k)",
       y = "Variabilidad total intra-clústeres (W)",
       title = "Número óptimo basado en compacidad")
```

]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-190-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Elección del número de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
sil
```

]

.pull-right[


```
&gt;       cluster neighbor   sil_width
&gt;  [1,]       2        3  0.41474025
&gt;  [2,]       4        1  0.71161564
&gt;  [3,]       4        1  0.64807433
&gt;  [4,]       1        3  0.42956603
&gt;  [5,]       1        3  0.30980004
&gt;  [6,]       3        1  0.35360131
&gt;  [7,]       3        1  0.22675528
&gt;  [8,]       2        3  0.19380903
&gt;  [9,]       3        1  0.44705360
&gt; [10,]       3        1  0.50410114
&gt; [11,]       2        3 -0.12873387
&gt; [12,]       3        1  0.33044631
&gt; [13,]       1        3  0.30745661
&gt; [14,]       3        1  0.27880518
&gt; [15,]       1        3  0.27557000
&gt; [16,]       1        3  0.45235498
&gt; [17,]       3        1  0.18609043
&gt; [18,]       1        3  0.04774938
&gt; [19,]       2        3  0.27794760
&gt; [20,]       3        1  0.48800548
&gt; [21,]       1        3  0.27118869
&gt; [22,]       3        1  0.44893332
&gt; [23,]       3        1  0.52424137
&gt; [24,]       3        1  0.38152994
&gt; [25,]       3        1  0.12458923
&gt; [26,]       3        2  0.32183229
&gt; attr(,"Ordered")
&gt; [1] FALSE
&gt; attr(,"call")
&gt; silhouette.default(x = kclust$cluster, dist = d)
&gt; attr(,"class")
&gt; [1] "silhouette"
```

]

---


# Clustering de países

### Elección del número de clusters

.pull-left[



```r
kclust &lt;- kmeans(esperanza_scale_df,
                 centers = 4, iter.max = 50)
sil &lt;- silhouette(kclust$cluster, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualización
fviz_silhouette(sil, label = TRUE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "Índice silhouette para k-means con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust=1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-194-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Elección del número de clusters

.pull-left[



```r
# Clustering (ward)
ward_clust &lt;-
  hclust(d, method = "ward.D2")
groups &lt;- cutree(ward_clust, k = 4)
sil &lt;- silhouette(groups, d)
row.names(sil) &lt;- row.names(esperanza_scale_df)

# Visualización
fviz_silhouette(sil, label = TRUE,
                print.summary = FALSE) +
  scale_fill_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  scale_color_manual(values =
                      c("#2E9FDF", "#00AFBB",
                        "#E7B800", "#FC4E07")) +
  theme_minimal() +
  labs(title =
         "Índice silhouette para jerárquico Ward con k = 4") +
  # Giramos etiquetas eje
  theme(axis.text.x =
          element_text(angle = 90,
                       vjust = 0.5,
                       hjust = 1))
```

]

.pull-right[


&lt;img src="index_files/figure-html/unnamed-chunk-196-1.png" width="100%" /&gt;

]

---

# Clustering de países

### Elección del número de clusters

Podemos ejecutar varios clustering a la vez mapeando sobre el número de clusters (por ejemplo, usando el k-medias)


```r
library(tidymodels)
kclusts &lt;- 
  tibble(k = 1:9) %&gt;%
  mutate(kclust =
           map(k, ~kmeans(esperanza_scale_df, .x)),
         tidied = map(kclust, tidy),
         glanced = map(kclust, glance),
         augmented = map(kclust, augment,
                         esperanza_scale_df)
         )
clusters &lt;- 
  kclusts %&gt;% unnest(cols = c(tidied))

assignments &lt;- 
  kclusts %&gt;% unnest(cols = c(augmented))

clusterings &lt;- 
  kclusts %&gt;% unnest(cols = c(glanced))
```

---

# Recursos y bibliografía

&amp;nbsp;

### **Leyenda de los recursos**

&amp;nbsp;

&amp;nbsp;


#### 📚 **Artículos o libros** científicos que han sido sometidos a revisión por pares.

&amp;nbsp;

#### 🔗 **Recursos online** recomendados

&amp;nbsp;

#### 💻 Recursos para la **programación en R**

---

# Bibliografía general

💻 **Tidy Data Tutor**: para visualizar la mecánica interna de `{tidyverse}`. &lt;https://tidydatatutor.com/&gt;

🔗 Web con recursos para la **introducción a la estadística y Machine Learning en R** &lt;https://artofstat.com/&gt;

📚 **«An Introduction to Multivariate Statistical Analysis»**. Anderson (1958) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/introduction_mva_anderson_2003.pdf&gt;

📚 **«A New Measure of Rank Correlation»**. Kendall (1938) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/correlation_kendall_1938.pdf&gt;

📚 **«The generalised product moment distribution in samples from a normal multivariate population»**. Wishart (1928) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multivariate_normal_wishart_1928.pdf&gt;

📚 **«On lines and planes of closest fit to systems of points in space»**. Pearson (1901) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/fit_pearson_1901.pdf&gt;


---

# Recursos dataviz

### Dataviz

📚 **«Gramática de las gráficas: pistas para mejorar las representaciones de datos»**. Sevilla (2005) &lt;http://academica-e.unavarra.es/bitstream/handle/2454/15785/Gram%C3%A1tica.pdf&gt;

📚 **«Quantitative Graphics in Statistics: A Brief History»**. Beniger and Robyn &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/graphics_beniger_robin_1978.pdf&gt;
 
 
💻 **«Analizando datos, visualizando información, contando historias»** (curso de dataviz en R). Álvarez-Liébana y Valverde-Castilla (2022) &lt;https://dadosdelaplace.github.io/curso-dataviz-ECI-2022&gt;

---

# Bibliografía componentes principales

💻 **Componentes principales** en `{tidymodels}`. &lt;https://www.tmwr.org/dimensionality.html#beans&gt;


📚 **«Principal Component Analysis»**. Jolliffe (2002) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/pca_jolliffe_2002.pdf&gt;

📚 **«Principal Component Analysis»**. Hervé and Lynne (2010) &lt;http://staff.ustc.edu.cn/~zwp/teach/MVA/abdi-awPCA2010.pdf&gt;

📚 **«Principal Component Analysis: a review and recent developments»**. Jolliffe and Cadima (2016) &lt;https://royalsocietypublishing.org/doi/10.1098/rsta.2015.0202&gt;

🔗 **«The Mathematics Behind Principal Component Analysis»**. Dubey (2018).  &lt;https://towardsdatascience.com/the-mathematics-behind-principal-component-analysis-fff2d7f4b643&gt;


🔗 **«A One-Stop Shop for Principal Component Analysis»**. Brems (2017). &lt;https://towardsdatascience.com/a-one-stop-shop-for-principal-component-analysis-5582fb7e0a9c&gt;

📚 **«On the number of principal components: a test of dimensionality based on measurements of similarity between matrices»**. Dray (2008) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/numer_pca_dray_2008.pdf&gt;


---

# Bibliografía análisis clúster

📚 **«Multiclass classification of dry beans using computer vision and machine learning techniques»**. Koklu y Ozkan (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/multiclass_classif_koklu_ozlan_2020.pdf&gt;

💻 **«Clustering y heatmaps: aprendizaje no supervisado»**. Amat (2017). &lt;https://rpubs.com/Joaquin_AR/310338&gt;

💻 **«K-means clustering with tidy data principles»** &lt;https://www.tidymodels.org/learn/statistics/k-means/&gt;

🔗 **«ISLR tidymodels Labs»** &lt;https://emilhvitfeldt.github.io/ISLR-tidymodels-labs/unsupervised-learning.html#kmeans-clustering&gt;


📚 **«Algorithm AS 136: a K-Means Clustering Algorithm»**. Hartigan y Wong (1979) &lt;http://www.jstor.org/stable/2346830&gt;

🔗 **«Machine Learning for Social Scientists»**. Cimentada (2020) &lt;https://cimentadaj.github.io/ml_socsci/unsupervised-methods.html&gt;

---

# Recursos y bibliografía

### Otras técnicas de reducción de la dimensión

🔗 Sobre **PCA y PLS**. Amat (2017). &lt;https://www.cienciadedatos.net/documentos/35_principal_component_analysis#Introducci%C3%B3n&gt;

📚 **«On the early history of the singular value decomposition»**. Stewart (1993) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/svd_stewart_1993.pdf&gt;

📚 **«UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction»**. McInnes, healy and Melville (2020) &lt;https://github.com/dadosdelaplace/teaching/blob/main/bdba-pca-clustering-2022/biblio/umap_mcinnesetal_2020.pdf&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
