---
title: "Entrega II"
description: |
  Aplicando knn a hoteles
author:
  - name: C. Tangana (DNI 0000000-A)
    affiliation: Universidad Complutense de Madrid
    affiliation_url: 
date: "`r Sys.Date()`"
output:
    distill::distill_article:
        highlight: kate
        colorlinks: true
        code_folding: false
        toc: true            
        toc_depth: 3     
---

```{r setup, include = FALSE}
# Ajuste comunes de los chunk
knitr::opts_chunk$set(fig.width = 9, fig.asp = 1, out.width = "100%",
                      message = FALSE, warning = FALSE,
                      echo = TRUE, res = 400)
```

# Instrucciones (leer antes de empezar)

* Modifica dentro del documento `.Rmd` tus datos personales (nombre y DNI) ubicados en la cabecera del archivo.

* Aseg칰rate, **ANTES de seguir editando** el documento, que el archivo `.Rmd` se teje correctamente (bot칩n Knit) y se genera el `.html` correspondiente.

* Los chunks (cajas de c칩digo) creados est치n o vac칤os o incompletos, de ah칤 que la mayor칤a tengan la opci칩n `eval = FALSE`. Una vez que edites lo que consideres debes ir cambiando cada chunck a `eval = TRUE` para que se ejecuten.

* Recuerda que puedes ejecutar chunk a chunk con el bot칩n _play_ o ejecutar todos los chunk hasta uno dado (con el bot칩n a la izquierda del anterior).

## Obligatorio

Deber치s implementar un modelo de clasificaci칩n knn al conjunto hoteles. Tienes total libertad de decisi칩n pero los siguientes 칤tems son obligatorios

* Cualquier decisi칩n no justificada/argumentada de forma correcta no ser치 tenida en cuenta.

* Ser치 obligatorio un muestreo inicial.

* Deber치s implementar y detallar una fase 2-3 lo m치s completa posible

* Deber치s proponer al menos dos recetas distintas.

* Deber치s probar al menos una validaci칩n simple (haciendo uso de tune), asegur치ndote de que el mallado de par치metros es adecuado para afinar la b칰squeda de ese punto m칤nimo d la curva sesgo-varianza

* Deber치s probar al menos una validaci칩n cruzada v-folds paralelizada


# Datos {#datos}

Debes hacer uso del **dataset de reservas de hotel**

```{r}
library(tidyverse)
library(tidymodels)
hoteles_bruto <- read_csv(file = "./hoteles.csv")
```

Los datos forman parte de un **conjunto de reservas de hotel** elaborado por Antonio et al., 2019 con 50 000 registros de reservas

游닄 **Detalle de variables**: <https://linkinghub.elsevier.com/retrieve/pii/S2352340918315191>

## An치lisis exploratorio inicial (num칠rico)

Antes de tomar ninguna decisi칩n con los datos lo primero que deber칤amos hacer es **echar un vistazo num칠rico** a c칩mo se comportan las variables. Dado que vamos a clasificar, lo primero que deber칤amos observar es como se distribuyen los niveles de nuestra variable objetivo.

### Variables

Lo primero es conocer las variables

```{r}
glimpse(hoteles_bruto)
```

* `hotel`: tipo de hotel (urbano o resort)
* `lead_time`: n칰mero de d칤as entre la reserva y la estancia.
* `stays_in_weekend_nights, stays_in_week_nights`: noches en fin de semana y entre semana
* `adults`: n칰mero de adultos
* `children`: 쯟a reserva tiene ni침os?
* `meal`: r칠gimen de comidas
* `country`: pa칤s de origen
* `market_segment`: segmento de mercado de la reserva
* `distribution_channel`: canal de distribuci칩n de la oferta
* `is_repeated_guest`: repite como hu칠sped?
* `previous_cancellations`: cancelaciones previas
* `previous_bookings_not_canceled`: reservas previas (no canceladas)
* `reserved_room_type, assigned_room_type`: tipo de habitaci칩n reservada/asignada
* `booking_changes`: cambios en la reserva
* `deposit_type`: tipo de dep칩sito
* `days_in_waiting_list`: d칤as en lista de espera
* `customer_type`: tipo de cliente
* `average_daily_rate`: tarifa media diaria
* `required_car_parking_spaces`: 쯣arking?
* `total_of_special_requests`: n칰mero de requisitos especiales demandados
* `arrival_date`: fecha de llegada 

### Balance la variable objetivo

El objetivo ser치 **predecir si una reserva incluye ni침os/as o no**, por lo que `children` ser치 nuestra variable objetivo. Primer paso: conocer c칩mo se **istribuyen los niveles de la objetivo** (es binaria)


```{r}
# Objetivo: predecir si la reserva viene o no con ni침os
hoteles_bruto %>% 
  count(children) %>%
  mutate(porc = 100*n/sum(n))
```

### skim()

Adem치s con la funci칩n `skim()` del paquete `{skimr}` podemos **extraer algunas estad칤sticas b치sicas** de nuestros datos.

```{r skim}
library(skimr)
# Resumen num칠rico
hoteles_bruto %>% skim()
```

[Continua a partir de aqu칤 creando las secciones que consideres]


